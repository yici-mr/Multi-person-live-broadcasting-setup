!function(t){function e(e){for(var i,o,s=e[0],l=e[1],c=e[2],u=0,f=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&f.push(n[o][0]),n[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);for(d&&d(e);f.length;)f.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],i=!0,s=1;s<a.length;s++){var l=a[s];0!==n[l]&&(i=!1)}i&&(r.splice(e--,1),t=o(o.s=a[0]))}return t}var i={},n={app:0},r=[];function o(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.e=function(t){var e=[],a=n[t];if(0!==a)if(a)e.push(a[2]);else{var i=new Promise((function(e,i){a=n[t]=[e,i]}));e.push(a[2]=i);var r,s=document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=function(t){return o.p+"js/"+({qrcode:"qrcode"}[t]||t)+"."+{qrcode:"9c03843e"}[t]+".js"}(t);var l=new Error;r=function(e){s.onerror=s.onload=null,clearTimeout(c);var a=n[t];if(0!==a){if(a){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;l.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",l.name="ChunkLoadError",l.type=i,l.request=r,a[1](l)}n[t]=void 0}};var c=setTimeout((function(){r({type:"timeout",target:s})}),12e4);s.onerror=s.onload=r,document.head.appendChild(s)}return Promise.all(e)},o.m=t,o.c=i,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(a,i,function(e){return t[e]}.bind(null,i));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/dist/",o.oe=function(t){throw t};var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var d=l;r.push([0,"chunk-vendors"]),a()}({0:function(t,e,a){t.exports=a("56d7")},"01ca":function(t,e,a){},"01d8":function(t,e,a){"use strict";var i=a("a19f");a.n(i).a},"0394":function(t,e,a){"use strict";var i=a("533c");a.n(i).a},"074a":function(t,e,a){"use strict";var i=a("01ca");a.n(i).a},"07c5":function(t,e,a){"use strict";a.d(e,"c",(function(){return n})),a.d(e,"d",(function(){return r})),a.d(e,"e",(function(){return o})),a.d(e,"g",(function(){return s})),a.d(e,"f",(function(){return l})),a.d(e,"b",(function(){return c})),a.d(e,"a",(function(){return d}));var i=a("b247");function n(t){return Object(i.a)({url:"auth/login",method:"post",data:t})}function r(){return Object(i.a)({url:"auth/token",method:"delete"})}function o(t){return Object(i.a)({url:"auth/register",method:"put",data:t})}function s(t){return Object(i.a)({url:"auth/send-reset-link",method:"post",data:t})}function l(t){return Object(i.a)({url:"auth/reset-password",method:"post",data:t})}function c(){return Object(i.a)({url:"info",method:"get"})}function d(t){return Object(i.a)({url:"info/password",method:"post",data:t})}},"0825":function(t,e,a){"use strict";var i=a("aa14");a.n(i).a},"0830":function(t,e,a){"use strict";var i=a("49b3");a.n(i).a},"0c79":function(t,e,a){"use strict";var i=a("962d");a.n(i).a},"0ed8":function(t,e,a){},"0eda":function(t,e,a){},"0ee6":function(t,e,a){t.exports=a.p+"img/404.a57b6f31.png"},1166:function(t,e,a){"use strict";var i=a("9bd6");a.n(i).a},1221:function(t,e,a){},"12af":function(t,e,a){"use strict";var i=a("1221");a.n(i).a},"136e":function(t,e,a){"use strict";var i=a("e74f");a.n(i).a},"13e9":function(t,e,a){"use strict";var i=a("cc27");a.n(i).a},1727:function(t,e,a){"use strict";var i=a("b9b2");a.n(i).a},"1a1f":function(t,e,a){},"1a50":function(t,e,a){"use strict";var i=a("3237");a.n(i).a},"1dc9":function(t,e,a){},"1e1b":function(t,e,a){},"20fe":function(t,e,a){"use strict";var i=a("acb6");a.n(i).a},2258:function(t,e,a){"use strict";var i=a("2303");a.n(i).a},2303:function(t,e,a){},2753:function(t,e,a){"use strict";a.d(e,"d",(function(){return n})),a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return o})),a.d(e,"e",(function(){return s})),a.d(e,"a",(function(){return l}));var i=a("b247");function n(t){return Object(i.a)({url:"category",method:"get",params:t})}function r(t){return Object(i.a)({url:"category/edit",method:"post",data:t})}function o(t,e){return Object(i.a)({url:"category/enable",method:"post",data:{ids:t,enabled:e}})}function s(t,e){return Object(i.a)({url:"category/sort",method:"post",data:{id:t,sort:e}})}function l(t){return Object(i.a)({url:"category/delete",method:"post",data:{ids:t}})}},2830:function(t,e,a){"use strict";var i=a("0ed8");a.n(i).a},2916:function(t,e,a){"use strict";var i=a("c5b0");a.n(i).a},"2ba5":function(t,e,a){},"2c83":function(t,e,a){"use strict";var i=a("9861");a.n(i).a},3089:function(t,e,a){"use strict";var i=a("7457");a.n(i).a},3237:function(t,e,a){},"33f3":function(t,e,a){"use strict";var i=a("baad");a.n(i).a},3433:function(t,e,a){"use strict";a.d(e,"c",(function(){return r})),a.d(e,"d",(function(){return o})),a.d(e,"a",(function(){return s})),a.d(e,"b",(function(){return l})),a("a15b"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("1276");var i=a("53ca"),n=a("ff81");function r(t){t=t||16;for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",a=e.length,i="",n=0;n<t;n++)i+=e.charAt(Math.floor(Math.random()*a));return i}function o(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t||"{"!==t[0])return t;var a=null;try{a=JSON.parse(t)}catch(e){return t}if(e){if(!a.ops||!a.ops.length)return!1;if(1===a.ops.length&&"\n"===a.ops[0].insert)return!1}return'<div class="ql-snow"><div class="ql-editor quill-html">'.concat(new n.QuillDeltaToHtmlConverter(a.ops,{urlSanitizer:function(t){var e=t;e=e.replace(/^\s*/gm,"");return/^((https?|s?ftp|blob|mailto|tel|mqqapi):|#|\/|data:image\/)/.test(e)?e:"unsafe:"+e}}).convert(),"</div></div>")}function s(t){var e=document.createElement("div"),a=document.createTextNode(t);return e.appendChild(a),e.innerHTML.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=[];for(var n in t)if(t.hasOwnProperty(n))if(t[n]&&"object"===Object(i.a)(t[n]))!1===e?a.push(l(t[n],encodeURIComponent(n))):a.push(l(t[n],e+"["+encodeURIComponent(n)+"]"));else{var r=encodeURIComponent(null===t[n]||void 0===t[n]?"":t[n]);n=!1===e?encodeURIComponent(n):e+"["+encodeURIComponent(n)+"]",a.push(n+"="+r)}return a.join("&")}a("e016"),window.nullfunc=console.log,Date.prototype.format=function(t){t||(t="yyyy-MM-dd hh:mm:ss");var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)));return t},String.prototype.random=r},"38e1":function(t,e,a){"use strict";a("a434");e.a={state:{errLog:[]},pushLog:function(t){this.state.errLog.unshift(t)},clearLog:function(){this.state.errLog.splice(0,this.state.errLog.length)}}},"3a96":function(t,e,a){"use strict";var i=a("a394");a.n(i).a},"3ce0":function(t,e,a){},"3d22":function(t,e,a){},"3fd8":function(t,e,a){"use strict";var i=a("60c4");a.n(i).a},4150:function(t,e,a){},4278:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r})),a.d(e,"f",(function(){return o})),a.d(e,"c",(function(){return s})),a.d(e,"e",(function(){return l})),a.d(e,"g",(function(){return c})),a.d(e,"i",(function(){return d})),a.d(e,"j",(function(){return u})),a.d(e,"h",(function(){return f})),a.d(e,"d",(function(){return p}));var i=a("b247"),n={STATUS_NORMAL:0,STATUS_SOLD:1,STATUS_USED:2},r={TYPE_ONETIME:0,TYPE_REPEAT:1};function o(t){return Object(i.a)({url:"card",method:"get",params:t})}function s(t){return Object(i.a)({url:"card/add",method:"post",data:t})}function l(t){return Object(i.a)({url:"card/edit",method:"post",data:t})}function c(t){return Object(i.a)({url:"card/delete",method:"post",data:{ids:t}})}function d(t){return Object(i.a)({url:"card/trash/restore",method:"post",data:{ids:t}})}function u(t){return Object(i.a)({url:"card/trash/restore/all",method:"post",data:t})}function f(t){return Object(i.a)({url:"card/trash/delete",method:"post",data:{ids:t}})}function p(t){return Object(i.a)({url:"card/delete/all",method:"post",data:t})}},4360:function(t,e,a){"use strict";var i=a("a026"),n=a("2f62"),r=(a("a4d3"),a("e01a"),a("d28b"),a("45fc"),a("a434"),a("b0c0"),a("d3b7"),a("3ca3"),a("ddb0"),a("3835")),o=a("e016").a.isMobile(),s={state:{sidebar:{opened:!o&&!+localStorage.getItem("sidebarStatus")},theme:"default",livenewsChannels:localStorage.getItem("livenewsChannels")||"[]",visitedViews:[],isMobile:o},mutations:{TOGGLE_SIDEBAR:function(t){t.sidebar.opened?localStorage.setItem("sidebarStatus","1"):localStorage.setItem("sidebarStatus","0"),t.sidebar.opened=!t.sidebar.opened},ADD_VISITED_VIEWS:function(t,e){t.visitedViews.some((function(t){return t.path===e.path}))||t.visitedViews.push({name:e.name,path:e.path})},DEL_VISITED_VIEWS:function(t,e){var a,i=!0,n=!1,o=void 0;try{for(var s,l=t.visitedViews.entries()[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=Object(r.a)(s.value,2),d=c[0];if(c[1].path===e.path){a=d;break}}}catch(t){n=!0,o=t}finally{try{i||null==l.return||l.return()}finally{if(n)throw o}}t.visitedViews.splice(a,1)}},actions:{ToggleSideBar:function(t){(0,t.commit)("TOGGLE_SIDEBAR")},addVisitedViews:function(t,e){(0,t.commit)("ADD_VISITED_VIEWS",e)},delVisitedViews:function(t,e){(0,t.commit)("DEL_VISITED_VIEWS",e)}}},l=a("07c5");var c={state:{token:window.config.merchant_token||localStorage.getItem("merchant_token"),remember:!0,userInfo:{}},mutations:{SET_TOKEN:function(t,e){t.token=e,e?function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];window.config.merchant_token=t,e&&localStorage.setItem("merchant_token",t)}(e,t.remember):(delete window.config.merchant_token,localStorage.removeItem("merchant_token"))},SET_REMEMBER:function(t,e){t.remember=e},SET_USER_INFO:function(t,e){t.userInfo=e}},actions:{Login:function(t,e){var a=t.commit;return new Promise((function(t,i){a("SET_REMEMBER",e.remember),Object(l.c)(e).then((function(e){e.redirect&&(location.href=e.redirect),a("SET_USER_INFO",e.user),t(e)})).catch((function(t){i(t)}))}))},GetInfo:function(t){var e=t.commit;return t.state,new Promise((function(t,a){Object(l.b)().then((function(a){e("SET_USER_INFO",a.user),t(a)})).catch((function(t){a(t)}))}))},Logout:function(t){var e=t.commit;return t.state,new Promise((function(t){Object(l.d)().finally((function(){e("SET_USER_INFO",{}),e("SET_TOKEN",null),t()}))}))}}},d=(a("4de4"),a("4160"),a("c975"),a("159b"),a("2909")),u=a("a18c");a("534c");var f={state:{routers:u.b,addRouters:[]},mutations:{SET_ROUTERS:function(t,e){t.addRouters=e,e.forEach((function(t){for(var e=!1,a=0;a<u.b.length;a++)if(u.b[a].path===t.path){var i;u.b[a].children?(i=u.b[a].children).push.apply(i,Object(d.a)(t.children)):u.b[a].children=t.children,e=!0;break}e||u.b.push(t)})),t.routers=u.b}},actions:{GenerateRoutes:function(t,e){var a=t.commit;return new Promise((function(t){var i,n=e.user;if(i=n.role.indexOf("admin")>-1?u.a:function t(e,a){return e.filter((function(e){return!!function(t,e){return!e.meta||!e.meta.role||t.some((function(t){return e.meta.role.indexOf(t)>-1}))}(a,e)&&(e.children&&e.children.length&&(e.children=t(e.children,a)),!0)}))}(u.a,n.role&&n.role.constructor===Array?n.role:[n.role]),window.config.user_verify.open&&n.verify){var r=!0,o=!1,s=void 0;try{for(var l,c=u.b[Symbol.iterator]();!(r=(l=c.next()).done);r=!0){if("/m/user"===l.value.path){var d=!0,f=!1,p=void 0;try{for(var h,m=u.b[Symbol.iterator]();!(d=(h=m.next()).done);d=!0){var _=h.value;if("/m/user/verify"===_.path){_.path.hide=!1;break}}}catch(t){f=!0,p=t}finally{try{d||null==m.return||m.return()}finally{if(f)throw p}}break}}}catch(t){o=!0,s=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw s}}}a("SET_ROUTERS",i),t()}))}}},p={sidebar:function(t){return t.app.sidebar},userInfo:function(t){return t.user.userInfo},role:function(t){return t.user.userInfo.role},permission_routers:function(t){return t.permission.routers},addRouters:function(t){return t.permission.addRouters}};i.default.use(n.default),e.a=new n.default.Store({modules:{app:s,user:c,permission:f},getters:p})},"472c":function(t,e,a){},"49b3":function(t,e,a){},"4dc7":function(t,e,a){"use strict";var i=a("2ba5");a.n(i).a},"533c":function(t,e,a){},"534c":function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return o})),a.d(e,"c",(function(){return n})),a.d(e,"e",(function(){return s})),a.d(e,"f",(function(){return l})),a.d(e,"d",(function(){return c}));var i=a("b247"),n={UN:{id:0,name:"未认证",type:"info"},OK:{id:1,name:"已通过",type:"primary"},FAIL:{id:2,name:"认证失败",type:"warning"},ING:{id:3,name:"审核中",type:"info"},get:function(t){for(var e in this)if(this.hasOwnProperty(e)&&this[e].id===t)return this[e];return{id:t,type:"danger",name:"未知状态"}}},r={ID_CARD:1,BUSINESS:2},o={MANUAL:0,ALIPAY:1};function s(t){return Object(i.a)({url:"user/verify/info",method:"get",params:{user_id:t}})}function l(t,e,a){return Object(i.a)({url:"user/verify/handle",method:"post",data:{ids:t,status:e,reason:a}})}function c(t){return Object(i.a)({url:"user/verify/edit",method:"post",data:t})}},"56d7":function(t,e,a){"use strict";a.r(e),a("a4d3"),a("4de4"),a("4160"),a("c975"),a("b0c0"),a("e439"),a("dbb4"),a("b64b"),a("159b");var i=a("ade3"),n=(a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("a026")),r=a("a18c"),o=a("4360"),s=a("b247"),l=(a("4d34"),a("50ef"),a("a505"),a("aea4"),a("b7a3"),a("a917"),a("a3f2"),a("890e"),a("fb9f"),a("044d"),a("e675"),a("75b3"),a("7706"),a("e947"),a("3929"),a("ee58"),a("d34b"),a("b071"),a("9f71"),a("6e31"),a("1ed6"),a("fb13"),a("ea4b"),a("c779"),a("43cf"),a("3d73"),a("280f"),a("1fae"),a("0874"));l.a.register({"regular/shield-alt":{width:512,height:512,d:"M256 409.6V100l-142.9 59.5c8.4 116.2 65.2 202.6 142.9 250.1zM466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256 464C158.5 423.4 64 297.3 64 128l192-80 192 80c0 173.8-98.4 297-192 336z"}}),l.a.register({"regular/info-circle":{width:512,height:512,d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 448c-110.532 0-200-89.431-200-200 0-110.495 89.472-200 200-200 110.491 0 200 89.471 200 200 0 110.53-89.431 200-200 200zm0-338c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"}}),l.a.register({"regular/link":{width:512,height:512,d:"M314.222 197.78c51.091 51.091 54.377 132.287 9.75 187.16-6.242 7.73-2.784 3.865-84.94 86.02-54.696 54.696-143.266 54.745-197.99 0-54.711-54.69-54.734-143.255 0-197.99 32.773-32.773 51.835-51.899 63.409-63.457 7.463-7.452 20.331-2.354 20.486 8.192a173.31 173.31 0 0 0 4.746 37.828c.966 4.029-.272 8.269-3.202 11.198L80.632 312.57c-32.755 32.775-32.887 85.892 0 118.8 32.775 32.755 85.892 32.887 118.8 0l75.19-75.2c32.718-32.725 32.777-86.013 0-118.79a83.722 83.722 0 0 0-22.814-16.229c-4.623-2.233-7.182-7.25-6.561-12.346 1.356-11.122 6.296-21.885 14.815-30.405l4.375-4.375c3.625-3.626 9.177-4.594 13.76-2.294 12.999 6.524 25.187 15.211 36.025 26.049zM470.958 41.04c-54.724-54.745-143.294-54.696-197.99 0-82.156 82.156-78.698 78.29-84.94 86.02-44.627 54.873-41.341 136.069 9.75 187.16 10.838 10.838 23.026 19.525 36.025 26.049 4.582 2.3 10.134 1.331 13.76-2.294l4.375-4.375c8.52-8.519 13.459-19.283 14.815-30.405.621-5.096-1.938-10.113-6.561-12.346a83.706 83.706 0 0 1-22.814-16.229c-32.777-32.777-32.718-86.065 0-118.79l75.19-75.2c32.908-32.887 86.025-32.755 118.8 0 32.887 32.908 32.755 86.025 0 118.8l-45.848 45.84c-2.93 2.929-4.168 7.169-3.202 11.198a173.31 173.31 0 0 1 4.746 37.828c.155 10.546 13.023 15.644 20.486 8.192 11.574-11.558 30.636-30.684 63.409-63.457 54.733-54.735 54.71-143.3-.001-197.991z"}}),l.a.register({"regular/yen-sign":{width:512,height:512,d:"M347.983 32h-44.065a12.001 12.001 0 0 0-10.555 6.291l-73.76 133.313c-13.96 29.825-27.286 64.725-27.286 64.725h-1.269s-13.326-34.901-27.287-64.725L90.689 38.328A12 12 0 0 0 80.115 32H36.017c-9.157 0-14.94 9.844-10.481 17.843L119.746 216H68c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h77.18l14.775 26.267V312H68c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h91.955v108c0 6.627 5.373 12 12 12h39.456c6.627 0 12-5.373 12-12V360H316c6.627 0 12-5.373 12-12v-24c0-6.627-5.373-12-12-12h-92.589v-21.733L238.185 264H316c6.627 0 12-5.373 12-12v-24c0-6.627-5.373-12-12-12h-52.367L358.45 49.87c4.485-7.999-1.296-17.87-10.467-17.87z"}}),l.a.register({"regular/chart-pie-o":{width:512,height:512,d:"M461.29 288H224V50.71c0-8.83-7.18-16.21-15.74-16.21-.7 0-1.4.05-2.11.15C87.08 51.47-3.96 155.43.13 280.07 4.2 404.1 107.91 507.8 231.93 511.87c2.69.09 5.39.13 8.07.13 121.04 0 220.89-89.66 237.35-206.16 1.33-9.45-6.52-17.84-16.06-17.84zM240 464c-2.15 0-4.33-.04-6.5-.11-98.98-3.25-182.15-86.42-185.4-185.4C45.31 193.22 98.36 118.35 176 91.14V336h244.78C394.15 411.06 322.06 464 240 464zM288.8.04c-.35-.03-.7-.04-1.04-.04C279.1 0 272 7.44 272 16.23V240h223.77c9.14 0 16.82-7.69 16.2-16.8C503.72 103.74 408.26 8.28 288.8.04z"}}),l.a.register({"regular/trash-alt":{width:512,height:512,d:"M268 416h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12zM432 80h-82.41l-34-56.7A48 48 0 0 0 274.41 0H173.59a48 48 0 0 0-41.16 23.3L98.41 80H16A16 16 0 0 0 0 96v16a16 16 0 0 0 16 16h16v336a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128h16a16 16 0 0 0 16-16V96a16 16 0 0 0-16-16zM171.84 50.91A6 6 0 0 1 177 48h94a6 6 0 0 1 5.15 2.91L293.61 80H154.39zM368 464H80V128h288zm-212-48h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12z"}}),l.a.register({"light/trash-alt":{width:512,height:512,d:"M296 432h16a8 8 0 0 0 8-8V152a8 8 0 0 0-8-8h-16a8 8 0 0 0-8 8v272a8 8 0 0 0 8 8zm-160 0h16a8 8 0 0 0 8-8V152a8 8 0 0 0-8-8h-16a8 8 0 0 0-8 8v272a8 8 0 0 0 8 8zM440 64H336l-33.6-44.8A48 48 0 0 0 264 0h-80a48 48 0 0 0-38.4 19.2L112 64H8a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8h24v368a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V96h24a8 8 0 0 0 8-8V72a8 8 0 0 0-8-8zM171.2 38.4A16.1 16.1 0 0 1 184 32h80a16.1 16.1 0 0 1 12.8 6.4L296 64H152zM384 464a16 16 0 0 1-16 16H80a16 16 0 0 1-16-16V96h320zm-168-32h16a8 8 0 0 0 8-8V152a8 8 0 0 0-8-8h-16a8 8 0 0 0-8 8v272a8 8 0 0 0 8 8z"}}),l.a.register({"regular/comment-alt-exclamation":{width:512,height:512,d:"M256 256c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32zM448 0H64C28.7 0 0 28.7 0 64v288c0 35.3 28.7 64 64 64h96v84c0 7.1 5.8 12 12 12 2.4 0 4.9-.7 7.1-2.4L304 416h144c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64zm16 352c0 8.8-7.2 16-16 16H288l-12.8 9.6L208 428v-60H64c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16h384c8.8 0 16 7.2 16 16v288zM284.7 96h-57.4c-10 0-17.6 9.1-15.7 18.9l18 96c1.4 7.6 8 13.1 15.7 13.1h21.4c7.7 0 14.3-5.5 15.7-13.1l18-96c1.9-9.8-5.7-18.9-15.7-18.9z"}}),l.a.register({"regular/undo":{width:512,height:512,d:"M12 8h27.711c6.739 0 12.157 5.548 11.997 12.286l-2.347 98.568C93.925 51.834 170.212 7.73 256.793 8.001 393.18 8.428 504.213 120.009 504 256.396 503.786 393.181 392.835 504 256 504c-63.926 0-122.202-24.187-166.178-63.908-5.113-4.618-5.354-12.561-.482-17.433l19.738-19.738c4.498-4.498 11.753-4.785 16.501-.552C160.213 433.246 205.895 452 256 452c108.322 0 196-87.662 196-196 0-108.322-87.662-196-196-196-79.545 0-147.941 47.282-178.675 115.302l126.389-3.009c6.737-.16 12.286 5.257 12.286 11.997V212c0 6.627-5.373 12-12 12H12c-6.627 0-12-5.373-12-12V20C0 13.373 5.373 8 12 8z"}}),l.a.register({"light/pencil":{width:512,height:512,d:"M493.255 56.236l-37.49-37.49c-24.993-24.993-65.515-24.994-90.51 0L12.838 371.162.151 485.346c-1.698 15.286 11.22 28.203 26.504 26.504l114.184-12.687 352.417-352.417c24.992-24.994 24.992-65.517-.001-90.51zm-95.196 140.45L174 420.745V386h-48v-48H91.255l224.059-224.059 82.745 82.745zM126.147 468.598l-58.995 6.555-30.305-30.305 6.555-58.995L63.255 366H98v48h48v34.745l-19.853 19.853zm344.48-344.48l-49.941 49.941-82.745-82.745 49.941-49.941c12.505-12.505 32.748-12.507 45.255 0l37.49 37.49c12.506 12.506 12.507 32.747 0 45.255z"}}),l.a.register({"light/sync":{width:512,height:512,d:"M492 8h-10c-6.627 0-12 5.373-12 12v110.627C426.929 57.261 347.224 8 256 8 123.228 8 14.824 112.338 8.31 243.493 7.971 250.311 13.475 256 20.301 256h10.016c6.353 0 11.646-4.949 11.977-11.293C48.157 132.216 141.097 42 256 42c82.862 0 154.737 47.077 190.289 116H332c-6.627 0-12 5.373-12 12v10c0 6.627 5.373 12 12 12h160c6.627 0 12-5.373 12-12V20c0-6.627-5.373-12-12-12zm-.301 248h-10.015c-6.352 0-11.647 4.949-11.977 11.293C463.841 380.158 370.546 470 256 470c-82.608 0-154.672-46.952-190.299-116H180c6.627 0 12-5.373 12-12v-10c0-6.627-5.373-12-12-12H20c-6.627 0-12 5.373-12 12v160c0 6.627 5.373 12 12 12h10c6.627 0 12-5.373 12-12V381.373C85.071 454.739 164.777 504 256 504c132.773 0 241.176-104.338 247.69-235.493.339-6.818-5.165-12.507-11.991-12.507z"}}),l.a.register({"regular/plus":{width:384,height:512,d:"M368 224H224V80c0-8.84-7.16-16-16-16h-32c-8.84 0-16 7.16-16 16v144H16c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h144v144c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16V288h144c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"}}),l.a.register({"regular/angle-double-right":{width:384,height:512,d:"M363.8 264.5L217 412.5c-4.7 4.7-12.3 4.7-17 0l-19.8-19.8c-4.7-4.7-4.7-12.3 0-17L298.7 256 180.2 136.3c-4.7-4.7-4.7-12.3 0-17L200 99.5c4.7-4.7 12.3-4.7 17 0l146.8 148c4.7 4.7 4.7 12.3 0 17zm-160-17L57 99.5c-4.7-4.7-12.3-4.7-17 0l-19.8 19.8c-4.7 4.7-4.7 12.3 0 17L138.7 256 20.2 375.7c-4.7 4.7-4.7 12.3 0 17L40 412.5c4.7 4.7 12.3 4.7 17 0l146.8-148c4.7-4.7 4.7-12.3 0-17z"}}),l.a.register({"light/clock":{width:512,height:512,d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm216 248c0 118.7-96.1 216-216 216-118.7 0-216-96.1-216-216 0-118.7 96.1-216 216-216 118.7 0 216 96.1 216 216zm-148.9 88.3l-81.2-59c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h14c6.6 0 12 5.4 12 12v146.3l70.5 51.3c5.4 3.9 6.5 11.4 2.6 16.8l-8.2 11.3c-3.9 5.3-11.4 6.5-16.8 2.6z"}}),l.a.register({"light/file-alt":{width:384,height:512,d:"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zm-22.6 22.7c2.1 2.1 3.5 4.6 4.2 7.4H256V32.5c2.8.7 5.3 2.1 7.4 4.2l83.9 83.9zM336 480H48c-8.8 0-16-7.2-16-16V48c0-8.8 7.2-16 16-16h176v104c0 13.3 10.7 24 24 24h104v304c0 8.8-7.2 16-16 16zm-48-244v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm0 64v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm0 64v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12z"}}),l.a.register({"light/question-circle":{width:512,height:512,d:"M256 340c-15.464 0-28 12.536-28 28s12.536 28 28 28 28-12.536 28-28-12.536-28-28-28zm7.67-24h-16c-6.627 0-12-5.373-12-12v-.381c0-70.343 77.44-63.619 77.44-107.408 0-20.016-17.761-40.211-57.44-40.211-29.144 0-44.265 9.649-59.211 28.692-3.908 4.98-11.054 5.995-16.248 2.376l-13.134-9.15c-5.625-3.919-6.86-11.771-2.645-17.177C185.658 133.514 210.842 116 255.67 116c52.32 0 97.44 29.751 97.44 80.211 0 67.414-77.44 63.849-77.44 107.408V304c0 6.627-5.373 12-12 12zM256 40c118.621 0 216 96.075 216 216 0 119.291-96.61 216-216 216-119.244 0-216-96.562-216-216 0-119.203 96.602-216 216-216m0-32C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8z"}}),l.a.register({"light/link":{width:512,height:512,d:"M301.148 394.702l-79.2 79.19c-50.778 50.799-133.037 50.824-183.84 0-50.799-50.778-50.824-133.037 0-183.84l79.19-79.2a132.833 132.833 0 0 1 3.532-3.403c7.55-7.005 19.795-2.004 20.208 8.286.193 4.807.598 9.607 1.216 14.384.481 3.717-.746 7.447-3.397 10.096-16.48 16.469-75.142 75.128-75.3 75.286-36.738 36.759-36.731 96.188 0 132.94 36.759 36.738 96.188 36.731 132.94 0l79.2-79.2.36-.36c36.301-36.672 36.14-96.07-.37-132.58-8.214-8.214-17.577-14.58-27.585-19.109-4.566-2.066-7.426-6.667-7.134-11.67a62.197 62.197 0 0 1 2.826-15.259c2.103-6.601 9.531-9.961 15.919-7.28 15.073 6.324 29.187 15.62 41.435 27.868 50.688 50.689 50.679 133.17 0 183.851zm-90.296-93.554c12.248 12.248 26.362 21.544 41.435 27.868 6.388 2.68 13.816-.68 15.919-7.28a62.197 62.197 0 0 0 2.826-15.259c.292-5.003-2.569-9.604-7.134-11.67-10.008-4.528-19.371-10.894-27.585-19.109-36.51-36.51-36.671-95.908-.37-132.58l.36-.36 79.2-79.2c36.752-36.731 96.181-36.738 132.94 0 36.731 36.752 36.738 96.181 0 132.94-.157.157-58.819 58.817-75.3 75.286-2.651 2.65-3.878 6.379-3.397 10.096a163.156 163.156 0 0 1 1.216 14.384c.413 10.291 12.659 15.291 20.208 8.286a131.324 131.324 0 0 0 3.532-3.403l79.19-79.2c50.824-50.803 50.799-133.062 0-183.84-50.802-50.824-133.062-50.799-183.84 0l-79.2 79.19c-50.679 50.682-50.688 133.163 0 183.851z"}}),l.a.register({"light/copy":{width:448,height:512,d:"M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM352 32.491a15.88 15.88 0 0 1 7.431 4.195l51.882 51.883A15.885 15.885 0 0 1 415.508 96H352V32.491zM288 464c0 8.822-7.178 16-16 16H48c-8.822 0-16-7.178-16-16V144c0-8.822 7.178-16 16-16h80v240c0 26.51 21.49 48 48 48h112v48zm128-96c0 8.822-7.178 16-16 16H176c-8.822 0-16-7.178-16-16V48c0-8.822 7.178-16 16-16h144v72c0 13.2 10.8 24 24 24h72v240z"}});var c=l.a,d=a("af88"),u=(a("0fb7"),a("450d"),a("f529")),f=a.n(u),p=(a("46a1"),a("e5f2")),h=a.n(p),m=(a("9e1f"),a("6ed5")),_=a.n(m),g=(a("be4f"),a("896a")),b=a.n(g),v=(a("2986"),a("14e9")),y=a.n(v),w=(a("b0ee"),a("d180")),C=a.n(w),x=(a("a335"),a("c0bb")),k=a.n(x),I=(a("b8e0"),a("a4c4")),A=a.n(I),S=(a("e2f3"),a("06f9")),O=a.n(S),E=(a("f225"),a("89a9")),T=a.n(E),j=(a("f4f9"),a("c2cc")),$=a.n(j),P=(a("7a0f"),a("0f6c")),D=a.n(P),R=(a("915d"),a("e04d")),U=a.n(R),M=(a("cbb5"),a("8bbc")),L=a.n(M),z=(a("e612"),a("dd87")),N=a.n(z),B=(a("075a"),a("72aa")),F=a.n(B),q=(a("eca7"),a("3787")),V=a.n(q),Y=(a("425f"),a("4105")),H=a.n(Y),W=(a("b84d"),a("c216")),Q=a.n(W),G=(a("8f24"),a("76b9")),Z=a.n(G),J=(a("0c67"),a("299c")),K=a.n(J),X=(a("826b"),a("c263")),tt=a.n(X),et=(a("5466"),a("ecdf")),at=a.n(et),it=(a("38a0"),a("ad41")),nt=a.n(it),rt=(a("ae26"),a("845f")),ot=a.n(rt),st=(a("1951"),a("eedf")),lt=a.n(st),ct=(a("016f"),a("486c")),dt=a.n(ct),ut=(a("6611"),a("e772")),ft=a.n(ut),pt=(a("1f1a"),a("4e4b")),ht=a.n(pt),mt=(a("e960"),a("b35b")),_t=a.n(mt),gt=(a("d4df"),a("7fc1")),bt=a.n(gt),vt=(a("c526"),a("1599")),yt=a.n(vt),wt=(a("560b"),a("dcdc")),Ct=a.n(wt),xt=(a("3c52"),a("0d7b")),kt=a.n(xt),It=(a("fe07"),a("6ac5")),At=a.n(It),St=(a("b5d8"),a("f494")),Ot=a.n(St),Et=(a("9d4c"),a("e450")),Tt=a.n(Et),jt=(a("10cb"),a("f3ad")),$t=a.n(jt),Pt=(a("34db"),a("3803")),Dt=a.n(Pt),Rt=(a("8bd8"),a("4cb2")),Ut=a.n(Rt),Mt=(a("ce18"),a("f58e")),Lt=a.n(Mt),zt=(a("4ca3"),a("443e")),Nt=a.n(zt),Bt=(a("bd49"),a("18ff")),Ft=a.n(Bt),qt=(a("960d"),a("defb")),Vt=a.n(qt),Yt=(a("cb70"),a("b370")),Ht=a.n(Yt),Wt=(a("a7cc"),a("df33")),Qt=a.n(Wt),Gt=(a("672e"),a("101e")),Zt=a.n(Gt),Jt=(a("fd71"),a("a447")),Kt=a.n(Jt),Xt=(a("0fae"),a("5488")),te=a.n(Xt);n.default.use(Kt.a),n.default.use(Zt.a),n.default.use(Qt.a),n.default.use(Ht.a),n.default.use(Vt.a),n.default.use(Ft.a),n.default.use(Nt.a),n.default.use(Lt.a),n.default.use(Ut.a),n.default.use(Dt.a),n.default.use($t.a),n.default.use(Tt.a),n.default.use(Ot.a),n.default.use(At.a),n.default.use(kt.a),n.default.use(Ct.a),n.default.use(yt.a),n.default.use(bt.a),n.default.use(_t.a),n.default.use(ht.a),n.default.use(ft.a),n.default.use(dt.a),n.default.use(lt.a),n.default.use(ot.a),n.default.use(nt.a),n.default.use(at.a),n.default.use(tt.a),n.default.use(K.a),n.default.use(Z.a),n.default.use(Q.a),n.default.use(H.a),n.default.use(V.a),n.default.use(F.a),n.default.use(N.a),n.default.use(L.a),n.default.use(U.a),n.default.use(D.a),n.default.use($.a),n.default.use(T.a),n.default.use(O.a),n.default.use(A.a),n.default.use(k.a),n.default.use(C.a),n.default.use(y.a),n.default.component(te.a.name,te.a),n.default.use(b.a.directive),n.default.prototype.$loading=b.a.service,n.default.prototype.$msgbox=_.a,n.default.prototype.$alert=_.a.alert,n.default.prototype.$confirm=_.a.confirm,n.default.prototype.$prompt=_.a.prompt,n.default.prototype.$notify=h.a,n.default.prototype.$message=f.a;var ee=a("323e"),ae=a.n(ee),ie=(a("a5d8"),a("f5df1"),a("8096"),a("38e1")),ne=(a("3433"),a("e085"),a("ed22"),a("f7ef"),function(){var t=this.$createElement;return(this._self._c||t)("router-view")}),re=(a("472c"),{name:"app"}),oe=a("2877"),se=Object(oe.a)(re,ne,[],!1,null,null,null).exports;function le(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}n.default.config.productionTip=!1,n.default.prototype.$http=s.a,n.default.use(d.a),n.default.component("icon",c),window.Vue=n.default,window.Router=a("8c4f"),window.Vuex=a("2f62"),window.$http=s.a,window.$router=r.c,window.$store=o.a,window.plugins=[],window.NProgress=ae.a;var ce=["404","auth.login","auth.register","auth.password.forget","auth.password.reset"];r.c.beforeEach((function(t,e,a){ae.a.start(),o.a.state.user.token?"auth.login"===t.name?a({name:"管理中心"}):o.a.getters.userInfo&&o.a.getters.userInfo.id?a():o.a.dispatch("GetInfo").then((function(e){o.a.dispatch("GenerateRoutes",e).then((function(){r.c.addRoutes(o.a.getters.addRouters),a(function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?le(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):le(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},t))}))})).catch((function(t){o.a.commit("SET_TOKEN",null),r.c.push({name:"auth.login"})})):-1!==ce.indexOf(t.name)?a():(a({name:"auth.login",params:{to:t.path}}),ae.a.done())})),r.c.afterEach((function(t){t.meta&&t.meta.title?document.title=t.meta.title:document.title=t.name,ae.a.done()})),n.default.config.errorHandler=function(t,e){ie.a.pushLog({err:t,url:window.location.href,vm:e})},window.bus=new n.default,new n.default({el:"#app",router:r.c,store:o.a,render:function(t){return t(se)}});try{document.getElementById("progress").parentNode.removeChild(document.getElementById("progress"))}catch(t){}},5915:function(t,e,a){"use strict";var i=a("df4a");a.n(i).a},"59fe":function(t,e,a){},"5ec0":function(t,e,a){},"606a":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"h",(function(){return r})),a.d(e,"b",(function(){return o})),a.d(e,"f",(function(){return s})),a.d(e,"g",(function(){return l})),a.d(e,"j",(function(){return c})),a.d(e,"i",(function(){return d})),a.d(e,"k",(function(){return u})),a.d(e,"m",(function(){return f})),a.d(e,"l",(function(){return p})),a.d(e,"e",(function(){return h})),a.d(e,"d",(function(){return m})),a.d(e,"c",(function(){return _}));var i=a("b247"),n={AUTO:0,MANUAL:1};function r(t){return Object(i.a)({url:"product",method:"get",params:t})}function o(t,e){return Object(i.a)({url:"product/category",method:"post",data:{id:t,category_id:e}})}function s(t){return Object(i.a)({url:"product/edit",method:"post",data:t})}function l(t,e){return Object(i.a)({url:"product/enable",method:"post",data:{ids:t,enabled:e}})}function c(t,e){return Object(i.a)({url:"product/retail_batch_open_enable",method:"post",data:{ids:t,retail_batch_open:e}})}function d(t){return Object(i.a)({url:"product/retail_batch_add_product",method:"post",data:t})}function u(t){return Object(i.a)({url:"product/search_shop_retail",method:"get",params:t})}function f(t,e){return Object(i.a)({url:"product/sort",method:"post",data:{id:t,sort:e}})}function p(t,e){return Object(i.a)({url:"product/set_count",method:"post",data:{id:t,count:e}})}function h(t){return Object(i.a)({url:"product/delete",method:"post",data:{ids:t}})}function m(t){return Object(i.a)({url:"product/count/sync",method:"post",data:{user_id:t}})}function _(t){return Object(i.a)({url:"product/retail/check",method:"get",params:{code:t}})}},"60be":function(t,e,a){},"60c4":function(t,e,a){},"657f":function(t,e,a){"use strict";var i=a("7033");a.n(i).a},"673e":function(t,e,a){},"6bff":function(t,e,a){"use strict";var i=a("981c");a.n(i).a},7033:function(t,e,a){},"72c1":function(t,e,a){},7457:function(t,e,a){},"760d":function(t,e,a){"use strict";var i=a("f250");a.n(i).a},7856:function(t,e,a){"use strict";var i=a("4150");a.n(i).a},"790b":function(t,e,a){},"7b4d":function(t,e,a){"use strict";var i=a("a278");a.n(i).a},"7d8d":function(t,e,a){"use strict";var i=a("3d22");a.n(i).a},"804a":function(t,e,a){"use strict";var i=a("b78a");a.n(i).a},"87c8":function(t,e,a){"use strict";var i=a("790b");a.n(i).a},"88ab":function(t,e,a){"use strict";var i=a("be4b");a.n(i).a},"8ce6":function(t,e,a){t.exports=a.p+"img/404_cloud.0f4bc32b.png"},9525:function(t,e,a){"use strict";var i=a("1a1f");a.n(i).a},"962d":function(t,e,a){},"963b":function(t,e,a){},"981c":function(t,e,a){},9861:function(t,e,a){},"99c2":function(t,e,a){"use strict";var i=a("72c1");a.n(i).a},"9bd6":function(t,e,a){},"9bf7":function(t,e,a){},"9c88":function(t,e,a){"use strict";var i=a("673e");a.n(i).a},"9d61":function(t,e,a){t.exports=a.p+"img/qq-group.ef24d8c8.png"},a18c:function(t,e,a){"use strict";a("a4d3"),a("e01a"),a("d28b"),a("d3b7"),a("3ca3"),a("ddb0");var i=a("a026"),n=a("8c4f"),r=(a("4de4"),a("4160"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("ade3")),o=a("2f62"),s=(a("99af"),a("b0c0"),{created:function(){this.getBreadcrumb()},data:function(){return{levelList:null}},methods:{getBreadcrumb:function(){var t=this.$route.matched.filter((function(t){return t.name})),e=t[0];!e||"首页"===e.name&&""===e.path||(t=[{name:"首页",path:"/m/"}].concat(t)),this.levelList=t}},watch:{$route:function(){this.getBreadcrumb()}}}),l=(a("ff16"),a("2877")),c=Object(l.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-breadcrumb",{staticClass:"app-levelbar",attrs:{separator:"/"}},t._l(t.levelList,(function(e,i){return a("el-breadcrumb-item",{key:i},["noredirect"===e.redirect||i===t.levelList.length-1?a("router-link",{staticClass:"no-redirect",attrs:{to:""}},[t._v(" "+t._s(e.name)+" ")]):a("router-link",{attrs:{to:e.redirect||e.path}},[t._v(t._s(e.name))])],1)})),1)}),[],!1,null,"1f06b2a4",null).exports,d=(a("c975"),a("fb6a"),{data:function(){return{availableWidth:999,takeCount:6,showTabs:!this.$store.state.app.isMobile}},computed:{visitedViews:function(){return this.$store.state.app.visitedViews.slice(-this.takeCount)}},watch:{$route:function(t,e){0===this.visitedViews.length&&this.addViewTabs(e),this.addViewTabs()}},methods:{closeViewTabs:function(t,e){if(this.visitedViews.length>0){var a=this.visitedViews.indexOf(t);a>0?this.$router.push(this.visitedViews[a-1]):this.$router.push(this.visitedViews[this.visitedViews.length-1])}this.$store.dispatch("delVisitedViews",t),e.preventDefault()},generateRoute:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t.matched[t.matched.length-1].name?t.matched[t.matched.length-1]:(t.matched[0].path="/",t.matched[0])},addViewTabs:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.$store.dispatch("addVisitedViews",this.generateRoute(t||this.$route))},isActive:function(t){return t===this.$route.path},calcAvailableWidth:function(){var t=document.getElementsByClassName("navbar")[0],e=document.getElementsByClassName("hamburger-container")[0],a=document.getElementsByClassName("app-levelbar")[0],i=e.offsetWidth+a.offsetWidth+120;this.availableWidth=t.clientWidth-i,this.takeCount=parseInt(this.availableWidth/100)},resizeHandler:function(){this.calcAvailableWidth()}},mounted:function(){window.addEventListener("resize",this.resizeHandler);var t=document.getElementById("sidebar-container");t&&t.addEventListener("transitionend",this.resizeHandler)},beforeDestroy:function(){window.removeEventListener("resize",this.resizeHandler);var t=document.getElementById("sidebar-container");t&&t.removeEventListener("transitionend",this.resizeHandler)}}),u=(a("ae71"),Object(l.a)(d,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"show",rawName:"v-show",value:t.showTabs,expression:"showTabs"}],staticClass:"tabs-view-container"},t._l(t.visitedViews,(function(e){return a("router-link",{key:e.path,staticClass:"tabs-view",attrs:{to:e.path}},[a("el-tag",{attrs:{closable:!0,type:t.isActive(e.path)?"primary":""},on:{close:function(a){return t.closeViewTabs(e,a)},click:function(a){return a.preventDefault(),t.$router.push(e.path)}}},[t._v(" "+t._s(e.name)+" ")])],1)})),1)}),[],!1,null,null,null)).exports,f={name:"hamburger",props:{isActive:{type:Boolean,default:!1},toggleClick:{type:Function,default:null}}},p=(a("3089"),Object(l.a)(f,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("svg",{staticClass:"svg-icon hamburger",class:{"is-active":t.isActive},attrs:{t:"1492500959545",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1691","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"64",height:"64"},on:{click:t.toggleClick}},[a("path",{attrs:{d:"M966.8023 568.849776 57.196677 568.849776c-31.397081 0-56.850799-25.452695-56.850799-56.850799l0 0c0-31.397081 25.452695-56.849776 56.850799-56.849776l909.605623 0c31.397081 0 56.849776 25.452695 56.849776 56.849776l0 0C1023.653099 543.397081 998.200404 568.849776 966.8023 568.849776z","p-id":"1692"}}),a("path",{attrs:{d:"M966.8023 881.527125 57.196677 881.527125c-31.397081 0-56.850799-25.452695-56.850799-56.849776l0 0c0-31.397081 25.452695-56.849776 56.850799-56.849776l909.605623 0c31.397081 0 56.849776 25.452695 56.849776 56.849776l0 0C1023.653099 856.07443 998.200404 881.527125 966.8023 881.527125z","p-id":"1693"}}),a("path",{attrs:{d:"M966.8023 256.17345 57.196677 256.17345c-31.397081 0-56.850799-25.452695-56.850799-56.849776l0 0c0-31.397081 25.452695-56.850799 56.850799-56.850799l909.605623 0c31.397081 0 56.849776 25.452695 56.849776 56.850799l0 0C1023.653099 230.720755 998.200404 256.17345 966.8023 256.17345z","p-id":"1694"}})])])}),[],!1,null,"1aabbe18",null)).exports,h={name:"errLog",props:{logsList:{type:Array}},data:function(){return{dialogTableVisible:!1}}},m=(a("136e"),Object(l.a)(h,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-badge",{staticStyle:{"line-height":"30px"},attrs:{"is-dot":!0},nativeOn:{click:function(e){t.dialogTableVisible=!0}}},[a("el-button",{attrs:{size:"small",type:"primary"}},[a("svg",{staticClass:"bug-svg",attrs:{t:"1492682037685",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1863","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"64",height:"64"}},[a("path",{attrs:{d:"M969.142857 548.571429q0 14.848-10.861714 25.709714t-25.709714 10.861714l-128 0q0 97.718857-38.290286 165.705143l118.857143 119.442286q10.861714 10.861714 10.861714 25.709714t-10.861714 25.709714q-10.276571 10.861714-25.709714 10.861714t-25.709714-10.861714l-113.152-112.566857q-2.852571 2.852571-8.557714 7.424t-23.990857 16.274286-37.156571 20.845714-46.848 16.566857-55.442286 7.424l0-512-73.142857 0 0 512q-29.147429 0-58.002286-7.716571t-49.700571-18.870857-37.705143-22.272-24.868571-18.578286l-8.557714-8.009143-104.557714 118.272q-11.446857 11.995429-27.428571 11.995429-13.714286 0-24.576-9.142857-10.861714-10.276571-11.702857-25.417143t8.850286-26.587429l115.419429-129.718857q-33.133714-65.133714-33.133714-156.562286l-128 0q-14.848 0-25.709714-10.861714t-10.861714-25.709714 10.861714-25.709714 25.709714-10.861714l128 0 0-168.009143-98.852571-98.852571q-10.861714-10.861714-10.861714-25.709714t10.861714-25.709714 25.709714-10.861714 25.709714 10.861714l98.852571 98.852571 482.304 0 98.852571-98.852571q10.861714-10.861714 25.709714-10.861714t25.709714 10.861714 10.861714 25.709714-10.861714 25.709714l-98.852571 98.852571 0 168.009143 128 0q14.848 0 25.709714 10.861714t10.861714 25.709714zM694.857143 219.428571l-365.714286 0q0-75.995429 53.430857-129.426286t129.426286-53.430857 129.426286 53.430857 53.430857 129.426286z","p-id":"1864"}})])])],1),a("el-dialog",{staticClass:"buy-view-dialog",attrs:{title:"bug日志",visible:t.dialogTableVisible},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("el-table",{attrs:{data:t.logsList}},[a("el-table-column",{attrs:{label:"message"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("msg:"+t._s(e.row.err.message))]),a("div",[t._v("url: "+t._s(e.row.url))])]}}])}),a("el-table-column",{attrs:{label:"stack"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("pre",[t._v(t._s(e.row.err.stack))])]}}])})],1)],1)],1)}),[],!1,null,null,null)).exports,_=a("38e1");function g(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}var b={components:{LevelBar:c,NavTabs:u,Hamburger:p,ErrorLog:m},data:function(){return{log:_.a.state.errLog}},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?g(Object(a),!0).forEach((function(e){Object(r.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},Object(o.mapGetters)(["sidebar"])),methods:{toggleSideBar:function(){this.$store.dispatch("ToggleSideBar")},logout:function(){this.$store.dispatch("Logout").then((function(){location.reload()}))}}},v=(a("01d8"),Object(l.a)(b,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-menu",{staticClass:"navbar",attrs:{mode:"horizontal"}},[i("hamburger",{staticClass:"hamburger-container",attrs:{toggleClick:t.toggleSideBar,isActive:t.sidebar.opened}}),i("level-bar"),i("nav-tabs"),t.log.length>0?i("error-log",{staticClass:"errLog-container",attrs:{logsList:t.log}}):t._e(),i("div",{staticClass:"toolbar"},[i("el-dropdown",{staticClass:"toolbar-icon",attrs:{trigger:"click","show-timeout":0,"hide-timeout":0}},[i("div",{staticClass:"avatar-wrapper"},[i("img",{staticClass:"user-avatar",attrs:{src:a("d200")}}),i("i",{staticClass:"el-icon-caret-bottom"})]),i("el-dropdown-menu",{staticClass:"user-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[i("router-link",{staticClass:"inlineBlock",attrs:{to:"/m/"}},[i("el-dropdown-item",[t._v("后台主页")])],1),i("router-link",{staticClass:"inlineBlock",attrs:{to:"/m/shopController/info"}},[i("el-dropdown-item",{attrs:{divided:""}},[t._v("店铺信息")])],1),i("router-link",{staticClass:"inlineBlock",attrs:{to:"/m/shopController/link"}},[i("el-dropdown-item",[t._v("店铺链接")])],1),i("router-link",{staticClass:"inlineBlock",attrs:{to:"/m/user/security"}},[i("el-dropdown-item",[t._v("修改密码")])],1),i("el-dropdown-item",{attrs:{divided:""}},[i("span",{staticStyle:{display:"block"},on:{click:t.logout}},[t._v(" 退出"),i("icon",{attrs:{name:"sign-out-alt"}})],1)])],1)],1)],1)],1)}),[],!1,null,"30fd67a2",null)).exports,y={name:"item",props:{routes:{type:Array}}};function w(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}var C={components:{item:(a("0825"),Object(l.a)(y,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"menu-wrapper"},[t._l(t.routes,(function(e){return[!e.hidden&&e.noDropdown&&e.children.length>0?a("router-link",{attrs:{to:e.path+"/"+e.children[0].path}},[a("el-menu-item",{staticClass:"submenu-title-noDropdown",attrs:{index:e.path+"/"+e.children[0].path}},[e.icon?a("icon",{attrs:{name:e.icon}}):t._e(),a("span",{staticClass:"menu-title"},[t._v(t._s(e.children[0].name))])],1)],1):t._e(),e.noDropdown||e.hidden?t._e():a("el-submenu",{attrs:{index:e.name}},[a("template",{slot:"title"},[e.icon?a("icon",{attrs:{name:e.icon}}):t._e(),a("span",{staticClass:"menu-title"},[t._v(t._s(e.name))])],1),t._l(e.children,(function(i){return i.hidden?t._e():[i.children&&i.children.length>0?a("item",{staticClass:"nest-menu",attrs:{routes:[i]}}):a("router-link",{attrs:{to:e.path+"/"+i.path}},[i.hide?t._e():a("el-menu-item",{attrs:{index:e.path+"/"+i.path}},[i.icon?a("icon",{attrs:{name:i.icon}}):t._e(),a("span",{staticClass:"menu-title"},[t._v(t._s(i.name))])],1)],1)]}))],2)]}))],2)}),[],!1,null,"751a90bd",null)).exports},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?w(Object(a),!0).forEach((function(e){Object(r.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},Object(o.mapGetters)(["permission_routers","sidebar"]),{isCollapse:function(){return!this.sidebar.opened}})},x={name:"AppMain",computed:{key:function(){return void 0!==this.$route.name?this.$route.name+ +new Date:this.$route+ +new Date}}},k={name:"layout",components:{Navbar:v,Sidebar:(a("20fe"),a("88ab"),Object(l.a)(C,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-menu",{attrs:{mode:"vertical","default-active":t.$route.path,collapse:t.isCollapse}},[a("item",{attrs:{routes:t.permission_routers}})],1)],1)}),[],!1,null,"1493b899",null)).exports,AppMain:Object(l.a)(x,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"app-main"},[a("transition",{attrs:{name:"fade",mode:"out-in"}},[a("router-view",{key:t.key})],1)],1)}),[],!1,null,null,null).exports},data:function(){return{mainWidth:"auto"}},computed:{sidebarOpen:function(){return this.$store.state.app.sidebar.opened}},watch:{sidebarOpen:function(){this.resizeHandler({type:"sidebarOpen",propertyName:"width"})}},mounted:function(){this.reCalcMainWidth(),window.addEventListener("resize",this.resizeHandler)},beforeDestroy:function(){window.removeEventListener("resize",this.resizeHandler)},methods:{resizeHandler:function(t){!t||"resize"!==t.type&&"width"!==t.propertyName||(this.reCalcMainWidth(),window.bus.$emit("app-resize"))},reCalcMainWidth:function(){this.$store.state.app.isMobile&&document.body.clientWidth!==this.oldClientWidth&&(this.oldClientWidth=document.body.clientWidth,this.mainWidth=document.body.clientWidth-this.$refs["side-bar"].$el.clientWidth+"px")}}},I=(a("2830"),Object(l.a)(k,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-wrapper",class:{hideSidebar:!t.sidebarOpen,showSidebar:t.sidebarOpen}},[a("sidebar",{ref:"side-bar",staticClass:"sidebar-container",attrs:{id:"sidebar-container"},on:{transitionend:t.resizeHandler}}),a("div",{staticClass:"main-container"},[a("div",{style:{width:t.mainWidth}},[a("navbar",{ref:"nav-bar"}),a("app-main")],1)])],1)}),[],!1,null,"4c8b4d2c",null)).exports,A=(a("7856"),{}),S=Object(l.a)(A,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"auth-page"},[e("div",{staticClass:"auth-middle"},[e("router-view",{staticClass:"auth-content"})],1)])}),[],!1,null,null,null).exports,O=(a("96cf"),a("1da1"));function E(t){return/[\w!#$%&'*+/=?^_`{|}~-]+(?:\.[\w!#$%&'*+/=?^_`{|}~-]+)*@(?:[\w](?:[\w-]*[\w])?\.)+[\w](?:[\w-]*[\w])?/.test(t.trim())}a("498a");var T=a("b247");var j={name:"Captcha",props:{driver:{type:String},config:{}},data:function(){return{loading:!0,code:{img:"data:image/bmp;base64,Qk1CAAAAAAAAAD4AAAAoAAAAAQAAAAEAAAABAAEAAAAAAAQAAADEDgAAxA4AAAAAAAAAAAAAAAAAAP///wCAAAAA",input:"",key:""},geetest:{elementId:"gee-embed-",bindId:"gee-btn-",config:window.config.captcha.config,validate:null}}},beforeMount:function(){"code"===this.driver||"geetest"===this.driver&&(this.geetest.elementId="gee-embed-"+parseInt(99999*Math.random()),this.geetest.bindId="gee-btn-"+parseInt(99999*Math.random()))},methods:{refresh:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.loading=!0,"code"!==this.driver){t.next=7;break}return t.next=4,this.$http.get("//".concat(window.API_HOST,"/captcha/api?t=").concat(Math.random()));case 4:this.code=t.sent,t.next=25;break;case 7:if("geetest"!==this.driver){t.next=20;break}if(this.geetest.validate=null,(e=document.getElementById(this.geetest.elementId))&&(e.innerHTML=""),!this.geetest.config.used&&this.geetest.config.key){t.next=15;break}return t.next=14,Object(T.a)({url:"captcha",method:"get",params:{t:Math.random()}});case 14:this.geetest.config=t.sent;case 15:return this.geetest.config.used=!0,t.next=18,new Promise((function(t,e){try{var i=setTimeout((function(){if(a.loading){var t=document.getElementById(a.geetest.elementId);t&&(t.innerHTML=""),e(new Error("页面超时，请刷新页面重试"))}}),5e3);window.initGeetest({gt:a.geetest.config.gt,challenge:a.geetest.config.challenge,product:"popup",offline:!a.geetest.config.success},(function(n){n.onReady((function(){clearTimeout(i),t()})),n.onError((function(){clearTimeout(i),e(new Error("页面超时，请刷新页面重试"))})),n.onSuccess((function(){a.geetest.validate=n.getValidate(),a.handleValidate()})),window.errors||(window.errors=[]),document.getElementById(a.geetest.elementId)&&(n.appendTo("#"+a.geetest.elementId),n.bindOn&&n.bindOn("#"+a.geetest.bindId)),a.geetest.obj=n}))}catch(t){e(new Error("验证码初始化失败，请刷新页面重试: "+t))}}));case 18:t.next=25;break;case 20:if("recaptcha"!==this.driver){t.next=24;break}t.next=25;break;case 24:throw new Error("unimplemented");case 25:this.loading=!1;case 26:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),verify:function(){var t=this;return new Promise((function(e,a){"code"===t.driver?t.code.input&&t.code.input.length?e():a(new Error("请输入验证码")):"geetest"===t.driver?t.geetest.validate?e():a(new Error("请先完成验证")):"recaptcha"===t.driver&&a(new Error("unimplemented"))}))},focus:function(){"code"===this.driver&&this.$refs.code.focus()},handleValidate:function(){"code"===this.driver?this.$emit("input",{code:this.code.input,key:this.code.key}):"geetest"===this.driver?this.$emit("input",{a:this.geetest.config.key,b:this.geetest.validate.geetest_challenge,c:this.geetest.validate.geetest_validate,d:this.geetest.validate.geetest_seccode}):"recaptcha"===this.driver&&this.$emit("input","unimplemented")}}},$=(a("5915"),Object(l.a)(j,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return"code"===t.driver?a("el-input",{ref:"code",staticClass:"captcha-code-input",attrs:{type:"text",placeholder:"图片验证码"},on:{input:t.handleValidate},model:{value:t.code.input,callback:function(e){t.$set(t.code,"input",e)},expression:"code.input"}},[a("img",{staticClass:"captcha-pulse",class:{loading:t.loading},attrs:{slot:"append",alt:"captcha",src:t.code.img,title:"更换验证码"},on:{click:t.refresh},slot:"append"})]):"geetest"===t.driver?a("div",[a("div",{staticClass:"captcha-geetest-container captcha-pulse",class:{loading:t.loading},attrs:{id:t.geetest.elementId}}),a("button",{staticStyle:{display:"none"},attrs:{id:t.geetest.bindId},on:{click:function(e){return e.preventDefault(),t.handleValidate(e)}}})]):a("div",[a("h1",[t._v("UNKNOWN CAPTCHA DRIVER")])])}),[],!1,null,null,null)).exports;function P(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function D(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?P(Object(a),!0).forEach((function(e){Object(r.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var R={components:{Captcha:$},data:function(){return{loading:!1,captcha:D({loading:!1},window.config.captcha),form:{email:this.$route.query.email,password:"",captcha:{},remember:!1},formRules:{email:[{required:!0,message:"请输入电子邮箱",trigger:"blur"},{validator:function(t,e,a){E(e)?a():a(new Error("请输入正确的邮箱"))}}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},mounted:function(){this.refreshCaptcha()},methods:{refreshCaptcha:function(){var t=this;this.captcha.scene.auth.login&&(this.captcha.loading=!0,this.$refs.captcha.refresh().then((function(){t.captcha.loading=!1})).catch((function(e){t.$alert("验证码加载失败，请刷新重试<br>"+e.message,{dangerouslyUseHTMLString:!0})})))},handleLogin:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){var e,a,i,n,r,o,s,l=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs.form.validate();case 3:t.next=35;break;case 5:t.prev=5,t.t0=t.catch(0),e=!0,a=!1,i=void 0,t.prev=10,n=function(){var t=o.value;if("error"===t.validateState)return l.$alert(t.validateMessage,{type:"error"}).finally((function(){t.$children[1].focus()})),"break"},r=this.$refs.form.fields[Symbol.iterator]();case 13:if(e=(o=r.next()).done){t.next=20;break}if("break"!==n()){t.next=17;break}return t.abrupt("break",20);case 17:e=!0,t.next=13;break;case 20:t.next=26;break;case 22:t.prev=22,t.t1=t.catch(10),a=!0,i=t.t1;case 26:t.prev=26,t.prev=27,e||null==r.return||r.return();case 29:if(t.prev=29,!a){t.next=32;break}throw i;case 32:return t.finish(29);case 33:return t.finish(26);case 34:return t.abrupt("return");case 35:if(!this.captcha.scene.auth.login){t.next=45;break}return t.prev=36,t.next=39,this.$refs.captcha.verify();case 39:t.next=45;break;case 41:return t.prev=41,t.t2=t.catch(36),this.$alert(t.t2.message,{type:"error",dangerouslyUseHTMLString:!0}).finally((function(){l.$refs.captcha.focus()})),t.abrupt("return");case 45:return this.loading=!0,t.prev=46,t.next=49,this.$store.dispatch("Login",this.form);case 49:s=t.sent,this.loading=!1,this.$store.dispatch("GenerateRoutes",s).then((function(){l.$router.addRoutes(l.$store.getters.addRouters),l.$route.query.to?l.$router.push({path:l.$route.query.to}):l.$router.push({name:"管理中心"})})),t.next=58;break;case 54:t.prev=54,t.t3=t.catch(46),this.loading=!1,this.refreshCaptcha();case 58:case"end":return t.stop()}}),t,this,[[0,5],[10,22,26,34],[27,,29,33],[36,41],[46,54]])})));return function(){return t.apply(this,arguments)}}()}},U=Object(l.a)(R,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{ref:"form",staticClass:"login-form",attrs:{model:t.form,rules:t.formRules,"label-position":"left","label-width":"0px"},nativeOn:{submit:function(e){return e.preventDefault(),t.handleLogin(e)}}},[a("div",{staticClass:"title"},[a("h2",[t._v("商家登录")]),a("span",{staticClass:"right"},[t._v("没有帐户？"),a("router-link",{staticClass:"my-link",attrs:{to:{name:"auth.register"}}},[t._v("立即注册")])],1)]),a("el-form-item",{attrs:{prop:"email"}},[a("el-input",{attrs:{type:"email",placeholder:"电子邮箱"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t.captcha.scene.auth.login?a("el-form-item",{attrs:{prop:"captcha"}},[a("captcha",{ref:"captcha",attrs:{driver:t.captcha.driver,config:t.captcha.config},model:{value:t.form.captcha,callback:function(e){t.$set(t.form,"captcha",e)},expression:"form.captcha"}})],1):t._e(),a("el-checkbox",{staticClass:"remember",model:{value:t.form.remember,callback:function(e){t.$set(t.form,"remember",e)},expression:"form.remember"}},[t._v("使我保持登录状态")]),a("router-link",{staticClass:"my-link",staticStyle:{float:"right"},attrs:{to:{name:"auth.password.forget"}}},[t._v("忘记密码？")]),a("el-form-item",{staticStyle:{margin:"24px 0 0"}},[a("el-button",{staticClass:"auth-button",attrs:{type:"primary","native-type":"submit",loading:t.loading||t.captcha.loading},nativeOn:{click:function(e){return e.preventDefault(),t.handleLogin(e)}}},[t._v(t._s(t.captcha.loading?"加载中":"登录")+" ")])],1)],1)}),[],!1,null,null,null).exports,M=a("07c5");function L(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function z(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?L(Object(a),!0).forEach((function(e){Object(r.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):L(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var N={components:{Captcha:$},data:function(){var t=this;return{loading:!1,captcha:z({loading:!1},window.config.captcha),form:{email:"",password:"",password_confirmation:"",checkTos:!1,captcha:{}},tosVisible:!1,formRules:{email:[{required:!0,message:"请输入电子邮箱",trigger:"blur"},{validator:function(t,e,a){E(e)?a():a(new Error("请输入正确的邮箱"))}}],password:[{required:!0,validator:function(e,a,i){""===a?i(new Error("请输入密码")):(""!==t.form.password_confirmation&&t.$refs.form.validateField("password_confirmation"),i())},trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}],password_confirmation:[{required:!0,validator:function(e,a,i){""===a?i(new Error("请再次输入密码")):a!==t.form.password?i(new Error("两次输入密码不一致!")):i()},trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}],checkTos:[{validator:function(e,a,i){t.form.checkTos?i():i(new Error("请先阅读并同意《用户协议》"))}}]}}},mounted:function(){var t=this;window.config.register.open?(this.refreshCaptcha(),this.showTos()):this.$msgbox(window.config.register.reason||"系统已关闭注册").finally((function(){t.$router.push({name:"auth.login"})}))},methods:{refreshCaptcha:function(){var t=this;this.captcha.scene.auth.register&&(this.captcha.loading=!0,this.$refs.captcha.refresh().then((function(){t.captcha.loading=!1})).catch((function(e){t.$alert("验证码加载失败，请刷新重试<br>"+e.message,{dangerouslyUseHTMLString:!0})})))},handleRegister:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){var e,a,i,n,r,o,s=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs.form.validate();case 3:t.next=35;break;case 5:t.prev=5,t.t0=t.catch(0),e=!0,a=!1,i=void 0,t.prev=10,n=function(){var t=o.value;if("error"===t.validateState)return s.$alert(t.validateMessage,{type:"error"}).finally((function(){t.$children[1].focus()})),"break"},r=this.$refs.form.fields[Symbol.iterator]();case 13:if(e=(o=r.next()).done){t.next=20;break}if("break"!==n()){t.next=17;break}return t.abrupt("break",20);case 17:e=!0,t.next=13;break;case 20:t.next=26;break;case 22:t.prev=22,t.t1=t.catch(10),a=!0,i=t.t1;case 26:t.prev=26,t.prev=27,e||null==r.return||r.return();case 29:if(t.prev=29,!a){t.next=32;break}throw i;case 32:return t.finish(29);case 33:return t.finish(26);case 34:return t.abrupt("return");case 35:if(!this.captcha.scene.auth.register){t.next=45;break}return t.prev=36,t.next=39,this.$refs.captcha.verify();case 39:t.next=45;break;case 41:return t.prev=41,t.t2=t.catch(36),this.$alert(t.t2.message,{type:"error",dangerouslyUseHTMLString:!0}).finally((function(){s.$refs.captcha.focus()})),t.abrupt("return");case 45:return this.loading=!0,t.prev=46,this.$route.query.aff&&(this.form.aff=this.$route.query.aff),t.next=50,Object(M.e)(this.form);case 50:this.$msgbox({title:"成功",message:"恭喜，您已经成功注册",type:"success",confirmButtonText:"去登录"}).then((function(){s.$router.push({name:"auth.login",query:{email:s.form.email}})})),t.next=56;break;case 53:t.prev=53,t.t3=t.catch(46),this.refreshCaptcha();case 56:return t.prev=56,this.loading=!1,t.finish(56);case 59:case"end":return t.stop()}}),t,this,[[0,5],[10,22,26,34],[27,,29,33],[36,41],[46,53,56,59]])})));return function(){return t.apply(this,arguments)}}(),showTos:function(){this.tosVisible=!0,this.form.checkTos=!1},handleTosAccept:function(){this.tosVisible=!1,this.form.checkTos=!0}}},B=(a("b923"),Object(l.a)(N,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"register-container"},[a("el-form",{ref:"form",staticClass:"register-form",attrs:{model:t.form,rules:t.formRules,"label-position":"left","label-width":"0px"}},[a("div",{staticClass:"title"},[a("h2",[t._v("商家注册")]),a("span",{staticClass:"right"},[t._v("已经注册？"),a("router-link",{staticClass:"my-link",attrs:{to:{name:"auth.login"}}},[t._v("立即登录")])],1)]),a("el-form-item",{attrs:{prop:"email"}},[a("el-input",{attrs:{type:"email",placeholder:"请输入电子邮箱","auto-complete":"off"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码","auto-complete":"off"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),a("el-form-item",{attrs:{prop:"password_confirmation"}},[a("el-input",{attrs:{type:"password",placeholder:"再次输入密码","auto-complete":"off"},model:{value:t.form.password_confirmation,callback:function(e){t.$set(t.form,"password_confirmation",e)},expression:"form.password_confirmation"}})],1),t.captcha.scene.auth.register?a("el-form-item",{attrs:{prop:"captcha"}},[a("captcha",{ref:"captcha",attrs:{driver:t.captcha.driver,config:t.captcha.config},model:{value:t.form.captcha,callback:function(e){t.$set(t.form,"captcha",e)},expression:"form.captcha"}})],1):t._e(),a("el-form-item",{staticClass:"tos-item",attrs:{prop:"checkTos"}},[a("el-checkbox",{model:{value:t.form.checkTos,callback:function(e){t.$set(t.form,"checkTos",e)},expression:"form.checkTos"}},[t._v(" 同意 "),a("a",{attrs:{target:"_blank"},on:{click:t.showTos}},[t._v("用户协议 (Terms of service)")])])],1),a("el-form-item",{staticStyle:{"margin-bottom":"0"}},[a("el-button",{staticClass:"auth-button",attrs:{type:"primary","native-type":"submit",loading:t.loading||t.captcha.loading},nativeOn:{click:function(e){return e.preventDefault(),t.handleRegister(e)}}},[t._v(t._s(t.captcha.loading?"加载中":"注册")+" ")])],1)],1),a("el-dialog",{staticClass:"tos-container",attrs:{visible:t.tosVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.tosVisible=e}}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v(" 自动发卡平台注册协议 ")]),a("div",[t._v(" 【审慎阅读】您在申请注册流程中点击同意前，应当认真阅读以下协议。请您务必审慎阅读、充分理解协议中相关条款内容，其中包括："),a("br"),a("br"),t._v(" 1、与您约定免除或限制责任的条款；"),a("br"),a("br"),t._v(" 2、与您约定法律适用和管辖的条款；"),a("br"),a("br"),t._v(" 3、其他以粗体下划线标识的重要条款。"),a("br"),a("br"),t._v(" 如您对协议有任何疑问，可向平台客服咨询。"),a("br"),a("br"),t._v(" 【特别提示】当您按照注册页面提示填写信息、阅读并同意协议且完成全部注册程序后，即表示您已充分阅读、理解并接受协议的全部内容。如您因平台服务与本平台发生争议的，适用《自动发卡平台服务协议》处理。如您在使用平台服务过程中与其他用户发生争议的，依您与其他用户达成的协议处理。"),a("br"),a("br"),t._v(" 阅读协议的过程中，如果您不同意相关协议或其中任何条款约定，您应立即停止注册程序。"),a("br"),a("br"),a("a",{staticClass:"my-link",attrs:{href:"/tos",target:"_blank"}},[t._v("《自动发卡平台服务协议》")]),a("br"),a("a",{staticClass:"my-link",attrs:{href:"/legal_notice",target:"_blank"}},[t._v("《法律声明及隐私权政策》")]),a("br"),a("a",{staticClass:"my-link",attrs:{href:"/forbid_product",target:"_blank"}},[t._v("《平台禁售商品目录》")]),a("br")]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.handleTosAccept(e)}}},[t._v("同意协议")])],1)])],1)}),[],!1,null,null,null)).exports,F=a("53ca");function q(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function V(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?q(Object(a),!0).forEach((function(e){Object(r.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):q(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var Y={components:{Captcha:$},data:function(){return{loading:!1,captcha:V({loading:!1},window.config.captcha),form:{email:"",captcha:{}},formRules:{email:[{required:!0,message:"请输入电子邮箱",trigger:"blur"},{validator:function(t,e,a){E(e)?a():a(new Error("请输入正确的邮箱"))}}]}}},mounted:function(){this.refreshCaptcha()},methods:{refreshCaptcha:function(){var t=this;this.captcha.scene.auth.forget&&(this.captcha.loading=!0,this.$refs.captcha.refresh().then((function(){t.captcha.loading=!1})).catch((function(e){t.$alert("验证码加载失败，请刷新重试<br>"+e.message,{dangerouslyUseHTMLString:!0})})))},handleRequestReset:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){var e,a,i,n,r,o,s,l=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs.form.validate();case 3:t.next=35;break;case 5:t.prev=5,t.t0=t.catch(0),e=!0,a=!1,i=void 0,t.prev=10,n=function(){var t=o.value;if("error"===t.validateState)return l.$alert(t.validateMessage,{type:"error"}).finally((function(){t.$children[1].focus()})),{v:void 0}},r=this.$refs.form.fields[Symbol.iterator]();case 13:if(e=(o=r.next()).done){t.next=20;break}if(s=n(),"object"!==Object(F.a)(s)){t.next=17;break}return t.abrupt("return",s.v);case 17:e=!0,t.next=13;break;case 20:t.next=26;break;case 22:t.prev=22,t.t1=t.catch(10),a=!0,i=t.t1;case 26:t.prev=26,t.prev=27,e||null==r.return||r.return();case 29:if(t.prev=29,!a){t.next=32;break}throw i;case 32:return t.finish(29);case 33:return t.finish(26);case 34:return t.abrupt("return");case 35:if(!this.captcha.scene.auth.forget){t.next=45;break}return t.prev=36,t.next=39,this.$refs.captcha.verify();case 39:t.next=45;break;case 41:return t.prev=41,t.t2=t.catch(36),this.$alert(t.t2.message,{type:"error",dangerouslyUseHTMLString:!0}).finally((function(){l.$refs.captcha.focus()})),t.abrupt("return");case 45:return this.loading=!0,t.prev=46,t.next=49,Object(M.g)(this.form);case 49:this.$msgbox({title:"提示",message:"一封带有重置密码连接已经发送到您的邮箱，请查收",type:"info"});case 50:return t.prev=50,this.loading=!1,t.finish(50);case 53:case"end":return t.stop()}}),t,this,[[0,5],[10,22,26,34],[27,,29,33],[36,41],[46,,50,53]])})));return function(){return t.apply(this,arguments)}}()}},H=Object(l.a)(Y,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{ref:"form",staticClass:"forget-form",attrs:{model:t.form,rules:t.formRules,"label-position":"left","label-width":"0px"}},[a("div",{staticClass:"title"},[a("h2",[t._v("找回密码")]),a("span",{staticClass:"right"},[t._v("没有帐户？"),a("router-link",{staticClass:"my-link",attrs:{to:{name:"auth.register"}}},[t._v("立即注册")])],1)]),a("el-form-item",{attrs:{prop:"email"}},[a("el-input",{attrs:{type:"email",placeholder:"请输入电子邮箱"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),t.captcha.scene.auth.forget?a("el-form-item",{attrs:{prop:"captcha"}},[a("captcha",{ref:"captcha",attrs:{driver:t.captcha.driver,config:t.captcha.config},model:{value:t.form.captcha,callback:function(e){t.$set(t.form,"captcha",e)},expression:"form.captcha"}})],1):t._e(),a("el-form-item",{staticStyle:{margin:"32px 0 0"}},[a("el-button",{staticClass:"auth-button",attrs:{type:"primary","native-type":"submit",loading:t.loading||t.captcha.loading},nativeOn:{click:function(e){return e.preventDefault(),t.handleRequestReset(e)}}},[t._v(t._s(t.captcha.loading?"加载中":"找回密码")+" ")])],1)],1)}),[],!1,null,null,null).exports,W={data:function(){var t=this;return{loading:!1,form:{email:this.$route.params.email,token:this.$route.params.token,password:"",password_confirmation:""},formRules:{password:[{required:!0,validator:function(e,a,i){""===a?i(new Error("请输入新密码")):(""!==t.form.password_confirmation&&t.$refs.form.validateField("password_confirmation"),i())},trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}],password_confirmation:[{required:!0,validator:function(e,a,i){""===a?i(new Error("请再次输入新密码")):a!==t.form.password?i(new Error("两次输入密码不一致!")):i()},trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}]}}},mounted:function(){},methods:{handleReset:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){var e,a,i,n,r,o,s=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs.form.validate();case 3:t.next=35;break;case 5:t.prev=5,t.t0=t.catch(0),e=!0,a=!1,i=void 0,t.prev=10,n=function(){var t=o.value;if("error"===t.validateState)return s.$alert(t.validateMessage,{type:"error"}).finally((function(){t.$children[1].focus()})),"break"},r=this.$refs.form.fields[Symbol.iterator]();case 13:if(e=(o=r.next()).done){t.next=20;break}if("break"!==n()){t.next=17;break}return t.abrupt("break",20);case 17:e=!0,t.next=13;break;case 20:t.next=26;break;case 22:t.prev=22,t.t1=t.catch(10),a=!0,i=t.t1;case 26:t.prev=26,t.prev=27,e||null==r.return||r.return();case 29:if(t.prev=29,!a){t.next=32;break}throw i;case 32:return t.finish(29);case 33:return t.finish(26);case 34:return t.abrupt("return");case 35:return this.loading=!0,t.prev=36,t.next=39,Object(M.f)(this.form);case 39:this.$msgbox({title:"成功",message:"您的密码已经重置。",type:"success",confirmButtonText:"去登录"}).then((function(){s.$router.push({name:"auth.login"})}));case 40:return t.prev=40,this.loading=!1,t.finish(40);case 43:case"end":return t.stop()}}),t,this,[[0,5],[10,22,26,34],[27,,29,33],[36,,40,43]])})));return function(){return t.apply(this,arguments)}}()}},Q=Object(l.a)(W,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{ref:"form",staticClass:"reset-form",attrs:{model:t.form,rules:t.formRules,"label-position":"left","label-width":"0px"}},[a("div",{staticClass:"title"},[a("h2",[t._v("重置密码")])]),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入新密码","auto-complete":"off"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),a("el-form-item",{attrs:{prop:"password_confirmation"}},[a("el-input",{attrs:{type:"password",placeholder:"请再次输入密码","auto-complete":"off"},model:{value:t.form.password_confirmation,callback:function(e){t.$set(t.form,"password_confirmation",e)},expression:"form.password_confirmation"}})],1),a("el-form-item",{staticStyle:{margin:"32px 0 0"}},[a("el-button",{staticClass:"auth-button",attrs:{type:"primary","native-type":"submit",loading:t.loading},nativeOn:{click:function(e){return e.preventDefault(),t.handleReset(e)}}},[t._v(t._s("重置")+" ")])],1)],1)}),[],!1,null,null,null).exports,G=a("0ee6"),Z=a.n(G),J=a("8ce6"),K=a.n(J),X={data:function(){return{img_404:Z.a,img_404_cloud:K.a}},computed:{message:function(){return"页面不见啦......"}}},tt=(a("c9ee"),Object(l.a)(X,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{background:"#f0f2f5","margin-top":"-20px",height:"100%"}},[a("div",{staticClass:"wscn-http404"},[a("div",{staticClass:"pic-404"},[a("img",{staticClass:"pic-404__parent",attrs:{src:t.img_404,alt:"404"}}),a("img",{staticClass:"pic-404__child left",attrs:{src:t.img_404_cloud,alt:"404"}}),a("img",{staticClass:"pic-404__child mid",attrs:{src:t.img_404_cloud,alt:"404"}}),a("img",{staticClass:"pic-404__child right",attrs:{src:t.img_404_cloud,alt:"404"}})]),a("div",{staticClass:"bullshit"},[a("div",{staticClass:"bullshit__oops"},[t._v("OOPS!")]),a("div",{staticClass:"bullshit__headline"},[t._v(t._s(t.message))]),a("div",{staticClass:"bullshit__info"},[t._v("请检查您输入的网址是否正确，请点击以下按钮返回主页或者发送错误报告")]),a("a",{staticClass:"bullshit__return-home",attrs:{href:"/m/dashboard/index"}},[t._v("返回首页")])])])])}),[],!1,null,"3fcc3783",null)).exports,et=a("323e"),at=a.n(et);function it(t){return Object(T.a)({url:"dashboard",method:"get",params:t})}function nt(t,e,a){return Object(T.a)({url:"/pay/enable",method:"post",data:{user_id:t,pay_ids:e,enabled:a}})}var rt={UN_PAY:{id:0,name:"未支付",type:"info"},PAID:{id:1,name:"待发货",type:"primary"},SUCCESS:{id:2,name:"已成功",type:"success"},FROZEN:{id:3,name:"已冻结",type:"danger"},REFUND:{id:4,name:"已退款",type:"warning"},get:function(t){for(var e in this)if(this.hasOwnProperty(e)&&this[e].id===t)return this[e];return{id:t,type:"danger",name:"未知状态"}}},ot={UN:{id:0,name:"",type:""},EMAIL_SUCCESS:{id:1,name:"已发送邮件",type:"info"},EMAIL_FAILED:{id:2,name:"邮件发送失败",type:"warning"},MOBILE_SUCCESS:{id:3,name:"已发送短信",type:"success"},MOBILE_FAILED:{id:4,name:"短信发送失败",type:"warning"},CARD_UN:{id:100,name:"待发货",type:"info"},CARD_PROCESSING:{id:101,name:"正在处理",type:"primary"},CARD_SUCCESS:{id:102,name:"已发货",type:"success"},CARD_FAILED:{id:103,name:"处理失败",type:"danger"},get:function(t){for(var e in this)if(this.hasOwnProperty(e)&&this[e].id===t)return this[e];return{id:t,type:"danger",name:"未知状态"}}};function st(t,e){return Object(T.a)({url:"order/ship",method:"post",data:{id:t,card:e}})}function lt(t,e){return Object(T.a)({url:"order/freeze",method:"post",data:{ids:t,reason:e}})}function ct(t){return Object(T.a)({url:"order/unfreeze",method:"post",data:{ids:t}})}function dt(t,e){return Object(T.a)({url:"order/refund",method:"post",data:{ids:t,refund:e}})}var ut=a("3eba"),ft=a.n(ut);a("c037"),a("007d"),a("627c"),a("d28f"),a("b680"),a("ac1f"),a("5319");var pt=function(t){t.resizeHandler=function(t,e,a){var i,n,r,o,s,l=function l(){var c=+new Date-o;c<e&&c>0?i=setTimeout(l,e-c):(i=null,a||(s=t.apply(r,n),i||(r=n=null)))};return function(){for(var n=arguments.length,c=new Array(n),d=0;d<n;d++)c[d]=arguments[d];r=this,o=+new Date;var u=a&&!i;return i||(i=setTimeout(l,e)),u&&(s=t.apply(r,c),r=c=null),s}}((function(){t.chart&&t.chart.resize()}),500)},ht=function(t){t.chart&&(t.chart.dispose(),t.chart=null)},mt=function(t){return parseInt(t)!==t?t:(t/100).toFixed(2)},_t={name:"PayPieChart",props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"240px"},autoResize:{type:Boolean,default:!0},Statistic:{}},data:function(){return{chart:null}},computed:{pieData:function(){var t=[],e=[],a=[],i=this.Statistic.data,n=this.Statistic.limit?this.Statistic.limit:6,r=0;for(var o in i)if(i.hasOwnProperty(o)&&(t.push(o),a.push({name:o,value:i[o][0]}),e.push({name:o,value:mt(i[o][1])})),++r>=n)break;return{xLabels:t,sumData:e,countData:a}}},mounted:function(){pt(this)},beforeDestroy:function(){ht(this)},methods:{initChart:function(){this.chart=ft.a.init(this.$el,"light"),this.chart.setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",x:"left",data:this.pieData.xLabels},calculable:!0,series:[{name:"支付金额",type:"pie",radius:[0,"40%"],label:{normal:{show:!1},emphasis:{show:!1}},data:this.pieData.sumData},{name:"支付笔数",type:"pie",radius:["70%","90%"],label:{normal:{show:!1},emphasis:{show:!1}},data:this.pieData.countData}]})},updateChart:function(){this.chart?(this.chart.setOption({legend:{data:this.pieData.xLabels},series:[{data:this.pieData.sumData},{data:this.pieData.countData}]}),this.chart.resize()):this.initChart()}}},gt=Object(l.a)(_t,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{class:t.className,style:{height:t.height,width:t.width}})}),[],!1,null,null,null).exports;function bt(t){return Object(T.a)({url:"message",method:"get",params:t})}function vt(t){return Object(T.a)({url:"message/info",method:"get",params:{id:t}})}function yt(t,e){return Object(T.a)({url:"message/read",method:"post",data:{ids:t,user_id:e}})}var wt=a("3433"),Ct={data:function(){return{isMobile:this.$store.state.app.isMobile,loading:!1,loadingMessage:!1,where:{search:"homepage"},list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:10,prev_page_url:null,to:0,total:0},checkedIds:"",chooseInfo:null}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,bt(this.where).then((function(e){if(t.list=e.data.list,t.loading=!1,e.data.homepage_message_alert&&t.list.data&&t.list.data.length&&1!==t.list.data[0].not_pop){var a=t.list.data[0];t.$msgbox({title:a.info.title,message:Object(wt.d)(a.info.body),dangerouslyUseHTMLString:!0,customClass:"ann-box",showCancelButton:!0,cancelButtonText:"不再弹出"}).catch((function(){!function(t){Object(T.a)({url:"message/unpop",method:"post",data:{id:t}})}(a.id)})),yt(a.id)}}))},onChangePage:function(){this.getList()},onChangePageSize:function(t){this.list.per_page=t,this.getList()},showMessage:function(t){var e=this;t.info_title?(this.$alert(Object(wt.d)(t.info_body),t.info_title,{dangerouslyUseHTMLString:!0,customClass:"ann-box"}),t.is_read=!0,yt(t.id)):t.info&&t.info.body&&t.info.title?(this.$alert(Object(wt.d)(t.info.body),t.info.title,{dangerouslyUseHTMLString:!0,customClass:"ann-box"}),t.is_read=!0,yt(t.id)):(this.loadingMessage=!0,vt(t.id).then((function(a){e.loadingMessage=!1,t.is_read=!0,t.info=a.data,e.$alert(Object(wt.d)(a.data.body),a.data.title,{dangerouslyUseHTMLString:!0,customClass:"ann-box"})})).catch((function(){e.loadingMessage=!1})))},handleView:function(t){this.chooseInfo=t},onViewClose:function(t){this.chooseInfo=null,t&&this.getList()}}},xt=Object(l.a)(Ct,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,"show-header":!1},on:{"selection-change":function(e){return t.checkedIds=e.map((function(t){return t.id})).join(",")}}},[a("el-table-column",{attrs:{prop:"created_at",label:"时间",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.created_at?e.row.created_at.split(" ")[0]:"")+" ")]}}])}),a("el-table-column",{attrs:{prop:"info_title",label:"标题","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"line-btn",style:{"font-weight":0===e.row.is_read?"bold":"normal"},on:{click:function(a){return t.showMessage(e.row)}}},[t._v(" "+t._s(e.row.info_title?e.row.info_title:e.row.info?e.row.info.title:"未知#"+e.row.info_id)+" ")])]}}])})],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?a("el-pagination",{staticClass:"pagination",attrs:{small:t.isMobile,"page-size":10,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"prev, pager, next"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),a("div",{staticStyle:{height:"44px",display:"block"}}),t.loadingMessage?a("div",{staticClass:"v-modal",staticStyle:{"z-index":"1010"}}):t._e(),t.loadingMessage?a("div",{staticClass:"el-message-box__wrapper",staticStyle:{"z-index":"1011"}},[t._m(0)]):t._e()],1)}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{position:"relative",display:"inline-block",width:"250px","background-color":"#fff","border-radius":"4px",border:"1px solid #ebeef5"}},[a("p",[t._v("加载中...")])])}],!1,null,null,null).exports,kt={name:"HomeAccount",props:{userInfo:{},loginInfo:{},_project:{default:"merchant"}},data:function(){return{showVerifyRoute:!(!window.config.user_verify||!window.config.user_verify.open&&0!==window.config.user_verify.show_in_withdraw)}}},It=(a("99c2"),Object(l.a)(kt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-card",{staticClass:"my-card"},[a("div",{staticClass:"home-account-top"},[a("div",{staticClass:"info"},[a("div",{staticClass:"label"},[t._v("店铺名称：")]),a("div",{staticClass:"value"},[t._v(t._s(t.userInfo.shop_name))])]),a("div",{staticClass:"info"},[a("div",{staticClass:"label"},[t._v("登录账号：")]),a("div",{staticClass:"value"},[t._v(t._s(t.userInfo.email))])]),a("div",{staticClass:"info"},[a("div",{staticClass:"label"},[t._v("最近登录：")]),a("div",{staticClass:"value"},[t._v(t._s(t.loginInfo?t.loginInfo.created_at:"暂无记录"))])]),a("div",{staticClass:"info"},[a("div",{staticClass:"label"},[t._v("登录地址：")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.loginInfo?t.loginInfo.ip:"暂无记录")+" "),a("router-link",{staticClass:"el-button--text",staticStyle:{"margin-left":"8px"},attrs:{to:"/"+("merchant"===t._project?"m/shopController":"admin/system")+"/logs"}},[t._v("查看更多")])],1)]),a("div",{staticClass:"action"},["merchant"===t._project?a("el-dropdown",{attrs:{trigger:"click","show-timeout":0,"hide-timeout":0,placement:"bottom-start"}},[a("el-button",[t._v(" 账户管理"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{staticClass:"home-top-info-el-dropdown-menu",attrs:{slot:"dropdown"},slot:"dropdown"},[a("router-link",{attrs:{to:"/m/shopController/info"}},[a("el-dropdown-item",[a("icon",{attrs:{name:"regular/info-circle"}}),t._v(" 编辑信息 ")],1)],1),a("router-link",{attrs:{to:"/m/user/security"}},[a("el-dropdown-item",[a("icon",{attrs:{name:"regular/shield-alt"}}),t._v(" 修改密码 ")],1)],1),t._e()],1)],1):t._e(),"admin_free"===t._project?a("el-dropdown",{attrs:{trigger:"click","show-timeout":0,"hide-timeout":0,placement:"bottom-start"}},[a("el-button",[t._v(" 网站设置"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{staticClass:"home-top-info-el-dropdown-menu",attrs:{slot:"dropdown"},slot:"dropdown"},[a("router-link",{attrs:{to:"/admin/system/set?tab=info"}},[a("el-dropdown-item",[a("icon",{attrs:{name:"regular/info-circle"}}),t._v(" 常规设置 ")],1)],1),a("router-link",{attrs:{to:"/admin/system/set?tab=theme"}},[a("el-dropdown-item",[a("icon",{attrs:{name:"cog"}}),t._v(" 主题设置 ")],1)],1),a("router-link",{attrs:{to:"/admin/system/set?tab=order"}},[a("el-dropdown-item",[a("icon",{attrs:{name:"bars"}}),t._v(" 订单设置 ")],1)],1),a("router-link",{attrs:{to:"/admin/system/set?tab=email"}},[a("el-dropdown-item",[a("icon",{attrs:{name:"regular/envelope"}}),t._v(" 邮件设置 ")],1)],1),a("router-link",{attrs:{to:"/admin/system/set?tab=vcode"}},[a("el-dropdown-item",[a("icon",{attrs:{name:"cog"}}),t._v(" 验证码 ")],1)],1),a("router-link",{attrs:{to:"/admin/system/set?tab=storage"}},[a("el-dropdown-item",[a("icon",{attrs:{name:"light/file-alt"}}),t._v(" 文件储存 ")],1)],1),a("router-link",{attrs:{to:"/admin/system/security"}},[a("el-dropdown-item",[a("icon",{attrs:{name:"regular/shield-alt"}}),t._v(" 修改密码 ")],1)],1)],1)],1):t._e()],1)])])}),[],!1,null,"b75f27d0",null)).exports,At={name:"HomeBalance",props:{userInfo:{}},data:function(){return{hiddenMoney:!1,frozenMoneyTip:"订单冻结金额，未入账的当日订单"}}},St=(a("87c8"),Object(l.a)(At,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-card",{staticClass:"my-card"},[a("div",{staticClass:"home-balance"},[a("div",{staticClass:"head"},[a("div",{staticClass:"head-title"},[t._v(" 我的余额 "),a("el-button",{staticClass:"icon-btn",staticStyle:{"margin-left":"8px"},attrs:{type:"text",icon:"el-icon-view"},on:{click:function(e){t.hiddenMoney=!t.hiddenMoney}}})],1)]),a("div",{staticClass:"body"},[a("div",{staticClass:"body-balance"},[a("div",{staticClass:"amount-title"},[a("span",{staticClass:"amount-title-text"},[t._v("账户可用余额 (元)")])]),t.hiddenMoney?a("div",{staticClass:"balance-money"},[t._v("******")]):a("div",{staticClass:"balance-money"},[t._v(t._s(t._f("moneyDigitalFilter")(t._f("moneyFilter")(t.userInfo.m_balance))))])]),a("div",{staticClass:"body-frozen"},[a("div",{staticClass:"amount-title"},[a("span",{staticClass:"amount-title-text"},[t._v("不可用余额 (元)")]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.frozenMoneyTip,placement:"top"}},[a("icon",{staticClass:"icon-btn",attrs:{name:"light/question-circle",scale:1}})],1)],1),t.hiddenMoney?a("div",{staticClass:"frozen-money"},[t._v("******")]):a("div",{staticClass:"frozen-money"},[t._v(t._s(t._f("moneyDigitalFilter")(t._f("moneyFilter")(t.userInfo.m_frozen))))])])]),a("div",{staticClass:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.$router.push("/m/user/pay/setting")}}},[t._v("账户")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.$router.push("/m/user/pay/apply")}}},[t._v("提现")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.$router.push("/m/user/pay/list")}}},[t._v("记录")])],1)])])}),[],!1,null,"11de0170",null)).exports,Ot=(a("ef97"),{name:"OrderLineChart",props:{className:{type:String,default:"chart"},height:{type:String,default:"240px"},autoResize:{type:Boolean,default:!0},data:{type:Object}},data:function(){return{chart:null}},computed:{ChartData:function(){var t=[],e=[],a=[],i=[],n=this.data.data,r=new Date;for(30===this.data.day?r.setMonth(r.getMonth()-1):r.setDate(r.getDate()-this.data.day+1);r<=Date.now();r.setDate(r.getDate()+1)){var o=r.format("yyyy-MM-dd");t.push(r.format("MM-dd")),n.hasOwnProperty(o)?(e.push(n[o][0]),a.push(mt(n[o][1])),i.push(mt(n[o][2]))):(e.push(0),a.push(mt(0)),i.push(mt(0)))}return{x:t,number:e,paid:a,profit:i}}},mounted:function(){pt(this)},beforeDestroy:function(){ht(this)},methods:{initChart:function(){this.chart=ft.a.init(this.$el,"macarons"),this.chart.setOption({title:{text:"最近"+(30===this.data.day?"1个月":this.data.day+"日")+"趋势",textStyle:{fontSize:12,fontWeight:"light"}},grid:{top:0,left:0,right:16,bottom:0,containLabel:!0},legend:{left:88,data:[{name:"成交笔数 (笔)",icon:"rect",textStyle:{fontSize:12,fontWeight:"light"}},{name:"成交金额 (元)",icon:"rect",textStyle:{fontSize:12,fontWeight:"light"}},{name:"利润金额 (元)",icon:"rect",textStyle:{fontSize:12,fontWeight:"light"}}],selectedMode:"single"},tooltip:{trigger:"axis",backgroundColor:"hsla(0,0%,100%,.9)",extraCssText:"box-shadow: 0 4px 16px 0 rgba(97,131,155,.15);padding: 10px 10px 6px;",formatter:'<span class="charts-tooltip-name">{a}</span><br/><span class="charts-tooltip-value">{c}</span><br/><span class="charts-tooltip-title">{b}</span>',axisPointer:{type:"line"}},xAxis:{data:this.ChartData.x,boundaryGap:!1,splitLine:{show:!1}},yAxis:{show:!1,splitLine:{show:!0}},series:[{name:"成交笔数 (笔)",smooth:!0,type:"line",itemStyle:{normal:{color:"rgba(2, 197, 233, 0.2)",lineStyle:{color:"rgba(2, 197, 233, 0.2)"},areaStyle:{color:"rgba(99,194,255, 0.6)"}}},data:this.ChartData.number,animationDuration:1e3,animationEasing:"quadraticOut"},{name:"成交金额 (元)",smooth:!0,type:"line",itemStyle:{normal:{color:"rgba(2, 197, 233, 0.2)",lineStyle:{color:"rgba(2, 197, 233, 0.2)"},areaStyle:{color:"rgba(99,194,255, 0.6)"}}},data:this.ChartData.paid,animationDuration:1e3,animationEasing:"quadraticOut"},{name:"利润金额 (元)",smooth:!0,type:"line",itemStyle:{normal:{color:"rgba(2, 197, 233, 0.2)",lineStyle:{color:"rgba(2, 197, 233, 0.2)"},areaStyle:{color:"rgba(99,194,255, 0.6)"}}},data:this.ChartData.profit,animationDuration:1e3,animationEasing:"quadraticOut"}]},!0)},updateChart:function(){this.chart?(this.chart.setOption({title:{text:"最近"+(30===this.data.day?"1个月":this.data.day+"日")+"趋势"},xAxis:{data:this.ChartData.x},series:[{data:this.ChartData.number},{data:this.ChartData.paid},{data:this.ChartData.profit}]}),this.chart.resize()):this.initChart()}}}),Et={name:"HomeOrderChart",components:{OrderLineChart:(a("1727"),Object(l.a)(Ot,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{class:t.className,style:{height:t.height}})}),[],!1,null,null,null)).exports},props:{userInfo:{},data:{},dashboard:{}},data:function(){return{activeName:"order"}},mounted:function(){},methods:{resizeHandler:function(){this.$refs.chart.resizeHandler()},updateChart:function(){this.$refs.chart.updateChart()}}},Tt=(a("b6ad"),Object(l.a)(Et,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-card",{staticClass:"my-card home-report"},[t._t("header"),a("el-tabs",{attrs:{type:"border-card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"order"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-s-data"}),t._v(" 今日交易")]),a("div",{staticClass:"body-amount"},[a("div",{staticClass:"body-balance",staticStyle:{flex:"0.7"}},[a("div",{staticClass:"amount-title"},[t._v("成交 (笔)")]),a("div",{staticClass:"balance-money"},[t._v(t._s(t.dashboard.today.count))])]),a("div",{staticClass:"body-balance"},[a("div",{staticClass:"amount-title"},[t._v("成交 (元)")]),a("div",{staticClass:"balance-money"},[t._v(t._s(t._f("moneyFilter")(t.dashboard.today.paid)))])]),a("div",{staticClass:"body-balance"},[a("div",{staticClass:"amount-title"},[t._v("利润 (元)")]),a("div",{staticClass:"balance-money"},[t._v(t._s(t._f("moneyFilter")(t.dashboard.today.profit)))])])])]),a("el-tab-pane",{attrs:{name:"income",label:"昨日"}},[a("div",{staticClass:"body-amount"},[a("div",{staticClass:"body-balance",staticStyle:{flex:"0.7"}},[a("div",{staticClass:"amount-title"},[t._v("成交 (笔)")]),a("div",{staticClass:"balance-money"},[t._v(t._s(t.dashboard.yesterday.count))])]),a("div",{staticClass:"body-balance"},[a("div",{staticClass:"amount-title"},[t._v("成交 (元)")]),a("div",{staticClass:"balance-money"},[t._v(t._s(t._f("moneyFilter")(t.dashboard.yesterday.paid)))])]),a("div",{staticClass:"body-balance"},[a("div",{staticClass:"amount-title"},[t._v("利润 (元)")]),a("div",{staticClass:"balance-money"},[t._v(t._s(t._f("moneyFilter")(t.dashboard.yesterday.profit)))])])])])],1),a("div",{staticStyle:{margin:"0 8px 8px 0"}},[a("order-line-chart",{ref:"chart",attrs:{data:t.data,height:"170px"}})],1)],2)}),[],!1,null,null,null)).exports,jt={name:"HomeLink",props:{userInfo:{}},data:function(){return{apipay_open:window.config.apipay_open}}};function $t(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}var Pt={components:{HomeLink:(a("3fd8"),a("0830"),Object(l.a)(jt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-card",{staticClass:"my-card home-link-card"},[a("div",{staticClass:"home-link"},[a("div",{staticClass:"header"},[a("span",{staticClass:"header-title"},[t._v("常用功能")])]),a("div",{staticClass:"functions"},[a("router-link",{staticClass:"function",attrs:{to:"/m/shopController/info"}},[t._v("店铺信息")]),a("router-link",{staticClass:"function",attrs:{to:"/m/shopController/link"}},[t._v("店铺链接")]),a("router-link",{staticClass:"function",attrs:{to:"/m/product/category"}},[t._v("商品分类")]),a("router-link",{staticClass:"function",attrs:{to:"/m/product/list"}},[t._v("商品列表")]),a("router-link",{staticClass:"function",attrs:{to:"/m/order/list"}},[t._v("订单记录")]),a("router-link",{staticClass:"function",attrs:{to:"/m/order/analysis"}},[t._v("收益统计")]),a("router-link",{staticClass:"function",attrs:{to:"/m/shopController/rate"}},[t._v("通道费率")]),t.apipay_open?a("router-link",{staticClass:"function",attrs:{to:"/m/api/pay"}},[t._v("API接入")]):t._e()],1)])])}),[],!1,null,"1ceb06a5",null)).exports,HomeOrderChart:Tt,HomeBalance:St,HomeAccount:It,messageList:xt,payPieChart:gt},data:function(){return{processBar:{load:0,need:0},dashboard:{today:{count:0,income:0,profit:0},yesterday:{count:0,income:0,profit:0},complaints_count:0,complaints_24hours:0,need_ship_count:0,login:{created_at:"加载中",ip:"加载中"}},orderStat:{day:7,data:[]},payStat:{day:7,data:{}}}},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?$t(Object(a),!0).forEach((function(e){Object(r.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):$t(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},Object(o.mapGetters)(["userInfo"])),watch:{processBar:{handler:function(t){t.load<t.need?at.a.isStarted()?at.a.inc():at.a.start():at.a.done()},deep:!0}},mounted:function(){window.bus.$on("app-resize",this.resizeHandler),this.initData()},beforeDestroy:function(){window.bus.$off("app-resize",this.resizeHandler)},methods:{resizeHandler:function(){var t=this;["order-chart","pay-pie-chart"].forEach((function(e){t.$refs[e]&&t.$refs[e].resizeHandler()}))},initData:function(){var t=this;this.processBar.need++,it().then((function(e){Object.assign(t.dashboard,e.data),t.$nextTick((function(){t.getOrderStat(),t.getPayStat()})),t.processBar.load++}))},reloadDashBoard:function(){var t=this;this.processBar.need++,it().then((function(e){Object.assign(t.dashboard,e.data),t.processBar.load++}))},getOrderStat:function(){var t=this;this.processBar.need++,function(t){return Object(T.a)({url:"order/stat",method:"get",params:t})}({day:this.orderStat.day}).then((function(e){t.orderStat.data=e.data,t.$nextTick((function(){t.$refs["order-chart"]&&t.$refs["order-chart"].updateChart()})),t.processBar.load++}))},getPayStat:function(){var t=this;this.processBar.need++,function(t){return Object(T.a)({url:"/pay/stat",method:"get",params:t})}({day:this.payStat.day}).then((function(e){t.payStat.data=e.data,t.$nextTick((function(){t.$refs["pay-pie-chart"]&&t.$refs["pay-pie-chart"].updateChart()})),t.processBar.load++}))}}},Dt={name:"dashboard",components:{AdminDashboard:(a("a4ce"),a("7d8d"),Object(l.a)(Pt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",staticClass:"app-container"},[a("el-row",{staticClass:"home-row row-reverse",attrs:{type:"flex"}},[t.dashboard.complaints_count?a("el-col",{staticClass:"home-notice-2",attrs:{span:24}},[a("el-alert",{staticClass:"my-card todo-overview",attrs:{title:"投诉通知",type:"warning"}},[a("div",[a("span",{staticClass:"info"},[t._v("目前您有 "),a("span",{staticClass:"red-text"},[t._v(t._s(t.dashboard.complaints_count))]),t._v(" 条投诉待处理， ")]),a("span",{staticClass:"info"},[t._v("其中 "),a("span",{staticClass:"red-text"},[t._v(t._s(t.dashboard.complaints_24hours))]),t._v(" 条已超过24小时 ")]),a("router-link",{staticClass:"info",staticStyle:{color:"#409EFF"},attrs:{to:"/m/shopController/complaint"}},[t._v("去处理")])],1)])],1):t._e(),t.dashboard.need_ship_count?a("el-col",{staticClass:"home-notice-2",attrs:{span:24}},[a("el-alert",{staticClass:"my-card todo-overview",attrs:{title:"未发货订单通知",type:"warning"}},[a("div",[a("span",{staticClass:"info"},[t._v("目前您有 "),a("span",{staticClass:"red-text"},[t._v(t._s(t.dashboard.need_ship_count))]),t._v(" 个订单由于库存不足没有发货， ")]),a("router-link",{staticClass:"info",staticStyle:{color:"#409EFF"},attrs:{to:"/m/order/list?status=paid"}},[t._v("去处理")])],1)])],1):t._e(),a("el-col",{staticClass:"col-home-right",attrs:{xl:6,lg:12}},[a("el-row",{staticClass:"home-row",attrs:{type:"flex"}},[a("el-col",{staticClass:"col-home-account",attrs:{lg:24,md:12,xs:24}},[a("home-account",{staticClass:"home-account",attrs:{userInfo:t.userInfo,loginInfo:t.dashboard.login}})],1),a("el-col",{staticClass:"col-home-link",attrs:{lg:24,md:12,xs:24}},[a("home-link",{staticClass:"home-link"})],1)],1)],1),a("el-col",{staticClass:"col-home-left",attrs:{xl:18,lg:12}},[a("el-row",{staticClass:"home-row",attrs:{gutter:18,type:"flex"}},[t.dashboard.complaints_count?a("el-col",{staticClass:"home-notice-1",attrs:{span:24}},[a("el-alert",{staticClass:"my-card todo-overview",attrs:{title:"投诉通知",type:"warning"}},[a("div",[a("span",{staticClass:"info"},[t._v("目前您有 "),a("span",{staticClass:"red-text"},[t._v(t._s(t.dashboard.complaints_count))]),t._v(" 条投诉待处理， ")]),a("span",{staticClass:"info"},[t._v("其中 "),a("span",{staticClass:"red-text"},[t._v(t._s(t.dashboard.complaints_24hours))]),t._v(" 条已超过24小时 ")]),a("router-link",{staticClass:"info",staticStyle:{color:"#409EFF"},attrs:{to:"/m/shopController/complaint"}},[t._v("去处理")])],1)])],1):t._e(),t.dashboard.need_ship_count?a("el-col",{staticClass:"home-notice-1",attrs:{span:24}},[a("el-alert",{staticClass:"my-card todo-overview",attrs:{title:"未发货订单通知",type:"warning"}},[a("div",[a("span",{staticClass:"info"},[t._v("目前您有 "),a("span",{staticClass:"red-text"},[t._v(t._s(t.dashboard.need_ship_count))]),t._v(" 个订单由于库存不足没有发货， ")]),a("router-link",{staticClass:"info",staticStyle:{color:"#409EFF"},attrs:{to:"/m/order/list?status=paid"}},[t._v("去处理")])],1)])],1):t._e(),a("el-col",{staticClass:"col-home-left-balance",attrs:{md:12,xs:24}},[a("home-balance",{staticClass:"home-left-balance",attrs:{userInfo:t.userInfo}})],1),a("el-col",{staticClass:"col-home-left-chart",attrs:{md:12,xs:24}},[a("home-order-chart",{ref:"order-chart",staticClass:"home-left-chart",attrs:{data:t.orderStat,userInfo:t.userInfo,dashboard:t.dashboard}},[a("el-select",{staticClass:"order-chart-day",attrs:{slot:"header",placeholder:"请选择",value:""},on:{change:t.getOrderStat},slot:"header",model:{value:t.orderStat.day,callback:function(e){t.$set(t.orderStat,"day",e)},expression:"orderStat.day"}},[a("el-option",{attrs:{label:"7天",value:7}}),a("el-option",{attrs:{label:"15天",value:15}}),a("el-option",{attrs:{label:"1个月",value:30}})],1)],1)],1),a("el-col",{attrs:{span:24}},[a("el-card",{staticClass:"my-card card-mobile-padding"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"line-height":"28px"}},[t._v("消息列表")])]),a("message-list")],1)],1),a("el-col",{attrs:{span:24}},[a("el-card",{staticClass:"my-card card-mobile-padding"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"line-height":"28px"}},[t._v("支付方式")]),t._v(" "),a("el-select",{staticStyle:{width:"90px"},attrs:{placeholder:"请选择",value:"",size:"mini"},on:{change:t.getPayStat},model:{value:t.payStat.day,callback:function(e){t.$set(t.payStat,"day",e)},expression:"payStat.day"}},[a("el-option",{attrs:{label:"今日",value:1}}),a("el-option",{attrs:{label:"7天",value:7}}),a("el-option",{attrs:{label:"15天",value:15}}),a("el-option",{attrs:{label:"1个月",value:30}})],1),a("a",{staticClass:"icon-btn",staticStyle:{"line-height":"28px",float:"right"},on:{click:t.getPayStat}},[a("icon",{attrs:{name:"light/sync"}})],1)],1),a("pay-pie-chart",{ref:"pay-pie-chart",attrs:{Statistic:t.payStat}})],1)],1)],1)],1)],1)],1)}),[],!1,null,"7cb51a33",null)).exports}},Rt=Object(l.a)(Dt,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"dashboard-container"},[e("admin-dashboard")],1)}),[],!1,null,null,null).exports,Ut={data:function(){var t=this;return{loading:!1,form:{old:"",password:"",password_confirmation:""},formRules:{old:[{required:!0,message:"请输入旧密码",trigger:"blur"}],password:[{required:!0,validator:function(e,a,i){""===a?i(new Error("请输入密码")):(""!==t.form.password_confirmation&&t.$refs.form.validateField("password_confirmation"),i())},trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}],password_confirmation:[{required:!0,validator:function(e,a,i){""===a?i(new Error("请再次输入密码")):a!==t.form.password?i(new Error("两次输入密码不一致!")):i()},trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}]}}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},methods:{onSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(e){t.loading=!0;var a=Object.assign({},t.form);Object(M.a)(a).then((function(){t.loading=!1,t.$notify({title:"提示",message:"修改密码成功",type:"success",duration:3e3})})).catch((function(){t.loading=!1}))}}))}}},Mt=Object(l.a)(Ut,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("h3",{staticStyle:{margin:"4px 0 28px 0"}},[t._v("修改密码")]),a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",rules:t.formRules}},[a("el-form-item",{attrs:{label:"旧密码",prop:"old"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入旧密码"},model:{value:t.form.old,callback:function(e){t.$set(t.form,"old",e)},expression:"form.old"}})],1),a("el-form-item",{attrs:{label:"新密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入新密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),a("el-form-item",{attrs:{label:"新密码",prop:"password_confirmation"}},[a("el-input",{attrs:{type:"password",placeholder:"请再次输入新密码"},model:{value:t.form.password_confirmation,callback:function(e){t.$set(t.form,"password_confirmation",e)},expression:"form.password_confirmation"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v("确认修改")])],1)],1)],1)}),[],!1,null,null,null).exports;a("a15b"),a("466d"),a("1276");var Lt=a("534c"),zt={props:{inBox:{default:!1},userInfo:{default:null},_project:{default:"merchant"}},data:function(){var t=this,e=window.config;return{isMobile:this.$store.state.app.isMobile,loading:!1,labelWidth:this.$store.state.app.isMobile?"78px":"90px",userInfo_:{},config:e,TYPE:Lt.b,METHOD:Lt.a,VERIFY_STATUS:Lt.c,formDisabled:!1,nameDisabled:!1,form:{method:e.user_verify.methods.indexOf(Lt.a.ALIPAY)>-1?Lt.a.ALIPAY:Lt.a.MANUAL,type:Lt.b.ID_CARD,name:"",number:"",front_pic:null,back_pic:null,business_pic:null,status:Lt.c.UN.id},formRules:{method:[{required:!0,message:"请选择认证方式",trigger:"blur"}],type:[{required:!0,message:"请选择证件类型",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],number:[{required:!0,message:"请输入证件号码",trigger:"blur"}],front_pic:[{required:e.user_verify.need_picture,validator:function(e,a,i){t.form.type!==Lt.b.ID_CARD&&i(),t.userInfo_.verify&&t.userInfo_.verify.info&&t.userInfo_.verify.info.id_card&&t.userInfo_.verify.info.id_card.front_pic_id&&i(),a?a.size>5242880?i(new Error("文件大小限制5M以内")):i():i(new Error("请上传证件正面"))},trigger:"blur"}],back_pic:[{required:e.user_verify.need_picture,validator:function(e,a,i){t.form.type!==Lt.b.ID_CARD&&i(),t.userInfo_.verify&&t.userInfo_.verify.info&&t.userInfo_.verify.info.id_card&&t.userInfo_.verify.info.id_card.back_pic_id&&i(),a?a.size>5242880?i(new Error("文件大小限制5M以内")):i():i(new Error("请上传证件正面"))},trigger:"blur"}],business_pic:[{required:e.user_verify.need_picture,validator:function(e,a,i){t.form.type!==Lt.b.BUSINESS&&i(),t.userInfo_.verify&&t.userInfo_.verify.info&&t.userInfo_.verify.info.business&&t.userInfo_.verify.info.business.business_pic&&i(),a?a.size>5242880?i(new Error("文件大小限制5M以内")):i():i(new Error("请上传营业执照"))},trigger:"blur"}]},certDialogVisible:!1,certUrl:"",certUrlFull:"",certUrlTip:""}},computed:{verify_ing:function(){return this.userInfo_.verify&&this.userInfo_.verify.status===Lt.c.ING.id},verify_ok:function(){return this.userInfo_.verify&&this.userInfo_.verify.status===Lt.c.OK.id},verify_fail:function(){return this.userInfo_.verify&&this.userInfo_.verify.status===Lt.c.FAIL.id}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){if("admin"===this._project?this.userInfo_=this.userInfo:this.userInfo_=this.$store.state.user.userInfo,this.userInfo_||(this.userInfo_={}),this.userInfo_.verify){var t=this.userInfo_.verify;this.form.method=t.method,this.form.type=t.type,this.form.name=t.name,this.form.number=t.number,this.form.status=t.status,"admin"!==this._project&&this.form.status!==Lt.c.UN.id&&this.form.status!==Lt.c.FAIL.id&&(this.formDisabled=!0)}this.userInfo_.bank_name&&(this.form.name||(this.form.name=this.userInfo_.bank_name),"admin"!==this._project&&(this.nameDisabled=!0))},methods:{updateUserInfo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.form[t]=e;var a=this.$store.state.user.userInfo;a[t]=e,this.$store.commit("SET_USER_INFO",a)},handleFileInput:function(t,e){var a=t.target.files[0];a&&(this.form[e]=a)},handleUploadPreview:function(t){var e='<img src="'.concat(window.API_URL+"file/"+t+"/preview?token="+encodeURIComponent(this.$store.state.user.token),'" style="width: 100%;cursor: pointer" onclick="window.open(this.src,\'_blank\')">');this.$msgbox({message:e,title:"查看",dangerouslyUseHTMLString:!0})},handleSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(e){var i=new FormData(t.$refs.form.$el);i.append("user_id",t.userInfo_.id),i.append("method",t.form.method),i.append("type",t.form.type),t.config.user_verify.need_picture&&(t.form.front_pic&&"number"!=typeof t.form.front_pic&&i.append("front_pic",t.form.front_pic,t.form.front_pic.name),t.form.back_pic&&"number"!=typeof t.form.back_pic&&i.append("back_pic",t.form.back_pic,t.form.back_pic.name),t.form.business_pic&&"number"!=typeof t.form.business_pic&&i.append("business_pic",t.form.business_pic,t.form.business_pic.name)),t.loading=!0,Object(Lt.d)(i).then((function(e){t.loading=!1,t.userInfo_.verify||(t.userInfo_.verify={}),Object.assign(t.userInfo_.verify,e.data.verify),t.form.method===Lt.a.MANUAL?t.$notify({title:"提示",message:"提交信息成功<br>请联系客服进行审核",type:"success",duration:3e3,dangerouslyUseHTMLString:!0}):t.form.method===Lt.a.ALIPAY&&(t.certUrlFull=e.data.url,t.certUrl=e.data.url_short||t.certUrlFull,t.certUrl&&a.e("qrcode").then(a.bind(null,"3920")).then((function(e){t.certDialogVisible=!0,t.certUrlTip="请使用支付宝扫描二维码",t.$nextTick((function(){var a=e.default;new a("qrcode",{text:t.certUrl,width:230,height:230,colorDark:"#000000",colorLight:"#ffffff",correctLevel:a.CorrectLevel.H,title:"请使用支付宝扫一扫"})}))})).catch((function(e){t.certUrlTip="认证请求失败",t.$alert("二维码组件加载失败<br>"+e.message,"错误",{type:"error",dangerouslyUseHTMLString:!0})})))})).catch((function(){t.loading=!1}))}}))},openAlipayApp:function(){!function(t,e,a){function i(t,e){for(var a=t.split("."),i=e.split("."),n=0;n<a.length||n<i.length;n+=1){var r=parseInt(a[n],10)||0,o=parseInt(i[n],10)||0;if(r<o)return-1;if(r>o)return 1}return 0}function n(t){m||((m=h.createElement("iframe")).id="callapp_iframe_"+Date.now(),m.frameborder="0",m.style.cssText="display:none;",h.body.appendChild(m)),m.src=t}function r(t){var e=h.createElement("a");e.setAttribute("href",t),e.style.display="none",h.body.appendChild(e);var a=h.createEvent("HTMLEvents");a.initEvent("click",!1,!1),e.dispatchEvent(a)}var o="";o=window.navigator.userAgent;var s=!1,l=!1,c="",d=o.match(/Android[\s\/]([\d\.]+)/);d?(s=!0,c=d[1]):o.match(/(iPhone|iPad|iPod)/)&&(l=!0,(d=o.match(/OS ([\d_\.]+) like Mac OS X/))&&(c=d[1].split("_").join(".")));var u=!1,f=!1,p=!1;o.match(/(?:Chrome|CriOS)\/([\d\.]+)/)?(u=!0,o.match(/Version\/[\d+\.]+\s*Chrome/)&&(p=!0)):o.match(/iPhone|iPad|iPod/)&&(o.match(/Safari/)&&o.match(/Version\/([\d\.]+)/)?f=!0:o.match(/OS ([\d_\.]+) like Mac OS X/)&&(p=!0));var h=window.document,m=void 0;(function(t,e,a){var d=t+"&_t="+(new Date-0),h=s&&u&&!p,m=(s&&!!o.match(/samsung/i)&&i(c,"4.3")>=0&&i(c,"4.5"),l&&i(c,"9.0")>=0&&f),_=o.toLowerCase().indexOf("qq/")>-1;if(h||a){var g="#Intent;scheme="+d.substring(0,d.indexOf("://"))+";package="+e+";end";d=d.replace(/.*?\:\/\//,"intent://"),d+=g}m||_?r(d):0===d.indexOf("intent:")?window.location.href=d:n(d)})(t,e,a)}("alipays://platformapi/startapp?appId=20000067&url="+encodeURIComponent(this.certUrlFull),"com.eg.android.AlipayGphone")},handleCloseCertDialog:function(t){var e=this;this.certDialogVisible=!1,t&&(this.loading=!0,Object(Lt.e)(this.userInfo_.id).then((function(t){Object.assign(e.userInfo_.verify,t.data.verify),t.data.tip&&e.$alert(t.data.tip)})).finally((function(){e.loading=!1})))},handleOK:function(t){var e=this;this.loading=!0,Object(Lt.f)(t.id,Lt.c.OK.id).then((function(){e.$notify({title:"操作完成",message:"实名审核已经通过",type:"success"}),t.status=Lt.c.OK.id,e.loading=!1})).catch((function(){e.loading=!1}))},handleFail:function(t){var e=this;this.$prompt("请输入审核不通过原因","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.reason,inputPattern:/^[\s\S]{0,100}$/,inputErrorMessage:"不通过原因需100字符以内",inputType:"textarea",closeOnClickModal:!1}).then((function(a){var i=a.value;e.loading=!0,Object(Lt.f)(t.id,Lt.c.FAIL.id,i).then((function(){e.$notify({title:"操作完成",message:"实名审核已经拒绝",type:"info"}),t.status=Lt.c.FAIL.id,t.reason=i,e.loading=!1})).catch((function(){e.loading=!1}))}))}}},Nt=(a("7b4d"),a("9525"),Object(l.a)(zt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:{"app-container":!t.userInfo}},[t.userInfo?t._e():i("h3",{staticStyle:{margin:"4px 0 28px 0"}},[t._v("实名认证"+t._s(t.userInfo_.verify&&t.userInfo_.verify.status===t.VERIFY_STATUS.ING.id?"（审核中）":""))]),i("el-form",{ref:"form",style:{"margin-top":t.userInfo?"22px":"0"},attrs:{model:t.form,"label-width":t.labelWidth,rules:t.formRules,"label-position":t.isMobile?"top":"left"}},[i("el-alert",{staticStyle:{"margin-bottom":"24px"},attrs:{type:"info",closable:!1}},[i("div",{staticStyle:{"font-size":"14px"}},[t._v(" 为了您的资金安全考虑，资金只允许提现到您实名认证的收款人，且实名认证通过后不允许修改。 ")])]),i("el-form-item",{attrs:{label:"认证方式",prop:"type"}},[i("el-radio-group",{staticClass:"el-radio-group-methods",attrs:{disabled:t.formDisabled},model:{value:t.form.method,callback:function(e){t.$set(t.form,"method",e)},expression:"form.method"}},[t.config.user_verify.methods.indexOf(t.METHOD.ALIPAY)>-1?i("el-radio",{attrs:{label:t.METHOD.ALIPAY}},[t._v(" 支付宝App一键验证 ")]):t._e(),t.config.user_verify.methods.indexOf(t.METHOD.MANUAL)>-1?i("el-radio",{attrs:{label:t.METHOD.MANUAL}},[t._v(" 人工客服审核 ")]):t._e()],1),t.form.method===t.METHOD.ALIPAY?i("p",{staticClass:"alipay-cert-tip green-text"},[t._v(t._s(t._f("moneyFormatterFilter")(t._f("moneyFilter")(t.config.user_verify.alipay_price)))+"元/次，由支付宝收取，认证通过后在您的平台账户扣除，不成功不收费。")]):t._e()],1),t.form.method===t.METHOD.ALIPAY?i("div",{staticStyle:{overflow:"hidden"}},[i("el-form-item",{attrs:{label:"证件类型",prop:"type"}},[i("el-select",{attrs:{disabled:t.formDisabled},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[i("el-option",{attrs:{value:t.TYPE.ID_CARD,label:"身份证"}})],1)],1),t.form.type===t.TYPE.ID_CARD?i("div",[i("el-form-item",{attrs:{label:"实名姓名",prop:"name"}},[i("el-tooltip",{attrs:{disabled:!t.nameDisabled,content:t.nameDisabled?"真实姓名与您提现的账户一致，无法修改":"",placement:"top-start"}},[i("el-input",{attrs:{name:"name",type:"text",placeholder:"请输入姓名",readonly:t.nameDisabled||t.formDisabled,disabled:t.formDisabled},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),"admin"!==t._project&&t.verify_ok?t._e():i("div",[i("el-form-item",{attrs:{label:"证件号码",prop:"number"}},[i("el-input",{attrs:{name:"number",type:"text",placeholder:"请输入证件号码",disabled:t.formDisabled},model:{value:t.form.number,callback:function(e){t.$set(t.form,"number",e)},expression:"form.number"}})],1)],1)],1):t._e()],1):t._e(),t.form.method===t.METHOD.MANUAL?i("div",{staticStyle:{overflow:"hidden"}},[i("el-form-item",{attrs:{label:"证件类型",prop:"type"}},[i("el-select",{attrs:{disabled:t.formDisabled},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[i("el-option",{attrs:{value:t.TYPE.ID_CARD,label:"身份证"}}),i("el-option",{attrs:{value:t.TYPE.BUSINESS,label:"营业执照"}})],1)],1),t.form.type===t.TYPE.ID_CARD?i("div",[i("el-form-item",{attrs:{label:"实名姓名",prop:"name"}},[i("el-tooltip",{attrs:{disabled:!t.nameDisabled,content:t.nameDisabled?"真实姓名与您提现的账户一致，无法修改":"",placement:"top-start"}},[i("el-input",{attrs:{name:"name",type:"text",placeholder:"请输入姓名",readonly:t.nameDisabled||t.formDisabled,disabled:t.formDisabled},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),"admin"!==t._project&&t.verify_ok?t._e():i("div",[i("el-form-item",{attrs:{label:"证件号码",prop:"number"}},[i("el-input",{attrs:{name:"number",type:"text",placeholder:"请输入证件号码",disabled:t.formDisabled},model:{value:t.form.number,callback:function(e){t.$set(t.form,"number",e)},expression:"form.number"}})],1),t.config.user_verify.need_picture?i("div",[i("el-form-item",{attrs:{label:"证件正面",prop:"front_pic"}},[t.userInfo_.verify&&t.userInfo_.verify.info&&t.userInfo_.verify.info.id_card&&t.userInfo_.verify.info.id_card.front_pic_id?i("a",{staticClass:"preview-btn",on:{click:function(e){return t.handleUploadPreview(t.userInfo_.verify.info.id_card.front_pic_id)}}},[t._v("点击查看")]):t._e(),i("input",{attrs:{accept:"image/png,image/gif,image/jpeg",type:"file",disabled:t.formDisabled},on:{change:function(e){return t.handleFileInput(e,"front_pic")}}})]),i("el-form-item",{attrs:{label:"证件反面",prop:"back_pic"}},[t.userInfo_.verify&&t.userInfo_.verify.info&&t.userInfo_.verify.info.id_card&&t.userInfo_.verify.info.id_card.back_pic_id?i("a",{staticClass:"preview-btn",on:{click:function(e){return t.handleUploadPreview(t.userInfo_.verify.info.id_card.back_pic_id)}}},[t._v("点击查看")]):t._e(),i("input",{attrs:{accept:"image/png,image/gif,image/jpeg",type:"file",disabled:t.formDisabled},on:{change:function(e){return t.handleFileInput(e,"back_pic")}}})])],1):t._e()],1)],1):t._e(),t.form.type===t.TYPE.BUSINESS?i("div",[i("el-form-item",{attrs:{label:"企业名称",prop:"name"}},[i("el-tooltip",{attrs:{disabled:!t.nameDisabled,content:t.nameDisabled?"企业名称与您提现的账户一致，无法修改":"",placement:"top-start"}},[i("el-input",{attrs:{name:"name",type:"text",placeholder:"请输入企业名称",readonly:t.nameDisabled||t.formDisabled,disabled:t.formDisabled},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),"admin"!==t._project&&t.verify_ok?t._e():i("div",[i("el-form-item",{attrs:{label:"证件号码",prop:"number"}},[i("el-input",{attrs:{name:"number",type:"text",placeholder:"请输入证件号码",disabled:t.formDisabled},model:{value:t.form.number,callback:function(e){t.$set(t.form,"number",e)},expression:"form.number"}})],1),t.config.user_verify.need_picture?i("div",[i("el-form-item",{attrs:{label:"营业执照",prop:"business_pic"}},[t.userInfo_.verify&&t.userInfo_.verify.info&&t.userInfo_.verify.info.business&&t.userInfo_.verify.info.business.business_pic_id?i("a",{staticClass:"preview-btn",on:{click:function(e){return t.handleUploadPreview(t.userInfo_.verify.info.business.business_pic_id)}}},[t._v("点击查看")]):t._e(),i("input",{attrs:{accept:"image/png,image/gif,image/jpeg",type:"file",disabled:t.formDisabled},on:{change:function(e){return t.handleFileInput(e,"business_pic")}}})])],1):t._e()],1)],1):t._e()],1):t._e(),"admin"===t._project||t.userInfo_.verify&&t.VERIFY_STATUS.UN.id!==t.userInfo_.verify.status?i("el-form-item",{attrs:{label:"认证状态"}},[i("el-tag",{attrs:{type:t.VERIFY_STATUS.get(t.userInfo_.verify?t.userInfo_.verify.status:t.VERIFY_STATUS.UN.id).type}},[t._v(" "+t._s(t.VERIFY_STATUS.get(t.userInfo_.verify?t.userInfo_.verify.status:t.VERIFY_STATUS.UN.id).name)+" ")]),i("br"),t.userInfo_.verify&&t.userInfo_.verify.status===t.VERIFY_STATUS.FAIL.id?i("span",{staticClass:"red-text"},[t._v(" 未通过原因："+t._s(t.userInfo_.verify.reason)+" ")]):t._e()],1):t._e(),i("el-form-item",{staticStyle:{"margin-top":"12px"}},["admin"!==t._project&&t.verify_ok?t._e():i("el-button",{attrs:{type:"primary",loading:t.loading,disabled:t.formDisabled},on:{click:t.handleSubmit}},[t._v(" "+t._s(t.verify_ing||t.verify_ok?"修改认证":t.verify_fail?"重新提交":"提交认证")+" ")]),"admin"===t._project?i("el-button",{attrs:{type:"success",disabled:t.verify_ok,loading:t.loading},on:{click:function(e){return t.handleOK(t.userInfo_.verify)}}},[t._v(" "+t._s((t.verify_ing,"审核通过"))+" ")]):t._e(),"admin"===t._project?i("el-button",{attrs:{type:"warning",disabled:t.verify_fail,loading:t.loading},on:{click:function(e){return t.handleFail(t.userInfo_.verify)}}},[t._v(" "+t._s(t.verify_ing?"审核拒绝":"驳回审核")+" ")]):t._e()],1)],1),t.certDialogVisible?i("el-dialog",{staticClass:"cert-dialog",attrs:{title:"实名认证",visible:t.certDialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.certDialogVisible=e}}},[i("div",{staticClass:"text-center"},[i("p",{staticClass:"text-center"},[t._v(t._s(t.certUrlTip))]),i("div",{staticClass:"qr-image",attrs:{id:"qrcode"}}),t.isMobile?i("a",{staticClass:"open-app-btn",attrs:{id:"open-app"},on:{click:t.openAlipayApp}},[i("img",{staticClass:"alipay-ico",attrs:{alt:"alipay",src:a("d58b")}}),t._v(" 点击打开支付宝")]):t._e()]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){return t.handleCloseCertDialog(!1)}}},[t._v("返回")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.handleCloseCertDialog(!0)}}},[t._v("已完成认证")])],1)]):t._e()],1)}),[],!1,null,"347fa55e",null)).exports;function Bt(t,e){return Object(T.a)({url:"info/shop_retail_code",method:"post",data:{shop_retail_code:e}})}function Ft(t){return Object(T.a)({url:"bank/qrcode/delete",method:"post",data:{id:t}})}function qt(t){return Object(T.a)({url:"wechat/notify",method:t?"post":"get",data:{options:t}})}var Vt={props:{inBox:{default:!1},userInfo:{default:null},_project:{default:"merchant"}},data:function(){return{loading:!1,userInfo_:{},nameDisabled:!1,formDisabled:!1,form:{bank_id:-1,bank_sub:"",bank_qrcode_id:null,bank_name:"加载中",bank_account:"加载中"},formRules:{bank_id:[{required:!0,message:"请选择收款银行",trigger:"blur"}],bank_name:[{required:!0,message:"请输入收款姓名",trigger:"blur"}],bank_account:[{required:!0,message:"请输入收款账户",trigger:"blur"}]},qrcode_upload_url:window.API_URL+("admin"===this._project?"user/":"")+"bank/qrcode?token="+encodeURIComponent(this.$store.state.user.token),qrcode_file_list:[],chooseBank:null,bankList:[{id:-1,name:"请选择"}]}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.userInfo?this.userInfo_=this.userInfo:this.userInfo_=this.$store.state.user.userInfo,this.getBank()},methods:{getBank:function(){var t=this;this.loading=!0,function(t){return Object(T.a)({url:"bank/list",method:"get",params:t})}().then((function(e){t.bankList=e.data;var a=t.userInfo_;t.form.user_id=a.id,t.form.bank_id=a.bank_id,t.form.bank_sub=a.bank_sub,t.form.bank_qrcode_id=a.bank_qrcode_id,t.form.bank_name=a.bank_name,t.form.bank_account=a.bank_account,a.bank_qrcode_id&&(t.qrcode_file_list=[{name:"点击查看二维码",id:a.bank_qrcode_id}]),t.form.bank_name||t.userInfo_.verify&&(t.form.bank_name=t.userInfo_.verify.name,"admin"!==t._project&&(t.nameDisabled=!0)),t.handleBankSelect(t.form.bank_id),"admin"!==t._project&&t.form.bank_id&&(t.formDisabled=!0),t.loading=!1}))},handleBankSelect:function(t){var e=this;this.bankList.forEach((function(a){a.id===t&&(e.chooseBank=a)}))},handleUploadPreview:function(t){if(t.response){var e=t.response.data;window.open(window.API_URL+"file/"+e.id+"/"+t.name+"?token="+encodeURIComponent(this.$store.state.user.token),"_blank")}},handleUploadChange:function(t,e){if(this.qrcode_file_list=e,e.length>0&&e[0].response&&e[0].response.data){var a=e[0].response.data;if(e[0].id=a.id,!e[0].id)return this.$message({message:"文件上传失败，请检查文件大小和格式",type:"error"});this.updateUserInfoQRCode(e[0].id)}},handleUploadRemove:function(t){var e=this;(t.id||t.response&&t.response.data)&&Ft(t.id||t.response.data.id,this.userInfo&&this.userInfo.id).then((function(){e.updateUserInfoQRCode(null)}))},handleUploadError:function(t,e,a){try{var i=JSON.parse(t.message).message;if(i)return this.$message({message:i,type:"error"})}catch(t){this.$message({message:"文件上传失败，请检查文件大小和格式",type:"error"})}},handleUploadExceed:function(){var t=this;this.$confirm("您的账户已经上传过收款二维码, 您需要先删除原有收款二维码才能继续添加<br>是否删除?","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).then((function(){Ft(t.qrcode_file_list[0].id,t.userInfo&&t.userInfo.id).then((function(){t.$notify({title:"操作成功",type:"success",message:"删除成功!"}),t.updateUserInfoQRCode(null),t.qrcode_file_list=[]}))}))},updateUserInfoQRCode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.form.bank_qrcode_id=t;var e=this.$store.state.user.userInfo;e.bank_qrcode_id=t,this.$store.commit("SET_USER_INFO",e)},handleDelete:function(){var t=this;this.loading=!0,function(t){return Object(T.a)({url:"bank/delete",method:"post",data:{user_id:t}})}(this.form.user_id).then((function(){t.$notify({title:"提示",message:"用户提现信息已经删除",type:"info",duration:3e3}),t.userInfo_.bank_id=null,t.userInfo_.bank_sub=null,t.userInfo_.bank_qrcode_id=null,t.userInfo_.bank_name=null,t.userInfo_.bank_account=null,t.form.bank_id=null,t.form.bank_sub=null,t.form.bank_qrcode_id=null,t.form.bank_name=null,t.form.bank_account=null,t.qrcode_file_list=[],t.loading=!1,t.$emit("submit",!0)})).catch((function(){t.loading=!1}))},onSubmit:function(){var t=this;this.$refs.form.validate((function(e){e&&(t.loading=!0,function(t){return Object(T.a)({url:"bank/edit",method:"post",data:t})}(t.form).then((function(){t.$notify({title:"提示",message:"修改信息成功",type:"success",duration:3e3}),t.$store.dispatch("GetInfo").then((function(){t.loading=!1,t.$emit("submit",!0)})).catch((function(){t.loading=!1}))})).catch((function(){t.loading=!1})))}))}}},Yt=Object(l.a)(Vt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"app-container":!t.userInfo}},[t.userInfo?t._e():a("h3",{staticStyle:{margin:"4px 0 28px 0"}},[t._v("收款信息")]),a("el-form",{ref:"form",style:{"margin-top":t.userInfo?"22px":"0"},attrs:{model:t.form,"label-position":"top",rules:t.formRules}},[a("el-form-item",{attrs:{label:"收款银行",prop:"bank_id"}},[a("el-select",{attrs:{disabled:t.formDisabled},on:{change:t.handleBankSelect},model:{value:t.form.bank_id,callback:function(e){t.$set(t.form,"bank_id",e)},expression:"form.bank_id"}},t._l(t.bankList,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1)],1),t.chooseBank&&t.chooseBank.need_subbranch?a("el-form-item",{attrs:{label:"支行信息",prop:"bank_sub",rules:{required:!0,message:"请输入支行信息",trigger:"blur"}}},[a("el-input",{attrs:{type:"text",placeholder:"请输入支行信息",disabled:t.formDisabled},model:{value:t.form.bank_sub,callback:function(e){t.$set(t.form,"bank_sub",e)},expression:"form.bank_sub"}})],1):t._e(),t.chooseBank&&t.chooseBank.need_qrcode?a("el-form-item",{attrs:{label:"收款码",prop:"bank_qrcode_id",rules:{required:!0,message:"请上传收款二维码",trigger:"blur"}}},[a("el-upload",{attrs:{disabled:t.formDisabled,action:t.qrcode_upload_url,multiple:!1,data:{user_id:t.userInfo?t.userInfo.id:""},headers:{"X-Requested-With":"XMLHttpRequest"},limit:1,"with-credentials":!0,"file-list":t.qrcode_file_list,name:"qrcode","on-preview":t.handleUploadPreview,"on-error":t.handleUploadError,"on-remove":t.handleUploadRemove,"on-change":t.handleUploadChange,"on-exceed":t.handleUploadExceed}},[a("el-button",{attrs:{disabled:t.formDisabled,size:"small",type:"primary"}},[t._v("点击上传二维码")])],1)],1):t._e(),a("el-form-item",{attrs:{label:"收款姓名",prop:"bank_name"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入收款姓名",disabled:t.nameDisabled||t.formDisabled},model:{value:t.form.bank_name,callback:function(e){t.$set(t.form,"bank_name",e)},expression:"form.bank_name"}})],1),a("el-form-item",{attrs:{label:"收款账户",prop:"bank_account"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入收款账户",disabled:t.formDisabled},model:{value:t.form.bank_account,callback:function(e){t.$set(t.form,"bank_account",e)},expression:"form.bank_account"}})],1),a("el-form-item",["admin"===t._project?a("el-button",{attrs:{type:"warning",loading:t.loading},on:{click:t.handleDelete}},[t._v("删除信息")]):t._e(),a("el-button",{attrs:{type:"primary",loading:t.loading,disabled:t.formDisabled},on:{click:t.onSubmit}},[t._v("保存信息")]),a("p",{staticClass:"red-text"},[t._v("注意：信息一旦填写不允许"+t._s("admin"===t._project?" 商户 自行":"")+"修改")])],1)],1)],1)}),[],!1,null,null,null).exports,Ht={AUTO_WAITING:{id:0,name:"自动结算",type:"info"},WAITING:{id:1,name:"等待审核",type:"info"},PROCESSING:{id:2,name:"正在处理",type:"primary"},DENIED:{id:3,name:"提现失败",type:"warning"},SUCCESS:{id:4,name:"已结算",type:"success"},get:function(t){for(var e in this)if(this.hasOwnProperty(e)&&this[e].id===t)return this[e];return{id:t,type:"danger",name:"未知状态"}}};var Wt={props:{inBox:{default:!1},userInfo:{default:null}},data:function(){return{loading:!1,labelWidth:this.$store.state.app.isMobile?"78px":"90px",feeCalc:!1,todayIncome:0,canTodayIncome:0,userInfo_:{},formDisabled:!1,form:{amount:"",fee:"0"}}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){var t=this;this.userInfo?this.userInfo_=this.userInfo:this.userInfo_=this.$store.state.user.userInfo,this.loading=!0,function(t){return Object(T.a)({url:"order/income/today",method:"get",params:{user_id:t}})}(this.userInfo_.id).then((function(e){t.loading=!1,t.todayIncome=e.data.income,t.canTodayIncome=e.data.can,Object.assign(t.userInfo_,e.data.user)}))},methods:{calcFee:function(){var t=this;this.form.amount=+this.form.amount||0,1*this.form.amount<=0||(this.form.fee="计算中",this.loading=!0,function(t){return Object(T.a)({url:"withdraw/fee",method:"get",params:{amount:t}})}(this.form.amount).then((function(e){t.form.fee=e.data,t.loading=!1,t.feeCalc=!0})).catch((function(){t.loading=!1})))},onSubmit:function(){var t=this;if(!(1*this.form.amount<=0)){if(100*this.form.amount>this.userInfo_.m_balance)return this.$msgbox({title:"提示",type:"error",message:"您输入的提现金额大于当前余额，无法提交"});if(!this.canTodayIncome&&Math.round(100*this.form.amount)>this.userInfo_.m_balance-this.todayIncome)return this.$msgbox({title:"提示",type:"error",dangerouslyUseHTMLString:!0,message:"您输入的提现金额扣除手续费后大于当前可提金额，无法提交"+(this.canTodayIncome?"":"<br>(今日交易需要等待第二天才可以提现)")});this.loading=!0,this.userInfo&&(this.form.user_id=this.userInfo.id),function(t){return Object(T.a)({url:"withdraw/apply",method:"post",data:t})}(this.form).then((function(e){if("verify"===e.data)return t.$alert("根据相关法律法规，您需要通过实名认证后才可以提现","提示",{confirmButtonText:"去认证"}).then((function(){t.$router.push({path:"/m/user/verify"})})),void(t.loading=!1);t.$notify({title:"提示",message:"提现申请成功",type:"success",duration:3e3}),t.$store.dispatch("GetInfo").then((function(){t.loading=!1,t.$emit("submit",!0)})).catch((function(){t.loading=!1}))})).catch((function(){t.loading=!1}))}}}},Qt=Object(l.a)(Wt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"app-container":!t.inBox}},[a("h3",{staticStyle:{margin:"4px 0 28px 0"}},[t._v("申请提现")]),a("el-form",{ref:"form",attrs:{model:t.form,"label-width":t.labelWidth}},[a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"账户余额",prop:"m_balance"}},[a("span",[t._v(t._s(t._f("moneyFormatterFilter")(t._f("moneyFilter")(t.userInfo_.m_balance)))+"(今日交易"+t._s(t._f("moneyFormatterFilter")(t._f("moneyFilter")(t.todayIncome)))+")")])]),a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"冻结余额",prop:"m_frozen"}},[a("span",[t._v(t._s(t._f("moneyFormatterFilter")(t._f("moneyFilter")(t.userInfo_.m_frozen))))])]),a("el-form-item",{staticStyle:{"margin-bottom":"12px"},attrs:{label:"可提金额"}},[a("span",[t._v(t._s(t._f("moneyFormatterFilter")(t._f("moneyFilter")(this.canTodayIncome?t.userInfo_.m_balance:t.userInfo_.m_balance-t.todayIncome))))])]),a("el-form-item",{attrs:{label:"金额",prop:"amount",rules:[{required:!0,message:"请输入申请支付金额",trigger:"blur"},{type:"number",min:.01,message:"金额太小, 请重新输入",trigger:"blur"},{type:"number",max:1e7,message:"金额太大, 请重新输入",trigger:"blur"}]}},[a("el-input",{attrs:{type:"text",placeholder:"请输入申请支付金额",disabled:t.formDisabled},on:{change:t.calcFee},model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}})],1),a("el-form-item",{attrs:{label:"手续费",prop:"fee"}},[a("el-input",{attrs:{type:"text",placeholder:"1",disabled:""},model:{value:t.form.fee,callback:function(e){t.$set(t.form,"fee",e)},expression:"form.fee"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.loading,disabled:t.formDisabled||1*t.form.amount<=.01||!t.feeCalc},on:{click:t.onSubmit}},[t._v(" 申请结算 ")])],1)],1)],1)}),[],!1,null,null,null).exports,Gt=(a("841c"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"处理提现",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.formRules,"label-width":t.labelWidth}},[a("el-form-item",{staticClass:"withdraw-handle-item"},[a("span",[t._v("用户账户信息")]),t.loadingUser?t._e():a("div",{staticClass:"info-table"},[a("table",{attrs:{border:"0",cellspacing:"0"}},[a("tbody",[t.userInfo.bank_id?t._e():a("tr",[a("td",{staticClass:"i-name"},[t._v("银行")]),a("td",{staticClass:"i-val"},[a("span",[t._v("未填写")])])]),t.userInfo.bank_id?a("tr",[a("td",{staticClass:"i-name"},[t._v("银行")]),a("td",{staticClass:"i-val"},[a("span",[t._v(t._s(t.userInfo.bank?t.userInfo.bank.name:"未知#"+t.userInfo.bank_id))])])]):t._e(),t.userInfo.bank&&t.userInfo.bank.need_subbranch?a("tr",[a("td",{staticClass:"i-name"},[t._v("支行信息")]),a("td",{staticClass:"i-val"},[a("span",[t._v(t._s(t.userInfo.bank_sub))])])]):t._e(),t.userInfo.bank_id?a("tr",[a("td",{staticClass:"i-name"},[t._v("银行账户")]),a("td",{staticClass:"i-val"},[a("span",[t._v(t._s(t.userInfo.bank_account))])])]):t._e(),t.userInfo.bank_id?a("tr",[a("td",{staticClass:"i-name"},[t._v("账户姓名")]),a("td",{staticClass:"i-val"},[a("span",[t._v(t._s(t.userInfo.bank_name))])])]):t._e(),t.userInfo.bank&&t.userInfo.bank.need_qrcode?a("tr",[a("td",{staticClass:"i-name"},[t._v("二维码")]),a("td",{staticClass:"i-val"},[a("div",{attrs:{id:"bank_qrcode"},on:{mouseover:t.handleImgOver,mouseleave:t.handleImgLeave,click:t.handleImgOpen}},[t._v(" 点击查看#"+t._s(t.userInfo.bank_qrcode_id)+" "),t.imgViewUrl?a("img",{attrs:{src:t.imgViewUrl},on:{click:t.handleImgOpen}}):t._e()])])]):t._e(),t.info.amount?a("tr",[a("td",{staticClass:"i-name"},[t._v("提现金额")]),a("td",{staticClass:"i-val"},[a("span",[t._v(t._s(t._f("moneyFormatterFilter")(t._f("moneyFilter")(t.info.amount))))])])]):t._e(),t.info.fee?a("tr",[a("td",{staticClass:"i-name"},[t._v("手续费")]),a("td",{staticClass:"i-val"},[a("span",[t._v(t._s(t._f("moneyFormatterFilter")(t._f("moneyFilter")(t.info.fee)))+" (用户余额扣除=提现金额+手续费)")])])]):t._e()])])]),t.loadingUser?a("div",{staticClass:"info-table"},[t._v("加载中")]):t._e()]),a("el-form-item",{staticClass:"withdraw-handle-item",attrs:{prop:"status"}},[a("span",[t._v("处理结果")]),a("el-radio-group",{attrs:{size:"small"},on:{change:t.handleStatusChange},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("el-radio-button",{attrs:{label:t.WITHDRAW_STATUS.AUTO_WAITING.id}},[t._v("自动结算待处理")]),a("el-radio-button",{attrs:{label:t.WITHDRAW_STATUS.WAITING.id}},[t._v("待处理")]),a("el-radio-button",{attrs:{label:t.WITHDRAW_STATUS.PROCESSING.id}},[t._v("处理中")]),a("el-radio-button",{attrs:{label:t.WITHDRAW_STATUS.SUCCESS.id}},[t._v("确认打款")]),a("el-radio-button",{staticClass:"el-radio-gray",attrs:{label:t.WITHDRAW_STATUS.DENIED.id}},[t._v("拒绝")])],1),t.info.auto_withdraw_id>0?a("span",{staticClass:"red-text"},[t._v("本次提现请求由系统自动发起, 一般情况请勿手动处理")]):t._e()],1),t.form.status===t.WITHDRAW_STATUS.SUCCESS.id&&t.userInfo&&t.userInfo.bank&&"支付宝"===t.userInfo.bank.name?a("el-form-item",{staticClass:"withdraw-handle-item"},[a("el-switch",{attrs:{"inactive-text":"慎! 自动打款到支付宝账户","active-value":1,"inactive-value":0},model:{value:t.form.auto_pay,callback:function(e){t.$set(t.form,"auto_pay",e)},expression:"form.auto_pay"}})],1):t._e(),t.form.status===t.WITHDRAW_STATUS.DENIED.id?a("el-form-item",{staticClass:"withdraw-handle-item"},[a("el-tooltip",{attrs:{effect:"dark",placement:"top-start",content:t.form.balance?"系统将退回本次金额到用户余额":"系统会吞掉此次申请提现金额"}},[a("el-switch",{attrs:{"inactive-text":"本次金额返还到用户余额","active-value":1,"inactive-value":0},model:{value:t.form.balance,callback:function(e){t.$set(t.form,"balance",e)},expression:"form.balance"}})],1)],1):t._e(),t.form.status===t.WITHDRAW_STATUS.DENIED.id?a("el-form-item",{staticClass:"withdraw-handle-item"},[a("span",[t._v("拒绝原因")]),a("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:8},size:"small",placeholder:"请输入拒绝原因"},model:{value:t.form.reason,callback:function(e){t.$set(t.form,"reason",e)},expression:"form.reason"}})],1):t._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){return t.handleClose(!1)}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("确认")])],1)],1)}),Zt=(a("868c"),{props:{info:{},userInfo:{default:function(){return{id:this.info.user_id}}}},data:function(){return{loading:!1,visible:!0,labelWidth:"0px",WITHDRAW_STATUS:Ht,loadingUser:!1,form:{id:0,status:null,auto_pay:0,balance:0,reason:""},formRules:{status:[{required:!0,message:"请选择处理结果",trigger:"blur"}]},imgViewUrl:null}},watch:{visible:function(t){t||this.$emit("close",!1)}},mounted:function(){var t=this;this.form.id=this.info.id,this.form.status=this.info.status,this.form.reason=this.info.reason,this.loading=!0,this.loadingUser=!0,function(t){return Object(T.a)({url:"withdraw/user",method:"get",params:{id:t}})}(this.form.id).then((function(e){Object.assign(t.userInfo,e.data),t.loading=!1,t.loadingUser=!1}))},methods:{handleSubmit:function(){var t=this;this.$refs.form.validate((function(e){e&&(t.loading=!0,function(t){return Object(T.a)({url:"withdraw/handle",method:"post",data:t})}(t.form).then((function(e){t.loading=!1,t.$notify({title:"提示",message:e.data.msg||e.data.length&&e.data||"处理提现成功",dangerouslyUseHTMLString:!0,type:t.form.status===Ht.SUCCESS.id?"success":"info",duration:1e4}),t.form.balance&&t.userInfo&&0===e.data.code&&(t.userInfo.m_paid-=t.info.amount+t.info.fee,t.userInfo.m_balance+=t.info.amount+t.info.fee),t.handleClose(!0)})).catch((function(){t.loading=!1})))}))},handleClose:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)},handleStatusChange:function(t){t===Ht.DENIED.id&&(null!==this.userInfo.bank_id||this.form.reason||(this.form.balance=1,this.form.reason="请先填写结算账户后再申请结算"),this.info.trans_result&&this.info.trans_result.startsWith("error:")&&(this.form.balance=1,this.form.reason=this.info.trans_result))},handleImgOpen:function(){window.open(window.API_URL+"file/"+this.userInfo.bank_qrcode_id+"/qrcode?&token="+encodeURIComponent(this.$store.state.user.token),"_blank")},handleImgOver:function(){this.imgViewUrl=window.API_URL+"file/"+this.userInfo.bank_qrcode_id+"/qrcode?token="+encodeURIComponent(this.$store.state.user.token)},handleImgLeave:function(){this.imgViewUrl=null}}}),Jt=(a("0c79"),Object(l.a)(Zt,Gt,[],!1,null,null,null)).exports,Kt={props:{userInfo:{type:Object,default:null},filterType:{default:null},_project:{default:"merchant"}},components:{withdrawApply:Qt,withdrawAccountEdit:Yt,withdrawHandle:Jt},data:function(){return{isMobile:this.$store.state.app.isMobile,loading:!1,exporting:!1,showAddBox:!1,addBoxLoaded:!1,showAccountEditBox:!1,accountEditLoaded:!1,WITHDRAW_STATUS:Ht,search:{type:"id",value:""},date_range:"",where:{},list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",statusFilter:function(){var t=[];for(var e in Ht)Ht.hasOwnProperty(e)&&"object"===Object(F.a)(Ht[e])&&t.push({text:Ht[e].name,value:Ht[e].id,type:Ht[e].type});return t}(),pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},chooseInfo:null}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,null!==this.filterType&&(this.where.filterType=this.filterType),this.userInfo&&(this.where.user_id=this.userInfo.id),function(t){return Object(T.a)({url:"withdraw",method:"get",params:t})}(this.where).then((function(e){t.list=e.data,t.loading=!1}))},handleSearch:function(){var t={search:this.search.type,val:this.search.value};this.date_range&&this.date_range[0]&&this.date_range[1]?(t.start_at=this.date_range[0].format("yyyy-MM-dd"),t.end_at=this.date_range[1].format("yyyy-MM-dd")):(t.start_at=null,t.end_at=null),Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.status?e.status=t.status.join(","):e.status=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},handleApply:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.$store.state.user.userInfo.bank_id<1)){t.next=3;break}return t.abrupt("return",this.$notify.error({title:"错误",message:"未填写提现账户, 无法提现"}));case 3:this.$router.push("/m/user/pay/apply"),t.next=13;break;case 7:if(!this.userInfo){t.next=13;break}return window.scrollTo(0,0),this.addBoxLoaded=!0,t.next=12,this.$nextTick();case 12:this.showAddBox=!0;case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),onApply:function(){this.getList(),this.showAddBox=!1},handleWithdrawEnabledChange:function(t){var e=this;this.loading=!0,function(t){return Object(T.a)({url:"withdraw/set_enabled",method:"post",data:t})}({user_id:this.userInfo.id,withdraw_enabled:t}).then((function(){e.userInfo.withdraw_config||(e.userInfo.withdraw_config={}),e.userInfo.withdraw_config.enabled=t})).finally((function(){e.loading=!1}))},handleWithdrawTypeChange:function(t){var e=this;this.loading=!0,function(t){return Object(T.a)({url:"withdraw/set_type",method:"post",data:t})}({user_id:this.userInfo.id,withdraw_type:t}).then((function(){e.userInfo.withdraw_config||(e.userInfo.withdraw_config={}),e.userInfo.withdraw_config.type=t})).finally((function(){e.loading=!1}))},handleWithdrawAutoChange:function(t){var e=this;this.loading=!0,function(t){return Object(T.a)({url:"withdraw/set_auto",method:"post",data:t})}({user_id:this.userInfo.id,withdraw_auto:t}).then((function(){e.userInfo.withdraw_config||(e.userInfo.withdraw_config={}),e.userInfo.withdraw_config.auto=t})).finally((function(){e.loading=!1}))},handleEditAccount:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.accountEditLoaded=!0,t.next=3,this.$nextTick();case 3:this.showAccountEditBox=!0;case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),handleIt:function(t){this.chooseInfo=t},onHandleClose:function(t){this.chooseInfo=null,t&&this.getList()}}},Xt=(a("3a96"),Object(l.a)(Kt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",class:{"app-container":!t.userInfo}},[a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showAccountEditBox,expression:"showAccountEditBox"}],staticClass:"apply-box"},[a("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",type:"danger",size:"small"},on:{click:function(e){t.showAccountEditBox=!1}}}),t.showAccountEditBox||t.accountEditLoaded?a("el-card",{staticClass:"my-card"},[a("withdraw-account-edit",{attrs:{"in-box":!0,userInfo:t.userInfo},on:{submit:function(e){t.showAccountEditBox=!1},changeTab:function(e){return t.$emit("changeTab",e)}}})],1):t._e()],1)]),a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showAddBox,expression:"showAddBox"}],staticClass:"apply-box"},[a("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",type:"danger",size:"small"},on:{click:function(e){t.showAddBox=!1}}}),t.showAddBox?a("el-card",{staticClass:"my-card"},[a("withdraw-apply",{attrs:{"in-box":!0,userInfo:t.userInfo},on:{submit:t.onApply,changeTab:function(e){return t.$emit("changeTab",e)}}})],1):t._e()],1)]),a("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[a("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[a("el-form-item",{staticClass:"mobile-full-width"},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[a("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[a("el-option",{attrs:{label:"ID",value:"id"}}),a("el-option",{attrs:{label:"备注",value:"remark"}})],1)],1)],1),a("el-form-item",{staticClass:"mobile-full-width"},[a("el-date-picker",{attrs:{size:"small",type:"daterange",align:"right",placeholder:"日期范围","picker-options":t.pickerOptions},model:{value:t.date_range,callback:function(e){t.date_range=e},expression:"date_range"}})],1),a("el-form-item",[a("el-button",{attrs:{disabled:t.loading,size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),a("el-form-item",{staticClass:"right-toolbox"},["admin"===t._project?a("span",[t._v("提现:")]):t._e(),"admin"===t._project?a("el-select",{staticClass:"withdraw-config-item",attrs:{size:"small",value:t.userInfo.withdraw_config&&void 0!==t.userInfo.withdraw_config.enabled?t.userInfo.withdraw_config.enabled:null,disabled:t.loading,placeholder:"默认"},on:{change:t.handleWithdrawEnabledChange}},[a("el-option",{attrs:{label:"默认",value:null}}),a("el-option",{attrs:{label:"强制关闭",value:0}})],1):t._e(),"admin"===t._project?a("span",[t._v("提现时间:")]):t._e(),"admin"===t._project?a("el-select",{staticClass:"withdraw-config-item",attrs:{size:"small",value:t.userInfo.withdraw_config&&void 0!==t.userInfo.withdraw_config.type?t.userInfo.withdraw_config.type:null,disabled:t.loading,placeholder:"默认"},on:{change:t.handleWithdrawTypeChange}},[a("el-option",{attrs:{label:"默认",value:null}}),a("el-option",{attrs:{label:"D0(允许提现当日订单)",value:0}}),a("el-option",{attrs:{label:"D1",value:1}})],1):t._e(),"admin"===t._project?a("span",[t._v("自动提现:")]):t._e(),"admin"===t._project?a("el-select",{staticClass:"withdraw-config-item",attrs:{size:"small",value:t.userInfo.withdraw_config&&void 0!==t.userInfo.withdraw_config.auto?t.userInfo.withdraw_config.auto:null,disabled:t.loading,placeholder:"默认"},on:{change:t.handleWithdrawAutoChange}},[a("el-option",{attrs:{label:"默认",value:null}}),a("el-option",{attrs:{label:"强制关闭",value:0}})],1):t._e(),"admin"===t._project?a("el-link",{on:{click:t.handleEditAccount}},[a("icon",{attrs:{name:"cog"}}),t._v(" 编辑账户 ")],1):t._e(),a("el-link",{on:{click:t.handleApply}},[a("icon",{attrs:{name:"regular/yen-sign"}}),t._v(" 申请提现 ")],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map((function(t){return t.id})).join(",")}}},["admin"===t._project?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),a("el-table-column",{attrs:{prop:"amount",label:"金额",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("moneyFilter")(e.row.amount))+" ")]}}])}),a("el-table-column",{attrs:{prop:"fee",label:"手续费",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("moneyFilter")(e.row.fee))+" ")]}}])}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"100","column-key":"status",filters:t.statusFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.WITHDRAW_STATUS.get(e.row.status).type}},[t._v(" "+t._s(t.WITHDRAW_STATUS.get(e.row.status).name)+" ")])]}}])}),"admin"===t._project?a("el-table-column",{attrs:{prop:"trans_result",label:"打款结果","min-width":"100","show-overflow-tooltip":""}}):t._e(),a("el-table-column",{attrs:{prop:"remark",label:"备注","min-width":"100","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.remark)+" "+t._s(e.row.status===t.WITHDRAW_STATUS.DENIED.id?"拒绝原因:"+e.row.reason:"")+" ")]}}])}),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"160"}}),a("el-table-column",{attrs:{prop:"paid_at",label:"支付时间",width:"160"}}),"admin"===t._project?a("el-table-column",{attrs:{label:"操作",width:"50",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"icon-btn",on:{click:function(a){return t.handleIt(e.row)}}},[t._v("处理")])]}}],null,!1,4077858374)}):t._e()],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?a("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.list.per_page,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t.chooseInfo?a("withdraw-handle",{attrs:{info:t.chooseInfo,userInfo:t.userInfo},on:{close:t.onHandleClose}}):t._e()],1)}),[],!1,null,null,null)).exports,te=(a("7db0"),a("d81d"),{OK:{id:0,name:"正常",type:"primary"},FROZEN:{id:1,name:"已冻结",type:"warning"},get:function(t){for(var e in this)if(this.hasOwnProperty(e)&&this[e].id===t)return this[e];return{id:t,type:"danger",name:"未知状态"}}}),ee={RANGE:0,REAL:1,AUTO:2},ae=(a("2ca0"),a("9339")),ie=a.n(ae);ie.a.imports["formats/link"].PROTOCOL_WHITELIST.push("mqqapi");var ne={name:"QuillEditor",props:{value:{default:""},placeholder:{default:"请输入内容"},disabled:{default:!1},theme:{default:"snow"},userInfo:{},upload_url:{default:window.API_URL+"file/upload"}},data:function(){var t=Object(wt.c)(8);return{userInfo_:null,id_editor:"editor-"+t,id_toolbar:"editor-toolbar-"+t,quill_editor:null,showUpload:!1,upload_headers:{"X-Requested-With":"XMLHttpRequest",Authorization:this.$store.state.user.token},upload:{type:"upload",manual:""}}},watch:{disabled:function(){this.quill_editor&&(this.disabled?this.quill_editor.disable():this.quill_editor.enable())}},mounted:function(){var t=this;this.userInfo?this.userInfo_=this.userInfo:this.userInfo_=this.$store.getters.userInfo,this.quill_editor=new ie.a("#"+this.id_editor,{modules:{toolbar:"#"+this.id_toolbar},placeholder:this.placeholder,theme:this.theme}),this.quill_editor.on("editor-change",(function(e){"text-change"===e&&t.$emit("change",arguments.length<=1?void 0:arguments[1])})),this.quill_editor.getModule("toolbar").addHandler("image",(function(){if(!t.disabled){var e=t.quill_editor.getSelection();t.showUpload=!0,t.upload.manual="",t.uploadSuccess=function(a){t.quill_editor.insertEmbed(e.index,"image",a,"user")}}})),this.setValue(this.value)},beforeDestroy:function(){this.quill_editor=null},methods:{onUploadClose:function(t){t.target===this.$refs.upload_wrapper&&(this.showUpload=!1)},handleUploadChange:function(t,e){if(e.length>0&&e[0].response){var a=e[0].response;if(!a.data)return this.$msgbox({message:a,title:"错误",type:"error"});if(!a.data.url)return this.showUpload=!1,this.$message({message:a.msg,type:"error"});this.uploadSuccess(a.data.url),this.showUpload=!1}},handleUploadError:function(t,e,a){try{var i=JSON.parse(t.message).message;if(i)return this.$message({message:i,type:"error"})}catch(t){this.$message({message:"文件上传失败，请检查文件大小和格式",type:"error"})}},handleUploadInputUrl:function(){this.upload.manual=this.upload.manual.trim(),this.upload.manual.startsWith("http://")||this.upload.manual.startsWith("https://")||this.upload.manual.startsWith("ftp://")?(this.uploadSuccess(this.upload.manual),this.showUpload=!1):this.$alert("请输入合法的图片URL地址")},handleInsertQQGroup:function(t){var e=this;if(!this.disabled){this.quill_editor.focus();var a=this.quill_editor.getSelection();a&&this.$prompt("请输入加群链接<br>获取方式: <br>手机QQ - 选择QQ群 - 右上角菜单 - 分享群聊 - 复制链接","插入QQ群加群按钮",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"https://jq.qq.com/?_wv=1027&k=xxxx",inputPattern:/https?:\/\/.+/,inputErrorMessage:"请输入正确的加群链接",closeOnClickModal:!1,dangerouslyUseHTMLString:!0}).then((function(t){var i=t.value,n=(new(ie.a.import("delta"))).retain(a.index).insert({image:"//pub.idqqimg.com/wpa/images/group.png"},{alt:i,link:i});e.quill_editor.updateContents(n,"user")})).finally((function(){e.quill_editor.blur()}))}},getValue:function(){return JSON.stringify(this.quill_editor.getContents())},setValue:function(t){if(t&&"{"===t[0])try{this.quill_editor.setContents(JSON.parse(t))}catch(e){this.quill_editor.setText(t||"")}else this.quill_editor.setText(t||"")}}},re=(a("2258"),Object(l.a)(ne,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"quill-editor",class:{"quill-editor_disabled":t.disabled}},[i("div",{attrs:{id:t.id_toolbar}},[t._m(0),t._m(1),t._m(2),i("span",{staticClass:"ql-formats"},[i("button",{staticClass:"ql-image",attrs:{title:"插入图片"}}),i("button",{staticClass:"ql-link",attrs:{title:"插入链接"}}),i("button",{staticClass:"ql-qq_group",attrs:{title:"插入QQ群"},on:{click:t.handleInsertQQGroup}},[i("img",{attrs:{width:"16",src:a("9d61")}})])])]),i("div",{attrs:{id:t.id_editor}}),t.showUpload?i("div",{staticClass:"v-modal",staticStyle:{"z-index":"1010"},on:{click:function(e){t.showUpload=!1}}}):t._e(),t.showUpload?i("div",{ref:"upload_wrapper",staticClass:"el-message-box__wrapper",staticStyle:{"z-index":"1011"},on:{click:t.onUploadClose}},[i("div",{staticClass:"upload-box"},[i("el-radio",{attrs:{label:"upload"},model:{value:t.upload.type,callback:function(e){t.$set(t.upload,"type",e)},expression:"upload.type"}},[t._v("手动上传")]),i("el-radio",{attrs:{label:"input"},model:{value:t.upload.type,callback:function(e){t.$set(t.upload,"type",e)},expression:"upload.type"}},[t._v("网络图片")]),i("el-upload",{directives:[{name:"show",rawName:"v-show",value:"upload"===t.upload.type,expression:"upload.type === 'upload'"}],attrs:{drag:"","list-type":"picture",action:t.upload_url,multiple:!1,data:{user_id:t.userInfo_?t.userInfo_.id:""},headers:t.upload_headers,limit:1,"with-credentials":!1,"on-error":t.handleUploadError,"on-change":t.handleUploadChange}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),i("em",[t._v("点击上传")]),i("div",{staticStyle:{"font-size":"12px"}},[t._v("只能上传图片文件，且不超过5MB")])])]),i("el-input",{directives:[{name:"show",rawName:"v-show",value:"input"===t.upload.type,expression:"upload.type === 'input'"}],attrs:{type:"text",placeholder:"请输入图片URL地址"},model:{value:t.upload.manual,callback:function(e){t.$set(t.upload,"manual",e)},expression:"upload.manual"}},[i("el-button",{attrs:{slot:"append",type:"text"},on:{click:t.handleUploadInputUrl},slot:"append"},[t._v("确定")])],1)],1)]):t._e()])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"ql-formats"},[a("select",{staticClass:"ql-size",attrs:{title:"字体"}},[a("option",{attrs:{value:"small"}},[t._v("小号")]),a("option",{attrs:{selected:""}},[t._v("普通")]),a("option",{attrs:{value:"large"}},[t._v("大号")]),a("option",{attrs:{value:"huge"}},[t._v("超大")])]),a("button",{staticClass:"ql-bold",attrs:{title:"加粗"}}),a("button",{staticClass:"ql-italic",attrs:{title:"倾斜"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"ql-formats"},[e("select",{staticClass:"ql-color",attrs:{title:"颜色"}}),e("select",{staticClass:"ql-background",attrs:{title:"背景色"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"ql-formats"},[e("button",{staticClass:"ql-list",attrs:{value:"ordered",title:"序号列表"}}),e("button",{staticClass:"ql-list",attrs:{value:"bullet",title:"列表"}}),e("select",{staticClass:"ql-align",attrs:{title:"布局"}},[e("option",{attrs:{selected:""}}),e("option",{attrs:{value:"center"}}),e("option",{attrs:{value:"right"}}),e("option",{attrs:{value:"justify"}})])])}],!1,null,null,null)).exports,oe={props:{userInfo:{},_project:{default:"merchant"}},components:{QuillEditor:re,userVerify:Nt},data:function(){return{loading:!1,isMobile:this.$store.state.app.isMobile,USER_STATUS:te,INVENTORY_TYPE:ee,showVerifyBox:!1,verifyBoxLoaded:!1,form:{id:0,email:"加载中",status:te.OK.id,password:"",name:"",qq:"",shop_name:"",shop_ann:"",shop_ann_pop:"",shop_inventory:0,fee_type:0,theme_config:{},shop_theme:""},formRules:{name:[{required:!0,message:"请输入商户名称",trigger:"blur"}],qq:[{required:!0,message:"请输入商户联系QQ",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:function(t,e,a){E(e)?a():a(new Error("请输入正确的邮箱"))}}],shop_name:[{required:!0,message:"请输入店铺名称",trigger:"blur"}]},theme:null,themes:[]}},mounted:function(){Object.assign(this.form,this.$store.state.user.userInfo),this.$refs["editor-shop_ann"].setValue(this.form.shop_ann),this.$refs["editor-shop_ann_pop"].setValue(this.form.shop_ann_pop),this.getShopThemes()},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},methods:{getShopThemes:function(){var t=this;this.loading=!0,function(t){return Object(T.a)({url:"shopController/theme",method:"get",params:t})}().then((function(e){t.themes=e.data.themes,t.themes.forEach((function(e){if(e.value=e.name,e.options&&e.config)for(var a in e.options)if(e.options.hasOwnProperty(a)&&e.config.hasOwnProperty(a))try{e.options[a].value=t.form.theme_config[e.name][a]}catch(t){e.options[a].value=e.config[a]}t.form.theme_config&&t.form.theme_config.theme===e.name&&(t.form.shop_theme=e.name,t.theme=e)})),t.theme||(t.form.shop_theme=e.data.default,t.theme=t.themes.find((function(t){return t.name===e.data.default})))})).finally((function(){t.loading=!1}))},onSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(e){t.loading=!0,t.form.shop_ann=t.$refs["editor-shop_ann"].getValue(),t.form.shop_ann_pop=t.$refs["editor-shop_ann_pop"].getValue();var a=Object.assign({},t.form);a.act="edit",a.theme_config={},Object.keys(t.theme.options).map((function(e){a.theme_config[e]=t.theme.options[e].value})),a.theme_config=JSON.stringify(a.theme_config),window.tmp=a,function(t){return Object(T.a)({url:"info/edit",method:"post",data:t})}(a).then((function(){t.$notify({title:"提示",message:"修改信息成功",type:"success",duration:3e3}),t.$store.dispatch("GetInfo").then((function(){t.loading=!1})).catch((function(){t.loading=!1}))})).catch((function(){t.loading=!1}))}}))},handleVerify:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.verifyBoxLoaded=!0,t.next=3,this.$nextTick();case 3:this.showVerifyBox=!0;case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),restoreThemeDefaultConfig:function(){if(this.theme.options&&this.theme.config)for(var t in this.theme.options)this.theme.options.hasOwnProperty(t)&&this.theme.config.hasOwnProperty(t)&&(this.theme.options[t].value=this.theme.config[t])}}},se=(a("33f3"),a("657f"),Object(l.a)(oe,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"app-container":!t.userInfo}},[t.userInfo?t._e():a("h3",{staticStyle:{margin:"4px 0 16px 0"}},[t._v("编辑信息")]),a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showVerifyBox,expression:"showVerifyBox"}],staticClass:"apply-box"},[a("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",type:"danger",size:"small"},on:{click:function(e){t.showVerifyBox=!1}}}),t.showVerifyBox||t.verifyBoxLoaded?a("el-card",{staticClass:"my-card"},[a("user-verify",{attrs:{"in-box":!0,userInfo:t.userInfo}})],1):t._e()],1)]),"admin"===t._project?a("div",{staticStyle:{height:"16px","margin-top":"16px"}},[a("div",{staticStyle:{float:"right","margin-right":"0"}},[a("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:t.handleVerify}},[a("icon",{attrs:{name:"cog"}}),t._v(" 实名信息")],1)])]):t._e(),a("el-form",{ref:"form",staticClass:"user-info-form",attrs:{model:t.form,rules:t.formRules,"label-position":"top"}},[a("el-form-item",{attrs:{label:"商户ID",prop:"id"}},[a("el-input",{attrs:{type:"text",disabled:""},model:{value:t.form.id,callback:function(e){t.$set(t.form,"id",e)},expression:"form.id"}})],1),a("el-form-item",{attrs:{label:"绑定邮箱",prop:"email"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入邮箱"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),"admin"===t._project?a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"text",placeholder:"为空不修改"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1):t._e(),a("el-form-item",{attrs:{label:"商户名称",prop:"name"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入商户名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"商户QQ",prop:"qq"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入商户联系QQ"},model:{value:t.form.qq,callback:function(e){t.$set(t.form,"qq",e)},expression:"form.qq"}})],1),a("el-form-item",{attrs:{label:"店铺名称",prop:"shop_name"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入店铺名称"},model:{value:t.form.shop_name,callback:function(e){t.$set(t.form,"shop_name",e)},expression:"form.shop_name"}})],1),a("el-form-item",{attrs:{label:"店铺主题",prop:"shop_theme"}},[a("el-select",{staticClass:"theme-select",attrs:{filterable:""},on:{change:function(e){t.form.shop_theme=t.theme.name}},model:{value:t.theme,callback:function(e){t.theme=e},expression:"theme"}},t._l(t.themes,(function(t){return a("el-option",{key:"theme_"+t.id,attrs:{label:t.name+" - "+t.description,value:t}})})),1)],1),t.theme&&t.theme.options&&Object.keys(t.theme.options).length?a("el-card",{staticClass:"child-option"},[a("p",{staticClass:"child-option-title"},[t._v("主题配置")]),a("el-button",{staticClass:"btn-default",attrs:{size:"mini",type:"text"},on:{click:t.restoreThemeDefaultConfig}},[t._v(" 恢复默认 ")]),t._l(t.theme.options,(function(e,i){return a("el-form-item",{key:"theme_option_"+i,staticClass:"item-container"},["checkbox"!==e.type?a("span",{staticStyle:{display:"block"}},[t._v(t._s(e.label))]):t._e(),"text"===e.type?a("el-input",{attrs:{type:e.inputType||"text",maxlength:e.size,placeholder:e.placeholder||""},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"option.value"}}):t._e(),"textarea"===e.type?a("el-input",{attrs:{type:"textarea",maxlength:e.size,rows:e.rows,placeholder:e.placeholder||""},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"option.value"}}):t._e(),"checkbox"===e.type?a("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"option.value"}},[t._v(" "+t._s(e.label)+" ")]):t._e(),"select"===e.type?a("el-select",{attrs:{filterable:""},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"option.value"}},t._l(e.values,(function(t,e){return a("el-option",{key:"theme_option_"+i+"_"+e,attrs:{value:e,label:t.label}})})),1):t._e(),"radio"===e.type?a("el-radio-group",{model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"option.value"}},t._l(e.values,(function(e,n){return a("el-radio",{key:"theme_option_"+i+"_"+n,attrs:{label:n}},[t._v(t._s(e.label)+" ")])})),1):t._e()],1)}))],2):t._e(),a("el-form-item",{attrs:{label:"店铺公告",prop:"shop_ann"}},[a("quill-editor",{ref:"editor-shop_ann",attrs:{placeholder:"本说明将显示在商户首页"}})],1),a("el-form-item",{attrs:{label:"首页弹窗",prop:"shop_ann_pop"}},[a("quill-editor",{ref:"editor-shop_ann_pop",attrs:{placeholder:"本说明将在商户首页弹窗"}})],1),a("el-form-item",{attrs:{label:"库存显示"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.form.shop_inventory,callback:function(e){t.$set(t.form,"shop_inventory",e)},expression:"form.shop_inventory"}},[a("el-radio-button",{attrs:{label:t.INVENTORY_TYPE.RANGE}},[t._v("大致范围")]),a("el-radio-button",{attrs:{label:t.INVENTORY_TYPE.REAL}},[t._v("实际库存")])],1)],1),a("el-form-item",{attrs:{label:"手续费"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.form.fee_type,callback:function(e){t.$set(t.form,"fee_type",e)},expression:"form.fee_type"}},[a("el-radio-button",{attrs:{label:0}},[t._v("卖家承担")]),a("el-radio-button",{attrs:{label:1}},[t._v("买家承担")])],1)],1),a("el-form-item",{staticStyle:{"margin-top":"36px"}},[a("el-button",{style:{float:t.isMobile?"right":""},attrs:{type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v("保存信息 ")])],1)],1)],1)}),[],!1,null,"7c94ce82",null)).exports,le={TYPE_PREFIX:0,TYPE_SUFFIX:1},ce={TYPE_SHOP:0,TYPE_CATEGORY:1,TYPE_PRODUCT:2,get:function(t){return t===this.TYPE_SHOP?"店铺链接":t===this.TYPE_CATEGORY?"分类链接":t===this.TYPE_PRODUCT?"商品链接":"未知"}},de={WAITING:{id:1,name:"待审核",type:"info"},DENIED:{id:3,name:"已拒绝",type:"warning"},SUCCESS:{id:4,name:"已开通",type:"success"},get:function(t){for(var e in this)if(this.hasOwnProperty(e)&&this[e].id===t)return this[e];return{id:t,type:"danger",name:"未知状态"}}};var ue=a("2753"),fe=a("606a"),pe={props:{userInfo:{},type:{},info:{}},data:function(){var t=this;return{loading:!1,labelWidth:this.$store.state.app.isMobile?"50px":"90px",USER_DOMAIN_TYPE:ce,DOMAIN_TYPE:le,categories:[],products:[],canShowCategory:!0,canShowProduct:!0,systemDomains:[{id:-1,domain:"加载中"}],form:{type:null,category_id:null,product_id:null,domain_id:null},formRules:{type:{required:!0,message:"请选择链接类型",trigger:"blur"},domain_id:[{required:!0,validator:function(t,e,a){e<1?a(new Error("请选择域名")):a()},trigger:"blur"}],code:[{min:3,max:32,message:"长度在 3 到 32 个字符",trigger:"blur"},{required:!0,validator:function(e,a,i){t.inputCodeValid=!1,/^[a-zA-Z0-9-]+$/.test(a)?/^-.+$/.test(a)?i(new Error('首字符不能为"-"')):/^.+-$/.test(a)?i(new Error('末字符不能为"-"')):(t.inputCodeValid=!0,i()):i(new Error('只能输入"数字 字母 -"'))},trigger:"blur"}]},inputCodeValid:!1,chooseSystemDomain:null}},computed:{domainsPrefix:function(){return this.systemDomains.filter((function(t){return t.type===le.TYPE_PREFIX}))},domainsSuffix:function(){return this.systemDomains.filter((function(t){return t.type===le.TYPE_SUFFIX}))}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){var t=this;void 0!==this.type&&null!==this.type&&(this.form.type=this.type,this.canShowCategory=!1,this.canShowProduct=!1,this.type===ce.TYPE_CATEGORY?this.form.category_id=this.info.id:this.type===ce.TYPE_PRODUCT&&(this.form.product_id=this.info.id)),function(t){return Object(T.a)({url:"domain/system",method:"get",params:t})}().then((function(e){t.systemDomains=e.data}))},methods:{getCategoryOrProductId:function(){this.type===ce.TYPE_CATEGORY?this.form.category_id=this.info.id:this.type===ce.TYPE_PRODUCT&&(this.form.product_id=this.info.id)},getCategories:function(){var t=this;this.categories=[];var e={search:"simple",val:"list"};this.userInfo&&(e.user_id=this.userInfo.id),Object(ue.d)(e).then((function(e){t.categories=e.data}))},getProducts:function(t){var e=this;if(this.category_id_old!==t){this.category_id_old=t,this.products=[];var a={search:"simple",val:t};this.userInfo&&(a.user_id=this.userInfo.id),Object(fe.h)(a).then((function(t){e.products=t.data}))}},handleTypeChange:function(t){t!==ce.TYPE_CATEGORY&&t!==ce.TYPE_PRODUCT||this.getCategories()},handleSystemDomainChange:function(t){var e=this;this.systemDomains.forEach((function(a){a.id===t&&(e.chooseSystemDomain=a)}))},getDomainPreview:function(){var t="",e=this.chooseSystemDomain.domain;if(this.chooseSystemDomain.type===le.TYPE_PREFIX)e=e.replace("http://","").replace("https://",""),t=this.form.code+"."+e;else{if(this.chooseSystemDomain.type!==le.TYPE_SUFFIX)return"未知域名:"+JSON.stringify(this.chooseSystemDomain);t=e+"/s/"+this.form.code}return t.startsWith("http://")||t.startsWith("https://")||(t="http://"+t),t},onSubmit:function(){var t=this;this.$refs.form.validate((function(e){e&&(t.loading=!0,t.userInfo&&(t.form.user_id=t.userInfo.id),t.getCategoryOrProductId(),function(t){return Object(T.a)({url:"domain/user/apply",method:"post",data:t})}(t.form).then((function(e){t.$notify({title:"提示",message:e.data.msg,type:e.data.type,duration:3e3}),t.loading=!1,t.$emit("submit")})).catch((function(){t.loading=!1})))}))}}},he=(a("f1b1"),Object(l.a)(pe,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h3",{staticStyle:{margin:"4px 0 28px 0"}},[t._v("申请链接")]),a("el-form",{ref:"form",staticStyle:{"margin-top":"12px"},attrs:{model:t.form,"label-width":t.labelWidth,rules:t.formRules}},[a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-select",{on:{change:t.handleTypeChange},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[a("el-option",{attrs:{value:t.USER_DOMAIN_TYPE.TYPE_SHOP,label:"店铺链接"}}),a("el-option",{attrs:{value:t.USER_DOMAIN_TYPE.TYPE_CATEGORY,label:"分类链接"}}),a("el-option",{attrs:{value:t.USER_DOMAIN_TYPE.TYPE_PRODUCT,label:"商品链接"}})],1)],1),!t.canShowCategory||t.form.type!==t.USER_DOMAIN_TYPE.TYPE_CATEGORY&&t.form.type!==t.USER_DOMAIN_TYPE.TYPE_PRODUCT?t._e():a("el-form-item",{attrs:{label:"分类",prop:"category_id",rules:{required:!0,message:"请选择商品分类",trigger:"blur"}}},[a("el-select",{attrs:{filterable:"","no-data-text":"无分类数据"},on:{change:t.getProducts},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1)],1),t.canShowProduct&&t.form.type===t.USER_DOMAIN_TYPE.TYPE_PRODUCT?a("el-form-item",{attrs:{label:"商品",prop:"product_id",rules:{required:!0,message:"请选择商品",trigger:"blur"}}},[t.form.type===t.USER_DOMAIN_TYPE.TYPE_PRODUCT?a("el-select",{attrs:{filterable:""},model:{value:t.form.product_id,callback:function(e){t.$set(t.form,"product_id",e)},expression:"form.product_id"}},t._l(t.products,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1):t._e()],1):t._e(),a("el-form-item",{attrs:{label:"域名",prop:"domain_id"}},[a("el-select",{on:{change:t.handleSystemDomainChange},model:{value:t.form.domain_id,callback:function(e){t.$set(t.form,"domain_id",e)},expression:"form.domain_id"}},[a("el-option-group",{attrs:{label:"二级域名"}},t._l(t.domainsPrefix,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.domain}})})),1),a("el-option-group",{attrs:{label:"后缀形式"}},t._l(t.domainsSuffix,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.domain}})})),1)],1)],1),a("el-form-item",{attrs:{label:"链接",prop:"code"}},[a("el-input",{staticStyle:{"max-width":"195px"},attrs:{type:"text",placeholder:"请输入自定义信息"},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}}),t.form.domain_id>0&&t.inputCodeValid&&t.form.code&&t.form.code.length>=3&&t.form.code.length<=32?a("span",{staticClass:"domain-preview"},[t._v("链接预览: "+t._s(t.getDomainPreview()))]):t._e()],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.loading,disabled:t.loading||!t.inputCodeValid},on:{click:t.onSubmit}},[t._v("提交申请 ")])],1)],1)],1)}),[],!1,null,"0933b380",null)).exports,me={props:{info:{}},data:function(){return{loading:!1,visible:!0,labelWidth:this.$store.state.app.isMobile?"50px":"90px",USER_DOMAIN_STATUS:de,form:{id:0,status:null},formRules:{status:[{required:!0,message:"请选择处理结果",trigger:"blur"}]}}},watch:{visible:function(t){t||this.$emit("close",{ret:!1})}},mounted:function(){this.form.id=this.info.id,this.form.status=this.info.status},methods:{handleSubmit:function(){var t=this;this.$refs.form.validate((function(e){e&&(t.loading=!0,function(t,e){return Object(T.a)({url:"domain/user/handle",method:"post",data:{ids:t,status:e}})}(t.form.id,t.form.status).then((function(e){t.loading=!1,t.$notify({title:"提示",message:e.data&&e.data.length?e.data:"处理审核成功",type:t.form.status===de.SUCCESS.id?"success":"info",duration:3e3}),t.handleClose(!0,t.form.status)})).catch((function(){t.loading=!1})))}))},handleClose:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.$emit("close",{ret:t,status:e}),this.visible=!1}}},_e=Object(l.a)(me,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"链接审核",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.formRules,"label-width":t.labelWidth}},[a("el-form-item",{attrs:{label:"结果",prop:"status"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("el-radio-button",{attrs:{label:t.USER_DOMAIN_STATUS.SUCCESS.id}},[t._v("通过")]),a("el-radio-button",{staticClass:"el-radio-gray",attrs:{label:t.USER_DOMAIN_STATUS.DENIED.id}},[t._v("拒绝")])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){return t.handleClose(!1)}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("确认")])],1)],1)}),[],!1,null,null,null).exports,ge={props:{userInfo:{type:Object,default:null},filterType:{default:null},_project:{default:"merchant"}},components:{domainApply:he,domainEdit:_e},data:function(){return{config:window.config,loading:!1,showApplyBox:!1,applyBoxLoaded:!1,USER_DOMAIN_TYPE:ce,USER_DOMAIN_STATUS:de,list:[],where:{},editInfo:null}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.getList()},methods:{handleShowApply:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.applyBoxLoaded=!0,t.next=3,this.$nextTick();case 3:this.showApplyBox=!0;case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),onDomainApply:function(){this.getList(),this.showApplyBox=!1},handleApplyShort:function(t){var e=this;this.loading=!0,t.short="申请中",function(t){return Object(T.a)({url:"domain/user/short",method:"post",data:{id:t}})}(t.id).then((function(a){t.short=a.data,e.loading=!1})).catch((function(){t.short=null,e.loading=!1}))},getList:function(){var t=this;this.loading=!0,this.userInfo&&(this.where.user_id=this.userInfo.id),this.list=[],function(t){return Object(T.a)({url:"domain/user/list",method:"get",params:t})}(this.where).then((function(e){t.list=e.data,t.loading=!1}))},handleCopySuccess:function(){this.$notify({title:null,message:"已复制",type:"success",duration:2e3})},handleCopyError:function(){this.$notify({title:null,message:"复制失败，请手动复制",type:"error",duration:2e3})},handleEdit:function(t){this.editInfo=t},onEditClose:function(t){t.ret&&(this.editInfo.status=t.status),this.editInfo=null},handleDelete:function(t){var e=this,a=t.url;this.$confirm("删除链接<"+a+">? 此操作不可恢复","提示",{type:"warning"}).then((function(){e.loading=!0,function(t){return Object(T.a)({url:"domain/user/delete",method:"post",data:{ids:t}})}(t.id).then((function(){e.$notify({title:"操作成功",message:"链接<"+a+">已删除",type:"info"}),e.getList()})).catch((function(){e.loading=!1}))}))}}},be=(a("e29d"),Object(l.a)(ge,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",class:{"app-container":!t.userInfo}},[a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showApplyBox,expression:"showApplyBox"}],staticClass:"apply-box"},[a("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",type:"danger",size:"small"},on:{click:function(e){t.showApplyBox=!1}}}),t.showApplyBox||t.applyBoxLoaded?a("el-card",{staticClass:"my-card"},[a("domain-apply",{attrs:{userInfo:t.userInfo},on:{submit:t.onDomainApply}})],1):t._e()],1)]),a("div",[a("div",{staticStyle:{float:"right"}},[a("el-button",{staticClass:"icon-btn",attrs:{type:"text",icon:"el-icon-refresh"},on:{click:t.getList}},[t._v("刷新")]),a("el-button",{staticClass:"icon-btn",attrs:{type:"text",icon:"el-icon-plus"},on:{click:t.handleShowApply}},[t._v("申请链接")])],1),a("h3",{staticStyle:{"margin-bottom":"16px"},style:{"margin-top":t.userInfo?"23px":"4px"}},[t._v("店铺链接")])]),a("div",[t._l(t.list,(function(e){return a("el-card",{key:e.id,staticClass:"my-card my-domain"},[e.is_default?t._e():a("el-button",{staticClass:"icon-btn delete",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return t.handleDelete(e)}}},[t._v("删除 ")]),e.is_default||"admin"!==t._project?t._e():a("el-button",{staticClass:"icon-btn edit",attrs:{type:"text",icon:"el-icon-document-checked"},on:{click:function(a){return t.handleEdit(e)}}},[t._v("审核 ")]),e.is_default?a("span",{staticClass:"info"},[t._v("类型： "),a("span",[t._v("店铺链接")]),a("el-tag",[t._v("默认链接")])],1):a("span",{staticClass:"info"},[t._v("类型： "),a("span",[t._v(t._s(t.USER_DOMAIN_TYPE.get(e.type)))]),a("el-tag",{attrs:{type:t.USER_DOMAIN_STATUS.get(e.status).type}},[t._v(" "+t._s(t.USER_DOMAIN_STATUS.get(e.status).name)+" ")])],1),e.type===t.USER_DOMAIN_TYPE.TYPE_CATEGORY||e.type===t.USER_DOMAIN_TYPE.TYPE_PRODUCT?a("span",{staticClass:"info"},[t._v("分类： "),a("span",[t._v(t._s(e.category?e.category.name:"分类#"+e.category_id))])]):t._e(),e.type===t.USER_DOMAIN_TYPE.TYPE_PRODUCT?a("span",{staticClass:"info"},[t._v("商品： "),a("span",[t._v(t._s(e.product?e.product.name:"商品#"+e.product_id))])]):t._e(),a("span",{staticClass:"info domain-preview"},[t._v("链接： "),a("a",{attrs:{target:"_blank",href:e.url}},[t._v(t._s(e.url))]),a("a",{directives:[{name:"clipboard",rawName:"v-clipboard",value:e.url,expression:"item.url"}],staticClass:"btn",on:{success:t.handleCopySuccess,error:t.handleCopyError}},[t._v("复制")]),e.is_default?t._e():[e.short?a("a",{staticClass:"btn",on:{click:function(a){return t.handleApplyShort(e)}}},[t._v("重新缩短")]):a("a",{staticClass:"btn",on:{click:function(a){return t.handleApplyShort(e)}}},[t._v("缩短")])]],2),e.short&&e.short.length?a("span",{staticClass:"info domain-preview"},[t._v("短链： "),a("a",{attrs:{target:"_blank",href:e.short}},[t._v(t._s(e.short))]),a("a",{directives:[{name:"clipboard",rawName:"v-clipboard",value:e.short,expression:"item.short"}],staticClass:"btn",on:{success:t.handleCopySuccess,error:t.handleCopyError}},[t._v("复制")])]):t._e(),e.short2&&e.short2.length?a("span",{staticClass:"info domain-preview"},[t._v("短链： "),a("a",{attrs:{target:"_blank",href:e.short2}},[t._v(t._s(e.short2))]),a("a",{directives:[{name:"clipboard",rawName:"v-clipboard",value:e.short2,expression:"item.short2"}],staticClass:"btn",on:{success:t.handleCopySuccess,error:t.handleCopyError}},[t._v("复制")])]):t._e()],1)})),0===t.list.length?a("el-card",{staticClass:"my-card my-domain"},[t._v(" "+t._s(t.loading?"加载中...":"暂无数据")+" ")]):t._e()],2),t.editInfo?a("domain-edit",{attrs:{info:t.editInfo},on:{close:t.onEditClose}}):t._e()],1)}),[],!1,null,"6b50ddea",null)).exports,ve={props:{inBox:{default:!1},userInfo:{},_project:{default:"merchant"}},data:function(){return{loading:!0,api_id:this.userInfo?this.userInfo.id:this.$store.state.user.userInfo.id,api_key:"****",notify_url:"",enabled:0}},mounted:function(){var t=this;(this.api_id,Object(T.a)({url:"apipay/config",method:"get"})).then((function(e){t.api_key_hide=e.data.api_key,t.notify_url=e.data.notify_url,t.enabled=e.data.enabled,t.loading=!1}))},methods:{loadApiKey:function(){this.api_key=this.api_key_hide},resetApiKey:function(){var t=this;this.$confirm("是否重置 [api_key] ?","提示",{type:"warning"}).then((function(){t.loading=!0,(t.api_id,Object(T.a)({url:"apipay/key/new",method:"post"})).then((function(e){t.api_key=e.data.api_key,t.$notify({title:"提示",message:"重置 [api_key] 成功",type:"success",duration:1e3})})).finally((function(){t.loading=!1}))}))},handleEditApi:function(){var t=this;(function(t,e){return Object(T.a)({url:"apipay/notify_url",method:"post",data:{notify_url:e}})})(this.api_id,this.notify_url).then((function(e){t.notify_url=e.data.notify_url,t.$notify({title:"提示",message:"设置 [回调URL] 成功",type:"success",duration:1e3})}))},handleEnableApiPay:function(t){var e=this;(this.api_id,!1).then((function(){e.enabled=t,t?e.$notify({title:"提示",message:"用户API支付功能已开启",type:"success",duration:1e3}):e.$notify({title:"提示",message:"用户API支付功能已关闭",type:"info",duration:1e3})}))}}},ye=(a("760d"),Object(l.a)(ve,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"app-container":!t.inBox}},[a("h3",{staticStyle:{margin:"4px 0 16px 0"}},[t._v("API")]),"merchant"!==t._project||t.enabled?t._e():a("el-alert",{staticStyle:{"margin-bottom":"14px"},attrs:{type:"error",title:"提示"}},[a("div",{staticStyle:{"font-size":"14px"}},[t._v(" 您没有API支付功能权限，请联系客服申请。 ")])]),"admin"===t._project?a("div",{staticStyle:{"margin-bottom":"12px"}},[a("el-switch",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"inactive-text":"开启API接入","active-value":1,"inactive-value":0},on:{change:t.handleEnableApiPay},model:{value:t.enabled,callback:function(e){t.enabled=e},expression:"enabled"}})],1):t._e(),a("el-card",{staticClass:"my-card"},[a("div",{staticClass:"api-key"},[a("p",[a("span",[t._v("api_id:")]),a("code",[t._v(t._s(t.api_id))])]),a("p",[a("span",[t._v("api_key:")]),a("code",[t._v(t._s(t.api_key))]),"****"===t.api_key?a("el-button",{staticClass:"api-a",attrs:{type:"text",size:"mini",disabled:t.loading},on:{click:t.loadApiKey}},[t._v("显示 ")]):t._e(),a("el-button",{staticClass:"api-a",attrs:{type:"text",size:"mini",disabled:t.loading},on:{click:t.resetApiKey}},[t._v("重置 ")])],1)])]),a("h3",{staticStyle:{margin:"4px 0 16px 0"}},[t._v("配置")]),a("el-card",{staticClass:"my-card"},[a("el-form",{staticClass:"api-config-form",attrs:{"label-position":"top"}},[a("el-form-item",{attrs:{label:"回调URL"}},[a("el-input",{attrs:{size:"small",type:"text",placeholder:"此处可不填，具体请参考文档介绍"},model:{value:t.notify_url,callback:function(e){t.notify_url=e},expression:"notify_url"}}),a("el-button",{attrs:{size:"small"},on:{click:t.handleEditApi}},[t._v("保存")])],1)],1)],1),a("a",{staticClass:"api-a",attrs:{href:"/docs/api",target:"_blank"}},[t._v("接入文档")])],1)}),[],!1,null,null,null)).exports,we={props:{userInfo:{type:Object,default:null},filterType:{default:null},_project:{default:"merchant"}},components:{ApiBox:ye},data:function(){return{isMobile:this.$store.state.app.isMobile,loading:!1,showApiBox:!1,ApiBoxLoaded:!1,search:{type:"name",value:""},where:{},list:[],checkedIds:"",enabledFilter:[{text:"开启",value:1,type:"primary"},{text:"关闭",value:0,type:"info"}]}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,null!==this.filterType&&(this.where.filterType=this.filterType),this.userInfo&&(this.where.user_id=this.userInfo.id),function(t){return Object(T.a)({url:"/pay",method:"get",params:t})}(this.where).then((function(e){t.list=e.data,t.loading=!1}))},handleSearch:function(){var t={search:this.search.type,val:this.search.value};Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.enabled?e.enabled=t.enabled.join(","):e.enabled=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},handleDisable:function(t){var e=this,a=t.name;this.$confirm("关闭支付方式<"+a+">?","提示",{type:"warning"}).then((function(){e.loading=!0,nt(e.userInfo?e.userInfo.id:null,t.id,0).then((function(){e.$notify({title:"操作成功",message:"支付方式<"+a+">已关闭",type:"info"}),t.enabled=0,e.loading=!1})).catch((function(){e.loading=!1}))}))},handleEnable:function(t){var e=this,a=t.name;this.$confirm("开启支付方式<"+a+">?","提示",{type:"warning"}).then((function(){e.loading=!0,nt(e.userInfo?e.userInfo.id:null,t.id,1).then((function(){e.$notify({title:"操作成功",message:"支付方式<"+a+">已开启",type:"success"}),t.enabled=1,e.loading=!1})).catch((function(){e.loading=!1}))}))},handleEditFee:function(t){var e=this;1*t.fee!==t.fee_old?(this.loading=!0,function(t,e,a){return Object(T.a)({url:"/pay/user/fee",method:"post",data:{user_id:t,pay_id:e,fee:a}})}(this.userInfo?this.userInfo.id:null,t.id,t.fee).then((function(){e.$notify({title:"操作成功",message:"已修改费率",type:"success"}),t.fee=1*t.fee,e.loading=!1})).catch((function(){t.fee=t.fee_old,e.loading=!1}))):t.fee=1*t.fee_old},handleSetDefaultFee:function(t){var e=this;(function(t,e){return Object(T.a)({url:"/pay/user/fee/default",method:"post",data:{user_id:t,pay_id:e}})})(this.userInfo?this.userInfo.id:null,t.id).then((function(a){e.$notify({title:"操作成功",message:"已修改费率",type:"success"}),t.fee=a.data,e.loading=!1})).catch((function(){e.loading=!1}))},handleShowApiBox:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.ApiBoxLoaded=!0,t.next=3,this.$nextTick();case 3:this.showApiBox=!0;case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}},Ce=Object(l.a)(we,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",class:{"app-container":!t.userInfo}},[a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showApiBox,expression:"showApiBox"}],staticClass:"apply-box"},[a("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",type:"danger",size:"small"},on:{click:function(e){t.showApiBox=!1}}}),t.showApiBox||t.ApiBoxLoaded?a("el-card",{staticClass:"my-card"},[a("api-box",{attrs:{"in-box":!0,userInfo:t.userInfo},on:{changeTab:function(e){return t.$emit("changeTab",e)}}})],1):t._e()],1)]),a("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[a("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[a("el-form-item",{staticClass:"mobile-full-width"},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[a("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[a("el-option",{attrs:{label:"名称",value:"name"}})],1)],1)],1),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),"admin"===t._project?a("el-form-item",{staticClass:"right-toolbox"},["admin"===t._project?a("el-link",{on:{click:t.handleShowApiBox}},[a("icon",{attrs:{name:"code"}}),t._v(" ApiKey")],1):t._e()],1):t._e()],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map((function(t){return t.id})).join(",")}}},["admin"===t._project?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}):t._e(),a("el-table-column",{attrs:{prop:"name",label:"支付方式","min-width":"100"}}),"admin"===t._project?a("el-table-column",{attrs:{prop:"fee",label:"商户费率","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",["string"==typeof e.row.fee?a("input",{directives:[{name:"model",rawName:"v-model",value:e.row.fee,expression:"scope.row.fee"}],staticClass:"table-input",attrs:{size:"small",title:"商户费率"},domProps:{value:e.row.fee},on:{blur:function(a){return t.handleEditFee(e.row)},keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.handleEditFee(e.row)},input:function(a){a.target.composing||t.$set(e.row,"fee",a.target.value)}}}):t._e(),a("a",{directives:[{name:"show",rawName:"v-show",value:"string"==typeof e.row.fee,expression:"typeof(scope.row.fee) === 'string'"}],staticStyle:{"text-decoration":"underline"},on:{click:function(a){return t.handleSetDefaultFee(e.row)}}},[t._v("默认")]),"number"==typeof e.row.fee?a("a",{staticClass:"line-btn",on:{click:function(){e.row.fee_old=e.row.fee,e.row.fee=e.row.fee+""}}},[t._v(t._s((100*e.row.fee).toFixed(2))+"%")]):t._e()])]}}],null,!1,2236053190)}):t._e(),"admin"!==t._project?a("el-table-column",{attrs:{prop:"fee",label:"商户费率","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s((100*e.row.fee).toFixed(2))+"% ")]}}],null,!1,2021402772)}):t._e(),a("el-table-column",{attrs:{prop:"enabled",label:"状态",width:"80","column-key":"enabled",filters:t.enabledFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:e.row.enabled?"primary":"info"}},[t._v(" "+t._s(e.row.enabled?"开启":"关闭")+" ")])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"50",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.enabled?a("a",{staticClass:"icon-btn",on:{click:function(a){return t.handleDisable(e.row)}}},[t._v("关闭")]):a("a",{staticClass:"icon-btn",on:{click:function(a){return t.handleEnable(e.row)}}},[t._v("开启")])]}}])})],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?a("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.list.per_page,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1)],1)}),[],!1,null,null,null).exports,xe={FROM_CUSTOMER:1,FROM_MERCHANT:2,FROM_ADMIN:3,FROM_SYSTEM:4,get:function(t){switch(t){case 1:return"买家";case 2:return"商家";case 3:return"管理员";case 4:return"系统消息"}return"未知"}},ke={STATUS_UN:{id:0,name:"投诉待处理",type:"primary"},STATUS_ING:{id:1,name:"投诉处理中",type:"primary"},STATUS_APPROVE:{id:2,name:"已退款",type:"warning"},STATUS_DENIED:{id:3,name:"买家败诉",type:"success"},STATUS_CANCEL:{id:4,name:"投诉已撤销",type:"info"},get:function(t){for(var e in this)if(this.hasOwnProperty(e)&&this[e].id===t)return this[e];return{id:t,type:"danger",name:"未知状态"}}};function Ie(t){return Object(T.a)({url:"complaint/reply",method:"post",data:t})}var Ae={props:{message:{default:{from:1,message:"",created_at:"",file_urls:""}}},data:function(){var t;t=1===this.message.from?["customer","买家"]:2===this.message.from?["merchant","商家"]:3===this.message.from?["admin","管理员"]:4===this.message.from?["admin","系统消息"]:["未知","customer"];var e=[],a=JSON.parse(this.message.file_urls);return a&&a.forEach((function(t){e.push({load:!1,url:t})})),{FROM_CUSTOMER:1,FROM_MERCHANT:2,FROM_ADMIN:3,FROM_SYSTEM:4,fromInfo:t,files:e,currentAttach:null}},mounted:function(){},methods:{renderTitle:function(){return 1===this.message.from?"<span>".concat(this.fromInfo[1],"</span>").concat(this.message.created_at):"".concat(this.message.created_at,"<span>").concat(this.fromInfo[1],"</span>")},isImage:function(t){var e=t.split("."),a=e.length>1?e[e.length-1]:"";return["jpg","jpeg","bmp","png","gif"].indexOf(a)>-1},handleImgClick:function(t){t.isCurrent=!t.isCurrent,t.isCurrent?(this.currentAttach!==t.isCurrent&&this.currentAttach&&(this.currentAttach.isCurrent=!1),this.currentAttach=t):this.currentAttach=null}}},Se=(a("1166"),Object(l.a)(Ae,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"report_message",class:t.message.from===t.FROM_CUSTOMER?"left_msg":"right_msg"},[a("div",{class:t.fromInfo[0],domProps:{innerHTML:t._s(t.renderTitle())}}),a("span",{staticClass:"msg_text"},[t._v(t._s(t.message.message))]),a("div",{staticClass:"report_attach",staticStyle:{position:"relative"}},[t._l(t.files,(function(e){return a("div",{key:e.url,staticClass:"attach_item",class:{current:e.isCurrent}},[t.isImage(e.url)?a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:1,expression:"1 || item.load"}],staticClass:"current-border"},[a("img",{staticClass:"attach-img",attrs:{src:e.url},on:{load:function(t){e.load=!0},click:function(a){return t.handleImgClick(e)}}})]),a("div",{staticClass:"arrow-down"})]):a("div",{staticStyle:{"margin-right":"14px"}},[a("a",{attrs:{href:e.url,target:"_blank"}},[t._v(t._s(e.url))])])])})),null!=t.currentAttach?a("div",{staticClass:"preview"},[a("div",{staticClass:"clearfix operations"},[a("span",{staticClass:"pull-right"},[a("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.handleImgClick(t.currentAttach)}}},[a("span",[a("icon",{staticStyle:{"font-size":"17px","line-height":"17px","vertical-align":"middle"},attrs:{name:"angle-up"}}),t._v("收起")],1)]),a("a",{attrs:{href:t.currentAttach.url,target:"_blank"}},[a("span",[t._v("大图")])])])]),a("img",{staticClass:"previewImage",attrs:{src:t.currentAttach.url}})]):t._e()],2)])}),[],!1,null,null,null)).exports,Oe=(a("a434"),a("e016"));function Ee(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}var Te={props:{property:{default:"id"},value:{},appendHeaders:{},file:{},errorText:{default:""},label:{default:"上传文件"},multiple:{default:!1}},data:function(){return{isMobile:Oe.a.isMobile(),uploading:!1,fileInfoArr:[],imgViewUrl:"",progress:0,imgTop:this.label||this.multiple?"40px":"4px"}},mounted:function(){this.imgViewUrl=null,this.$emit("input",this.multiple?[]:0),this.file&&(this.file.constructor===Array?this.fileInfoArr=this.file:this.fileInfoArr=[this.file])},methods:{handleClick:function(){this.$emit("onInput"),this.$refs.file.click()},update:function(t){var e=this,a=t.target.files[0];if(a){var i=new FormData;if(i.append("file",a,a.name),this.appendHeaders)for(var n in this.appendHeaders)this.appendHeaders.hasOwnProperty(n)&&i.append(n,this.appendHeaders[n]);var o={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(t){e.progress=t.loaded/t.total*100|0}};this.progress=0,this.uploading=!0,this.multiple||(this.fileInfoArr=[]),this.$http.post("complaint/upload",i,o).then((function(t){e.uploading=!1,e.fileInfoArr.push(function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?Ee(Object(a),!0).forEach((function(e){Object(r.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Ee(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({rawName:a.name},t.data));var i=e.fileInfoArr.map((function(t){return t[e.property]}));e.multiple?e.$emit("input",i):e.$emit("input",e.fileInfoArr[0][e.property]),e.$emit("success",t.data)})).catch((function(t){e.uploading=!1,e.$emit("input",e.multiple?[]:0),e.$emit("error",t)}))}},handleImgOpen:function(t){window.open(null==t?this.imgViewUrl:t.url,"_blank")},handleImgOver:function(t){t&&!this.isMobile&&(this.imgViewUrl=t.url)},handleImgLeave:function(){this.imgViewUrl=null},handleDelete:function(t){this.imgViewUrl=null;for(var e=0;e<this.fileInfoArr.length;e++)if(this.fileInfoArr[e].url===t.url){this.fileInfoArr.splice(e,1);break}this.$emit("input",this.multiple?[]:0)}}},je={props:{info:{},_project:{default:"merchant"}},components:{upload:(a("4dc7"),Object(l.a)(Te,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"upload"},[t.label?a("div",{staticClass:"label"},[t._v(t._s(t.label))]):t._e(),a("el-button",{style:{backgroundImage:t.uploading?"linear-gradient(to right,#409eff 0%,#409eff "+t.progress+"%,rgba(238, 238, 238, 0.2) "+t.progress+"%,rgba(238, 238, 238, 0.2) 100%)":"none"},attrs:{loading:t.uploading,disabled:t.uploading,size:"small",icon:"el-icon-picture-outline"},on:{click:t.handleClick}},[t._v(" "+t._s(t.uploading?"正在上传":"上传图片")+" ")]),t.uploading?t._e():a("input",{ref:"file",staticClass:"input",attrs:{name:"file",type:"file",accept:"image/png,image/gif,image/jpeg"},on:{change:t.update}}),t.multiple?a("div",{staticStyle:{height:"1px","margin-top":"4px"}}):t._e(),t._l(t.fileInfoArr,(function(e){return a("div",{key:e.rawName||e.name||e.id||e.url,staticClass:"file-name",on:{mouseover:function(a){return t.handleImgOver(e)},mouseleave:t.handleImgLeave}},[a("span",{staticClass:"name",on:{click:function(a){return t.handleImgOpen(e)}}},[t._v(t._s(e.rawName||e.name||e.id||e.url))]),a("a",{on:{click:function(a){return t.handleDelete(e)}}},[t._v("删除")])])})),t.imgViewUrl?a("img",{style:{"margin-top":t.imgTop},attrs:{src:t.imgViewUrl},on:{click:function(e){return t.handleImgOpen(null)}}}):t._e(),t.errorText?a("div",{staticStyle:{color:"#f44336","font-size":"12px","line-height":"12px",margin:"4px 0 -16px"}},[t._v(t._s(t.errorText)+" ")]):t._e()],2)}),[],!1,null,"cd307e26",null)).exports},data:function(){return{FROM:xe,sending:!1,acting:!1,message:"",file_urls:[]}},methods:{handleClose:function(t){this.$emit("close",t)},handleDeny:function(){var t=this;this.$confirm("是否拒绝退款？","询问",{type:"warning"}).then((function(){t.acting=!0,function(t){return Object(T.a)({url:"complaint/deny",method:"post",data:{id:t}})}(t.info.id).then((function(){t.$emit("deny")})).finally((function(){t.acting=!1}))}))},handleApprove:function(){var t=this,e=!1,a=this.$createElement;this.$confirm(a("div",{key:Object(wt.c)()},[a("p",null,[a("p",null,"是否同意退款（支付金额 ￥"+((this.info.order?this.info.order.paid:0)/100).toFixed(2)+") ，此操作不可恢复"),this.info.order&&new Date(this.info.created_at).format("yyyy-MM-dd")!==new Date(this.info.order.paid_at).format("yyyy-MM-dd")?a("p",null,"此投诉非付款当日投诉，请谨慎操作！"):a("p",null,null),a("br",null,null)]),a("ElCheckbox",{props:{checked:e},on:{change:function(t){e=t}}},"自动请求支付渠道发起退款")]),"询问",{type:"warning",dangerouslyUseHTMLString:!0}).then((function(){t.acting=!0,function(t,e){return Object(T.a)({url:"complaint/approve",method:"post",data:{id:t,refund:e}})}(t.info.id,e).then((function(){t.$emit("approve")})).finally((function(){t.acting=!1}))}))},handleSendApproveMsg:function(){var t=this;this.acting=!0;var e="商户确认退款，正在等待平台处理";Ie({id:this.info.id,message:e}).then((function(){t.$emit("submit",{from:"admin"===t._project?xe.FROM_ADMIN:xe.FROM_MERCHANT,message:e,created_at:(new Date).format(),file_urls:JSON.stringify(t.file_urls)})})).finally((function(){t.acting=!1}))},handleSendMessage:function(){var t=this;if(this.message=this.message.trim(),this.message.length<1)return this.$alert("请填写补充信息");this.sending=!0;var e=JSON.stringify(this.file_urls);Ie({id:this.info.id,file_urls:e,message:this.message}).then((function(){t.$emit("submit",{from:"admin"===t._project?xe.FROM_ADMIN:xe.FROM_MERCHANT,file_urls:e,message:t.message,created_at:(new Date).format()})})).finally((function(){t.sending=!1}))}}},$e={props:{info:{},_project:{default:"merchant"}},components:{message:Se,sendMessage:(a("1a50"),Object(l.a)(je,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-input",{attrs:{type:"textarea",placeholder:"请输入你要回复的信息",autosize:{minRows:3,maxRows:15}},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}}),a("upload",{staticClass:"upload-right",staticStyle:{"margin-bottom":"8px"},attrs:{multiple:!0,property:"url",label:"","append-headers":{user_id:t.info.user_id}},model:{value:t.file_urls,callback:function(e){t.file_urls=e},expression:"file_urls"}}),a("div",{staticClass:"report-btn",staticStyle:{"margin-top":"-12px","text-align":"right"}},["admin"===t._project?a("el-button",{attrs:{loading:t.acting,disabled:t.acting,size:"small"},on:{click:t.handleDeny}},[t._v(" "+t._s(t.acting?"提交中":"拒绝退款")+" ")]):t._e(),"admin"===t._project?a("el-button",{attrs:{loading:t.acting,disabled:t.acting,size:"small"},on:{click:t.handleApprove}},[t._v(" "+t._s(t.acting?"提交中":"同意退款")+" ")]):t._e(),"merchant"===t._project?a("el-button",{attrs:{loading:t.acting,disabled:t.acting,size:"small"},on:{click:t.handleSendApproveMsg}},[t._v(" "+t._s(t.acting?"提交中":"同意退款")+" ")]):t._e(),a("el-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary",loading:t.sending,size:"small",disabled:t.sending},on:{click:t.handleSendMessage}},[t._v(" "+t._s(t.sending?"发送中":"回复信息")+" ")])],1)],1)}),[],!1,null,"229cdfe6",null)).exports},data:function(){return{loading:!1,visible:!0,labelWidth:this.$store.state.app.isMobile?"50px":"90px",COMPLAINT_STATUS:ke,form:{id:0,result:0},countdown:"",load_send:!0}},watch:{visible:function(t){t||this.$emit("close",!1)}},mounted:function(){var t=this;this.form.id=this.info.id,this.form.result=this.info.result;var e=function(){if(t.info){var e=new Date(t.info.created_at);e.setDate(e.getDate()+1);var a=e-new Date;if(a<=0)return clearInterval(t.countdown_interval),void(t.countdown=null);var i=parseInt(a/1e3/60/60/24,10),n=parseInt(a/1e3/60/60%24,10),r=parseInt(a/1e3/60%60,10),o=parseInt(a/1e3%60,10);t.countdown="".concat(i,"天").concat(n,"小时").concat(r,"分").concat(o,"秒")}else clearInterval(t.countdown_interval)};this.countdown_interval=setInterval(e,1e3),e()},methods:{handleShowOrder:function(){this.$emit("showOrder",this.info)},handleClose:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)},handleSendMessage:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.info){t.next=2;break}return t.abrupt("return");case 2:return this.info.messages?this.info.messages.push(e):this.info.messages=e,this.load_send=!1,t.next=6,this.$nextTick();case 6:this.load_send=!0;case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),handleDeny:function(){this.info&&(this.info.status=ke.STATUS_DENIED.id)},handleApprove:function(){this.info&&(this.info.status=ke.STATUS_APPROVE.id)}}},Pe=(a("9c88"),Object(l.a)($e,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"report-info-dialog",attrs:{title:"处理投诉",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[t.info?a("div",{staticStyle:{"margin-top":"-24px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.info.status===t.COMPLAINT_STATUS.STATUS_UN.id||t.info.status===t.COMPLAINT_STATUS.STATUS_ING.id,expression:"info.status === COMPLAINT_STATUS.STATUS_UN.id || info.status === COMPLAINT_STATUS.STATUS_ING.id"}],staticClass:"report-countdown"},[a("div",{staticClass:"countdown-icon"},[a("icon",{attrs:{name:"light/clock"}})],1),a("div",{staticClass:"countdown-title"},[a("strong",[t._v(t._s(t.countdown?"投诉处理剩余时间":"投诉处理时间已到"))]),a("br"),a("span",{staticClass:"countdown-time"},[t._v(t._s(t.countdown||"客服即将介入处理"))])]),a("div",{attrs:{id:"clear"}})]),a("table",{staticClass:"report-table",attrs:{width:"100%",border:"1",cellspacing:"0",cellpadding:"10"}},[a("tbody",[a("tr",[a("th",{attrs:{scope:"row"}},[t._v("付款时间")]),a("td",[t._v(t._s(t.info.order?t.info.order.paid_at:"(unknown)"))])]),a("tr",[a("th",{attrs:{scope:"row"}},[t._v("投诉时间")]),a("td",[t._v(t._s(t.info.created_at)+" "),"admin"===t._project&&t.info.order&&t.info.order.paid_at&&new Date(t.info.created_at).format("yyyy-MM-dd")!==new Date(t.info.order.paid_at).format("yyyy-MM-dd")?a("el-tag",{attrs:{type:"warning"}},[t._v(" 非当日投诉 ")]):t._e(),t.info.order&&!t.info.order.paid_at?a("el-tag",{attrs:{type:"warning"}},[t._v(" 未付款 ")]):t._e()],1)]),a("tr",[a("th",{attrs:{scope:"row"}},[t._v("投诉订单")]),a("td",[a("a",{staticStyle:{"text-decoration":"underline",cursor:"pointer"},on:{click:t.handleShowOrder}},[t._v(t._s(t.info.order_no))])])]),a("tr",[a("th",{attrs:{scope:"row"}},[t._v("联系方式")]),a("td",[t._v(t._s(t.info.order?t.info.order.contact:"未知")+" ")])]),a("tr",[a("th",{attrs:{scope:"row"}},[t._v("投诉ＱＱ")]),a("td",[a("a",{staticClass:"qq",attrs:{target:"_blank",href:"http://wpa.qq.com/msgrd?v=1&uin="+t.info.qq+"&site=fakaxitong.com&menu=yes"}},[t._v(t._s(t.info.qq)+" "),a("icon",{attrs:{name:"brands/qq"}})],1)])]),a("tr",[a("th",{attrs:{scope:"row"}},[t._v("投诉类别")]),a("td",[t._v(t._s(t.info.type?t.info.type.name:"未知"))])]),a("tr",[a("th",{attrs:{scope:"row"}},[t._v("处理状态")]),a("td",[t._v(t._s(t.COMPLAINT_STATUS.get(t.info.status).name))])])])]),t._l(t.info.messages,(function(t){return a("message",{key:t.id,attrs:{message:t}})}))],2):t._e(),t.load_send?a("send-message",{directives:[{name:"show",rawName:"v-show",value:t.info.status===t.COMPLAINT_STATUS.STATUS_UN.id||t.info.status===t.COMPLAINT_STATUS.STATUS_ING.id,expression:"info.status === COMPLAINT_STATUS.STATUS_UN.id || info.status === COMPLAINT_STATUS.STATUS_ING.id"}],attrs:{info:this.info},on:{submit:t.handleSendMessage,deny:t.handleDeny,approve:t.handleApprove,close:t.handleClose}}):t._e(),t.info.status===t.COMPLAINT_STATUS.STATUS_APPROVE.id?a("div",{staticClass:"text-center"},[t._v("投诉已退款")]):t._e(),t.info.status===t.COMPLAINT_STATUS.STATUS_DENIED.id?a("div",{staticClass:"text-center"},[t._v("投诉已拒绝")]):t._e(),t.info.status===t.COMPLAINT_STATUS.STATUS_CANCEL.id?a("div",{staticClass:"text-center"},[t._v("买家已取消投诉")]):t._e(),a("div",{staticClass:"dialog-footer",staticStyle:{"margin-top":"-24px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){return t.handleClose(!1)}}},[t._v("关闭")])],1)],1)}),[],!1,null,null,null)).exports,De={props:{orderInfo:{}},data:function(){var t=-1001===this.orderInfo.product_id;return{loading:!1,ORDER_STATUS:rt,ID_INNER_RETAIL:-1,FEE_TYPE_MERCHANT:0,FEE_TYPE_CUSTOMER:1,cardInfo:null,isApiOrder:t,identifier:"orderInfo_"+Math.random()}},watch:{loading:function(t){this.$emit("update:loading",t)}},mounted:function(){var t=this;this._on_show_card=function(){t.orderInfo&&t.$msgbox({title:"订单卡密信息",message:'<textarea rows="6" style="width: 100%" readonly>'+Object(wt.a)(t.orderInfo.card_orders.map((function(t){return t.card?t.card.card:"未知卡密#"+t.card_id})).join("\n"))+"</textarea>",dangerouslyUseHTMLString:!0})},window.bus.$on(this.identifier+":show:card",this._on_show_card),this._on_show_pay=function(){if(t.orderInfo){var e=t.orderInfo.pay?t.orderInfo.pay.name:"支付方式#"+t.orderInfo.pay_id,a="支付方式: "+e+"<br>支付时间: "+t.orderInfo.paid_at+"<br>"+e+"单号(流水号): "+Object(wt.a)(t.orderInfo.pay_trade_no);t.$msgbox({title:"支付信息",message:a,dangerouslyUseHTMLString:!0})}},window.bus.$on(this.identifier+":show:pay",this._on_show_pay),this._on_send_card=function(){if(t.orderInfo){if(!t.orderInfo.product)return t.$msgbox("订单对应商品不存在, 无法发货");(t.orderInfo.product&&t.orderInfo.product.delivery===fe.a.AUTO?t.$confirm("当前订单状态为<".concat(rt.get(t.orderInfo.status).name,">, 是否确认发货?"),"询问"):t.$prompt("当前订单状态为<".concat(rt.get(t.orderInfo.status).name,">, 是否确认发货?<br>请输入发货卡密"),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确认",cancelButtonText:"取消",inputPattern:/^[\s\S]{1,255}$/,inputErrorMessage:"需1-255字符以内",inputType:"text",closeOnClickModal:!1})).then((function(e){var a=e.value;t.loading=!0,st(t.orderInfo.id,a).then((function(e){Object.assign(t.orderInfo,e.data),t.$notify({title:"发货成功",message:"当前订单已发货成功",type:"success",duration:3e3})})).finally((function(){t.loading=!1}))}))}},window.bus.$on(this.identifier+":send:card",this._on_send_card),this._on_send_notify=function(){t.orderInfo&&(t.loading=!0,function(t){return Object(T.a)({url:"order/notify",method:"post",data:{id:t}})}(t.orderInfo.id).then((function(e){Object.assign(t.orderInfo.api_info,e.data.api_info),t.$msgbox({title:"重发结果",message:e.data.notify_html,dangerouslyUseHTMLString:!1})})).finally((function(){t.loading=!1})))},window.bus.$on(this.identifier+":send:notify",this._on_send_notify),this._on_refund_submit=function(){t.orderInfo&&t.$confirm("是否将退款提交至对应的支付渠道","询问",{type:"warning"}).then((function(){t.loading=!0,function(t){return Object(T.a)({url:"order/refund_submit",method:"post",data:{id:t}})}(t.orderInfo.id).then((function(e){Object.assign(t.orderInfo,e.data),t.$msgbox({title:"成功",message:"退款请求已经提交到支付渠道"})})).finally((function(){t.loading=!1}))}))},window.bus.$on(this.identifier+":refund:submit",this._on_refund_submit)},beforeDestroy:function(){window.bus.$off(this.identifier+":show:card",this._on_show_card),window.bus.$off(this.identifier+":show:pay",this._on_show_pay),window.bus.$off(this.identifier+":send:card",this._on_send_card),window.bus.$off(this.identifier+":send:notify",this._on_send_notify),window.bus.$off(this.identifier+":refund:submit",this._on_send_notify)},methods:{isShipped:function(t){return t.status===rt.SUCCESS.id||t.card_orders&&t.card_orders.length},isNotified:function(t){return t.api_info&&"success"===t.api_info.notify_ret},renderOrderSendStatus:function(t){return t.status===rt.UN_PAY.id?"":t.status===rt.PAID.id?t.send_status===ot.CARD_UN.id?"待发货":t.send_status===ot.CARD_PROCESSING.id?"正在处理":t.send_status===ot.CARD_SUCCESS.id?"已发货":t.send_status===ot.CARD_FAILED.id?"发货失败":"未发货":"UNKNOWN"}}},Re=(a("6bff"),Object(l.a)(De,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",{attrs:{border:"0",cellspacing:"0"}},[a("tbody",[a("tr",[a("td",{staticClass:"title"},[t._v("订单号")]),a("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t._v(t._s(t.orderInfo.order_no))])]),a("tr",[a("td",{staticClass:"title"},[t._v("商品名称")]),a("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t._v(t._s(t.isApiOrder?t.orderInfo.api_info.subject:t.orderInfo.product_name||(t.orderInfo.product?t.orderInfo.product.name:"未知#"+t.orderInfo.product_id))+" "),t.orderInfo.product&&t.orderInfo.product.retail_from_id?a("el-tag",{staticClass:"el-tag-label"},[t._v("分销商品")]):t._e()],1)]),a("tr",[a("td",{staticClass:"title"},[t._v("数量")]),a("td",{staticClass:"content-half"},[t._v(t._s(t.orderInfo.count))]),a("td",{staticClass:"title"},[t._v("商品售价")]),a("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.price))+"元")])]),a("tr",[a("td",{staticClass:"title"},[t._v("创建时间")]),a("td",{staticClass:"content-half"},[t._v(t._s(t.orderInfo.created_at))]),a("td",{staticClass:"title"},[t._v("优惠金额")]),a("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.discount))+"元")])]),a("tr",[a("td",{staticClass:"title"},[t._v("创建IP")]),a("td",{staticClass:"content-half"},[t._v(t._s(t.orderInfo.ip))]),a("td",{staticClass:"title"},[t._v("手续费")]),a("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.fee))+"元 "),t.orderInfo.fee_type===t.FEE_TYPE_CUSTOMER?a("span",{staticStyle:{"font-size":"12px"}},[t._v("(买家承担)")]):t._e()])]),a("tr",[a("td",{staticClass:"title"},[t._v("付款方式")]),a("td",{staticClass:"content-half"},[t._v(" "+t._s(t.orderInfo.pay?t.orderInfo.pay.name:t.orderInfo.pay_id===t.ID_INNER_RETAIL?"代理进货":"未知#"+t.orderInfo.pay_id)+" "),t.orderInfo.pay_id>0&&t.orderInfo.status>t.ORDER_STATUS.UN_PAY.id?a("a",{staticClass:"a-btn",attrs:{onclick:"bus.$emit('"+t.identifier+":show:pay')"}},[t._v("查看")]):t._e()]),a("td",{staticClass:"title"},[t._v(t._s(t.orderInfo.status>t.ORDER_STATUS.UN_PAY.id?"支付":"提交")+"金额")]),a("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.paid))+"元 "),t.orderInfo.sms_price?a("span",{staticStyle:{"font-size":"12px"}},[t._v("(短信费￥"+t._s((t.orderInfo.sms_price/100).toFixed(2))+")")]):t._e()])]),a("tr",[a("td",{staticClass:"title"},[t._v("付款时间")]),a("td",{staticClass:"content-half"},[t._v(t._s(t.orderInfo.paid_at))]),a("td",{staticClass:"title"},[t._v(t._s(t.orderInfo.product&&t.orderInfo.product.retail_from_id?"进货成本":"成本"))]),a("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.cost))+"元")])]),a("tr",[t.isApiOrder?t._e():a("td",{staticClass:"title"},[t._v("联系方式")]),t.isApiOrder?t._e():a("td",{staticClass:"content-half",staticStyle:{"word-wrap":"break-word","line-height":"1"}},[t._v(" "+t._s(t.orderInfo.contact)+" ")]),t.isApiOrder?a("td",{staticClass:"title"},[t._v("通知状态")]):t._e(),t.isApiOrder?a("td",{staticClass:"content-half",staticStyle:{"word-wrap":"break-word","line-height":"1"}},[t.orderInfo.status!==t.ORDER_STATUS.UN_PAY.id?a("div",[a("span",{class:"el-tag el-tag--"+(t.isNotified(t.orderInfo)?"success":"warning")},[t._v(" "+t._s(t.isNotified(t.orderInfo)?"已通知":"通知失败")+" ")]),t._v(" "),t.isNotified(t.orderInfo)?t._e():a("a",{staticClass:"a-btn",attrs:{onclick:"bus.$emit('"+t.identifier+":send:notify')"}},[t._v("重发通知")])]):a("div",[a("span")])]):t._e(),a("td",{staticClass:"title"},[t._v("入账")]),a("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.income))+"元")])]),a("tr",[a("td",{staticClass:"title"},[t._v("订单状态")]),a("td",{staticClass:"content-half"},[a("span",{class:"el-tag el-tag--"+t.ORDER_STATUS.get(t.orderInfo.status).type},[t._v(" "+t._s(t.ORDER_STATUS.get(t.orderInfo.status).name)+" ")]),t._v(" "),t.isApiOrder?t._e():a("div",{staticStyle:{display:"inline"}},[a("span",{class:t.isShipped(t.orderInfo)?"green-text":"amber-text"},[t._v(" "+t._s(t.isShipped(t.orderInfo)?"(已发货)":""+t.renderOrderSendStatus(t.orderInfo))+" ")]),t.isShipped(t.orderInfo)||t.orderInfo.status===t.ORDER_STATUS.UN_PAY.id?t._e():a("a",{staticClass:"a-btn",attrs:{onclick:"bus.$emit('"+t.identifier+":send:card')"}},[t._v("发货")]),t.isShipped(t.orderInfo)?a("a",{staticClass:"a-btn",attrs:{onclick:"bus.$emit('"+t.identifier+":show:card')"}},[t._v("查看")]):t._e()])]),a("td",{staticClass:"title"},[t._v("净利润")]),a("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.paid-t.orderInfo.sms_price-t.orderInfo.fee-t.orderInfo.cost))+"元 ")])]),t.orderInfo.pay_id!==t.ID_INNER_RETAIL&&t.orderInfo.status===t.ORDER_STATUS.REFUND.id?a("tr",[a("td",{staticClass:"title"},[t._v("退款提交")]),a("td",{class:t.orderInfo.refund_at?"content-half":"content-full"},[t._v(" "+t._s(t.orderInfo.refund_at||"无提交记录")+" "),t.orderInfo.refund_at?t._e():a("a",{staticClass:"a-btn",attrs:{onclick:"bus.$emit('"+t.identifier+":refund:submit')"}},[t._v("提交")])]),t.orderInfo.refund_at?a("td",{staticClass:"title"},[t._v("退款金额")]):t._e(),t.orderInfo.refund_at?a("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.refund))+"元")]):t._e()]):t._e(),t.isApiOrder?a("tr",[a("td",{staticClass:"title"},[t._v("通知地址")]),a("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t._v(t._s(t.orderInfo.api_info.notify_url))])]):t._e(),t.isApiOrder?a("tr",[a("td",{staticClass:"title"},[t._v("返回地址")]),a("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t._v(t._s(t.orderInfo.api_info.return_url))])]):t._e(),a("tr",[a("td",{staticClass:"title"},[t._v("备注")]),a("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t._v(t._s(t.orderInfo.remark))])]),a("tr",[a("td",{staticClass:"title"},[t._v("附加信息")]),a("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t.orderInfo.contact_ext&&"{}"!==t.orderInfo.contact_ext?a("div",[t._v(" "+t._s(t.orderInfo.contact_ext)+" ")]):t._e()])]),t.orderInfo.status===t.ORDER_STATUS.FROZEN.id?a("tr",[a("td",{staticClass:"title"},[t._v("冻结原因")]),a("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t._v(" "+t._s(t.orderInfo.frozen_reason||"无")+" ")])]):t._e()])])}),[],!1,null,null,null)).exports,Ue={props:{from:{type:String,default:""},info:{type:Object},_project:{default:"merchant"}},components:{InfoItem:Re},data:function(){return{loading:!1,loadingRetail:!1,ID_INNER_RETAIL:-1,orderInfo:null,orderVisible:!0,title:"",showOrders:[]}},mounted:function(){this.showOrder(this.info)},watch:{orderVisible:function(t){t||this.$emit("close")}},methods:{showOrder:function(t){this.orderInfo=t,"complaint"===this.from&&this.orderInfo.retail_chain&&this.orderInfo.retail_chain.length?this.showOrders=[this.orderInfo.retail_chain[0].id]:this.showOrders=[this.info.id];var e=-1001===this.orderInfo.product_id;this.title=e?"API订单信息":"订单信息"},getRetailChain:function(){var t=this;this.loadingRetail=!0,function(t){return Object(T.a)({url:"order/retail/chain",method:"get",params:{id:t}})}(this.orderInfo.id).then((function(e){t.showOrder(e.data)})).finally((function(){t.loadingRetail=!1}))}}},Me=(a("0394"),Object(l.a)(Ue,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"order-info-container",attrs:{title:t.title,visible:t.orderVisible,"close-on-click-modal":!0},on:{"update:visible":function(e){t.orderVisible=e}}},[t.orderInfo?a("div",{staticClass:"order-info-table"},["admin"===t._project&&(t.orderInfo.pay_id===t.ID_INNER_RETAIL||t.orderInfo.product&&t.orderInfo.product.retail_from_id&&!t.orderInfo.retail_chain)?a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingRetail,expression:"loadingRetail"}],staticClass:"icon-btn",staticStyle:{float:"right",margin:"-6px 0 0"},attrs:{type:"text",disabled:t.loadingRetail},on:{click:t.getRetailChain}},[t._v("加载分销订单 ")]):t._e(),t.orderInfo.retail_chain&&t.orderInfo.retail_chain.length?a("el-collapse",{ref:"orderChain",model:{value:t.showOrders,callback:function(e){t.showOrders=e},expression:"showOrders"}},[t._l(t.orderInfo.retail_chain,(function(e,i){return a("el-collapse-item",{key:e.order_no,attrs:{title:0===i?"供货订单":"分销订单",name:e.id}},[a("info-item",{attrs:{orderInfo:e,loading:t.loading},on:{"update:loading":function(e){t.loading=e}}})],1)})),a("el-collapse-item",{attrs:{title:"分销订单",name:t.orderInfo.id}},[a("info-item",{attrs:{orderInfo:t.orderInfo,loading:t.loading},on:{"update:loading":function(e){t.loading=e}}})],1)],2):a("info-item",{attrs:{orderInfo:t.orderInfo}})],1):t._e()])}),[],!1,null,null,null)).exports,Le={props:{userInfo:{type:Object,default:null},filterType:{default:null},_project:{default:"merchant"}},components:{ComplaintInfo:Pe,OrderInfo:Me},data:function(){return{isMobile:this.$store.state.app.isMobile,loading:!1,COMPLAINT_STATUS:ke,FROM:xe,search:{type:"order_no",value:""},where:{over24hours:0},list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",statusFilter:function(){var t=[];for(var e in ke)ke.hasOwnProperty(e)&&"object"===Object(F.a)(ke[e])&&t.push({text:ke[e].name,value:ke[e].id,type:ke[e].type});return t}(),statusFilterValue:[ke.STATUS_UN.id,ke.STATUS_ING.id],loadingInfo:!1,complaintInfo:null,orderInfo:null}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){"over24hours"===this.$route.query.filter&&(this.where.over24hours=1),this.where.status=this.statusFilterValue.join(","),this.handleSearch()},methods:{getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,null!==this.filterType&&(this.where.filterType=this.filterType),this.userInfo&&(this.where.user_id=this.userInfo.id),function(t){return Object(T.a)({url:"complaint",method:"get",params:t})}(this.where).then((function(e){t.list=e.data,t.loading=!1}))},handleSearch:function(){var t={search:this.search.type,val:this.search.value};Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.status?e.status=t.status.join(","):e.status=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},showOrder:function(t){var e=this;this.loadingInfo=!0,function(t){return Object(T.a)({url:"complaint/order",method:"post",data:{complaint_id:t}})}(t.id).then((function(t){e.loadingInfo=!1,e.orderInfo=t.data})).catch((function(){e.loadingInfo=!1}))},showMessage:function(t){this.handleIt(t)},handleIt:function(t){var e=this;this.loadingInfo=!0,function(t){return Object(T.a)({url:"complaint/info",method:"get",params:{id:t}})}(t.id).then((function(a){e.loadingInfo=!1,e.complaintInfo=t,e.complaintInfo.messages=a.data.messages})).catch((function(){e.loadingInfo=!1}))},onHandleClose:function(t){this.complaintInfo=null,t&&this.getList()}}},ze=Object(l.a)(Le,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",class:{"app-container":!t.userInfo}},[a("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[a("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[a("el-form-item",{staticClass:"mobile-full-width"},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[a("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[a("el-option",{attrs:{label:"ID",value:"id"}}),"admin"===t._project?a("el-option",{attrs:{label:"商户ID",value:"user_id"}}):t._e(),a("el-option",{attrs:{label:"订单号",value:"order_no"}}),a("el-option",{attrs:{label:"投诉QQ",value:"qq"}})],1)],1)],1),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),a("el-form-item",{staticClass:"mobile-full-width"},[a("el-switch",{attrs:{"inactive-text":"只显示超过24小时的投诉","active-value":1,"inactive-value":0},on:{change:t.handleSearch},model:{value:t.where.over24hours,callback:function(e){t.$set(t.where,"over24hours",e)},expression:"where.over24hours"}})],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map((function(t){return t.id})).join(",")}}},["admin"===t._project?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),"admin"!==t._project||t.userInfo?t._e():a("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"}}),a("el-table-column",{attrs:{prop:"order_no",label:"订单号",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"line-btn",staticStyle:{"text-decoration":"underline"},on:{click:function(a){return t.showOrder(e.row)}}},[t._v(t._s(e.row.order?e.row.order.order_no:"未知#"+e.row.order_id))])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"100","column-key":"status",filters:t.statusFilter,"filtered-value":t.statusFilterValue,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.COMPLAINT_STATUS.get(e.row.status).type}},[t._v(" "+t._s(t.COMPLAINT_STATUS.get(e.row.status).name)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"type",label:"投诉类型",width:"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.type?e.row.type.name:"未知#"+e.row.complaint_type_id)+" ")]}}])}),a("el-table-column",{attrs:{prop:"message",label:"投诉内容","min-width":"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"line-btn",on:{click:function(a){return t.showMessage(e.row)}}},[t._v(t._s(e.row.message?e.row.message.message:"无"))])]}}])}),a("el-table-column",{attrs:{prop:"contact",label:"联系方式","min-width":"160","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.order?e.row.order.contact:"未知#"+e.row.order_id)+" ")]}}])}),a("el-table-column",{attrs:{prop:"qq",label:"投诉QQ","min-width":"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"created_at",label:"投诉时间",width:"admin"===t._project?220:160},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.created_at)+" "),"admin"===t._project&&e.row.order&&e.row.order.paid_at&&new Date(e.row.created_at).format("yyyy-MM-dd")!==new Date(e.row.order.paid_at).format("yyyy-MM-dd")?a("el-tag",{attrs:{type:"warning"}},[t._v(" 非当日投诉 ")]):t._e(),"admin"===t._project&&e.row.order&&!e.row.order.paid_at?a("el-tag",{attrs:{type:"warning"}},[t._v(" 未付款 ")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"操作",width:"50",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"icon-btn",on:{click:function(a){return t.handleIt(e.row)}}},[t._v("处理")])]}}])})],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?a("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.list.per_page,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t.loadingInfo?a("div",{staticClass:"v-modal",staticStyle:{"z-index":"11010"}}):t._e(),t.loadingInfo?a("div",{staticClass:"el-message-box__wrapper",staticStyle:{"z-index":"11011"}},[t._m(0)]):t._e(),t.complaintInfo?a("complaint-info",{attrs:{info:t.complaintInfo},on:{close:t.onHandleClose,showOrder:t.showOrder}}):t._e(),t.orderInfo?a("order-info",{ref:"orderInfo",attrs:{from:"complaint",info:t.orderInfo},on:{close:function(e){t.orderInfo=null}}}):t._e()],1)}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{position:"relative",display:"inline-block",width:"250px","background-color":"#fff","border-radius":"4px",border:"1px solid #ebeef5"}},[a("p",[t._v("加载中...")])])}],!1,null,null,null).exports,Ne={props:{userInfo:{type:Object,default:null},filterType:{default:null},_project:{default:"merchant"}},data:function(){return{isMobile:this.$store.state.app.isMobile,loading:!1,loadingMessage:!1,search:{type:"title",value:""},where:{},list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",readFilter:[{text:"未读",value:0,type:"primary"},{text:"已读",value:1,type:"info"}],chooseInfo:null}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,null!==this.filterType&&(this.where.filterType=this.filterType),this.userInfo&&(this.where.user_id=this.userInfo.id),bt(this.where).then((function(e){t.list=e.data,t.loading=!1}))},handleSearch:function(){var t={search:this.search.type,val:this.search.value};Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.is_read?e.is_read=t.is_read.join(","):e.is_read=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},showMessage:function(t){var e=this;t.info_title?(this.$alert(Object(wt.d)(t.info_body),t.info_title,{dangerouslyUseHTMLString:!0,customClass:"ann-box"}),"merchant"===this._project&&(t.is_read=!0,yt(t.id))):t.info&&t.info.body&&t.info.title?(this.$alert(Object(wt.d)(t.info.body),t.info.title,{dangerouslyUseHTMLString:!0,customClass:"ann-box"}),"merchant"===this._project&&(t.is_read=!0,yt(t.id))):(this.loadingMessage=!0,vt(t.id).then((function(a){e.loadingMessage=!1,"merchant"===e._project&&(t.is_read=!0),t.info=a.data,e.$alert(Object(wt.d)(a.data.body),a.data.title,{dangerouslyUseHTMLString:!0,customClass:"ann-box"})})).catch((function(){e.loadingMessage=!1})))},checkMarkRead:function(){var t=this;this.checkedIds.length&&this.$confirm("批量标记消息为已读? ","提示",{type:"warning"}).then((function(){t.loading=!0,yt(t.checkedIds,t.userInfo?t.userInfo.id:0).then((function(){t.$notify({title:"操作成功",message:"选中消息已标记",type:"success"}),t.getList()})).catch((function(){t.loading=!1}))}))},checkDelete:function(){var t=this;this.checkedIds.length&&this.$confirm("批量删除选中消息? 此操作不可恢复","提示",{type:"warning"}).then((function(){t.loading=!0,function(t){return Object(T.a)({url:"message/delete",method:"post",data:{ids:t}})}(t.checkedIds).then((function(){t.$notify({title:"操作成功",message:"选中消息已删除",type:"info"}),t.getList()})).catch((function(){t.loading=!1}))}))},handleView:function(t){this.chooseInfo=t},onViewClose:function(t){this.chooseInfo=null,t&&this.getList()}}},Be=Object(l.a)(Ne,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",class:{"app-container":!t.userInfo}},[a("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[a("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[a("el-form-item",{staticClass:"mobile-full-width"},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[a("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[a("el-option",{attrs:{label:"标题",value:"title"}}),a("el-option",{attrs:{label:"内容",value:"message"}})],1)],1)],1),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map((function(t){return t.id})).join(",")}}},[a("el-table-column",{attrs:{type:"selection",width:"40"}}),"admin"===t._project?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),"admin"!==t._project||t.userInfo?t._e():a("el-table-column",{attrs:{prop:"to_user_id",label:"商户ID",width:"70"}}),a("el-table-column",{attrs:{prop:"from_user_id",label:"消息类型",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(0===e.row.from_user_id?"系统消息":"用户消息")+" ")]}}])}),a("el-table-column",{attrs:{prop:"info_title",label:"消息标题","min-width":"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"line-btn",on:{click:function(a){return t.showMessage(e.row)}}},[t._v(" "+t._s(e.row.info_title?e.row.info_title:e.row.info?e.row.info.title:"未知#"+e.row.info_id)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"created_at",label:"发送时间",width:"160"}}),a("el-table-column",{attrs:{prop:"is_read",label:"状态",width:"80","column-key":"is_read",filters:t.readFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:0===e.row.is_read?"primary":"info"}},[t._v(" "+t._s(0===e.row.is_read?"未读":"已读")+" ")])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"50",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"icon-btn",on:{click:function(a){return t.showMessage(e.row)}}},[t._v("查看")])]}}])})],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[a("el-form",{staticClass:"no-bottom-form",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"选中"}},[a("el-button",{attrs:{size:"small"},on:{click:t.checkMarkRead}},[t._v("标记已读")])],1)],1)],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?a("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.list.per_page,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t.loadingMessage?a("div",{staticClass:"v-modal",staticStyle:{"z-index":"1010"}}):t._e(),t.loadingMessage?a("div",{staticClass:"el-message-box__wrapper",staticStyle:{"z-index":"1011"}},[t._m(0)]):t._e()],1)}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{position:"relative",display:"inline-block",width:"250px","background-color":"#fff","border-radius":"4px",border:"1px solid #ebeef5"}},[a("p",[t._v("加载中...")])])}],!1,null,null,null).exports;var Fe={props:{userInfo:{type:Object,default:null},filterType:{default:null}},data:function(){return{isMobile:this.$store.state.app.isMobile,loading:!1,search:{type:"id",value:""},date_range:"",where:{},list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]}}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,null!==this.filterType&&(this.where.filterType=this.filterType),this.userInfo&&(this.where.user_id=this.userInfo.id),function(t){return Object(T.a)({url:"log",method:"get",params:t})}(this.where).then((function(e){t.list=e.data,t.loading=!1}))},handleSearch:function(){var t={search:this.search.type,val:this.search.value};this.date_range&&this.date_range[0]&&this.date_range[1]?(t.start_at=this.date_range[0].format("yyyy-MM-dd"),t.end_at=this.date_range[1].format("yyyy-MM-dd")):(t.start_at=null,t.end_at=null),Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){Object.assign(this.where,{}),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()}}},qe=Object(l.a)(Fe,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",class:{"app-container":!t.userInfo}},[a("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[a("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[a("el-form-item",{staticClass:"mobile-full-width"},[a("el-date-picker",{attrs:{size:"small",type:"daterange",align:"right",placeholder:"日期范围","picker-options":t.pickerOptions},model:{value:t.date_range,callback:function(e){t.date_range=e},expression:"date_range"}})],1),t.isMobile?t._e():a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map((function(t){return t.id})).join(",")}}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}),a("el-table-column",{attrs:{prop:"created_at",label:"登录时间",width:"160"}}),a("el-table-column",{attrs:{prop:"ip",label:"登录IP","min-width":"150","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"address",label:"登录地址","min-width":"150","show-overflow-tooltip":""}})],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?a("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.list.per_page,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1)],1)}),[],!1,null,null,null).exports,Ve={props:{info:{},inBox:{default:!1},userInfo:{}},data:function(){return{loading:!1,labelWidth:this.$store.state.app.isMobile?"70px":"90px",form:{id:null,name:"",sort:1e3,password:"",password_open:!1,enabled:1},formRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],enabled:[{required:!0,message:"请选择状态",trigger:"blur"}]}}},computed:{isAdd:function(){return!this.info}},watch:{loading:function(t,e){this.$emit("update:loading",t),t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.isAdd||(this.form.id=this.info.id,this.form.name=this.info.name,this.form.sort=this.info.sort,this.form.password=this.info.password,this.form.password_open=1===this.info.password_open,this.form.enabled=this.info.enabled),this.userInfo&&(this.form.user_id=this.userInfo.id)},methods:{handleSubmit:function(){var t=this;this.$refs.form.validate((function(e){e&&(t.loading=!0,Object(ue.b)(t.form).then((function(){t.loading=!1,t.$notify({title:"提示",message:(t.isAdd?"创建分类":"编辑分类")+"成功",type:"success",duration:3e3}),t.$emit("submit",!0)})).catch((function(){t.loading=!1})))}))}}},Ye=(a("12af"),Object(l.a)(Ve,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"app-container":!t.inBox}},[t.isAdd?a("h3",{staticStyle:{margin:"4px 0 28px 0"}},[t._v("添加分类")]):t._e(),a("el-form",{ref:"form",attrs:{model:t.form,"label-width":t.labelWidth,rules:t.formRules}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-tooltip",{attrs:{effect:"dark",content:"数字越小越靠前",placement:"top-start"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:1e7,size:"small"},model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}})],1)],1),a("el-form-item",{staticClass:"category-password",attrs:{label:"分类密码",prop:"password"}},[a("el-tooltip",{attrs:{effect:"dark",content:"设置分类密码，开启后只有输入密码才能查看",placement:"top-start"}},[a("el-input",{attrs:{type:"text",placeholder:"分类密码(可选)"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}},[a("el-checkbox",{attrs:{slot:"prepend"},slot:"prepend",model:{value:t.form.password_open,callback:function(e){t.$set(t.form,"password_open",e)},expression:"form.password_open"}},[t._v("开启")])],1)],1)],1),a("el-form-item",{attrs:{label:"状态",prop:"enabled"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.form.enabled,callback:function(e){t.$set(t.form,"enabled",e)},expression:"form.enabled"}},[a("el-radio-button",{attrs:{label:1}},[t._v("显示")]),a("el-radio-button",{staticClass:"el-radio-gray",attrs:{label:0}},[t._v("隐藏")])],1)],1),t.isAdd?a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.handleSubmit}},[t._v("添加")])],1):t._e()],1)],1)}),[],!1,null,null,null)).exports,He={props:{info:{}},components:{categoryAdd:Ye},data:function(){return{loading:!1,visible:!0}},watch:{visible:function(t){t||this.$emit("close",!1)}},methods:{handleSubmit:function(){this.$refs.editBox.handleSubmit()},handleClose:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}},We=Object(l.a)(He,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"编辑分类",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[a("category-add",{ref:"editBox",attrs:{"in-box":!0,info:t.info,loading:t.loading},on:{submit:function(e){return t.handleClose(!0)},"update:loading":function(e){t.loading=e}}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){return t.handleClose(!1)}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("确认编辑 ")])],1)],1)}),[],!1,null,null,null).exports,Qe={props:{userInfo:{type:Object,default:null},filterType:{default:null},_project:{default:"merchant"},_inBox:{}},components:{categoryEdit:We,categoryAdd:Ye},data:function(){return{loading:!1,showAddBox:!1,addBoxLoaded:!1,search:{type:"name",value:""},where:{},list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",enabledFilter:[{text:"显示",value:1,type:"primary"},{text:"隐藏",value:0,type:"info"}],editInfo:null,editAction:null}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.getList(),"create"===this.$route.query.action&&this.handleAdd()},methods:{getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,null!==this.filterType&&(this.where.filterType=this.filterType),this.userInfo&&(this.where.user_id=this.userInfo.id),Object(ue.d)(this.where).then((function(e){t.list=e.data,t.loading=!1}))},handleSearch:function(){var t={search:this.search.type,val:this.search.value};Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.enabled?e.enabled=t.enabled.join(","):e.enabled=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},goProducts:function(t){this.$router.push({path:"/m/product/list",query:{category_id:t.id}})},goUserDetail:function(t){},handleSetSort:function(t){var e=this;parseInt(t.sort)!==t.sort_old?(this.loading=!0,Object(ue.e)(t.id,t.sort).then((function(){e.getList()})).catch((function(){e.loading=!1}))):t.sort=parseInt(t.sort)},handleEdit:function(t){this.editAction="edit",this.editInfo=t},handleCategoryEnabled:function(t){Object(ue.c)(t.id,t.enabled)},showUrl:function(t){var e='<a class="icon-btn" href="'.concat(t.url,'" target="_blank">').concat(t.url,"</a>");t.password_open&&(e+="<br>密码: "+Object(wt.a)(t.password)),this.$msgbox({title:"单独链接",message:e,dangerouslyUseHTMLString:!0})},handleDelete:function(t){var e=this,a=t.name;this.$confirm("删除分类<"+a+">? 此操作不可恢复","提示",{type:"warning"}).then((function(){e.loading=!0,Object(ue.a)(t.id).then((function(){e.$notify({title:"操作成功",message:"分类<"+a+">已删除",type:"info"}),e.getList()})).catch((function(){e.loading=!1}))}))},checkDelete:function(){var t=this;this.checkedIds.length&&this.$confirm("批量删除选中分类? 此操作不可恢复","提示",{type:"warning"}).then((function(){t.loading=!0,Object(ue.a)(t.checkedIds).then((function(){t.$notify({title:"操作成功",message:"选中分类已删除",type:"info"}),t.getList()})).catch((function(){t.loading=!1}))}))},editCallback:function(t){this.editAction=null,t&&this.getList()},handleAdd:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("admin"!==this._project||this.userInfo){t.next=2;break}return t.abrupt("return",this.$alert("请在商户列表选择商户后添加",{type:"error"}));case 2:return window.scrollTo(0,0),this.addBoxLoaded=!0,t.next=6,this.$nextTick();case 6:this.showAddBox=!0;case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),onAdd:function(){this.getList(),this.showAddBox=!1}}},Ge=Object(l.a)(Qe,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",class:{"app-container":!t.userInfo&&!t._inBox}},[a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showAddBox,expression:"showAddBox"}],staticClass:"apply-box"},[a("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",type:"danger",size:"small"},on:{click:function(e){t.showAddBox=!1}}}),t.showAddBox||t.addBoxLoaded?a("el-card",{staticClass:"my-card"},[a("category-add",{attrs:{"in-box":!0,userInfo:t.userInfo},on:{submit:t.onAdd}})],1):t._e()],1)]),a("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[a("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[a("el-form-item",{staticClass:"mobile-full-width"},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[a("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[a("el-option",{attrs:{label:"ID",value:"id"}}),a("el-option",{attrs:{label:"名称",value:"name"}})],1)],1)],1),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),a("el-form-item",{staticClass:"right-toolbox"},[a("el-link",{on:{click:t.handleAdd}},[a("icon",{attrs:{name:"regular/plus"}}),t._v(" 添加")],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map((function(t){return t.id})).join(",")}}},[a("el-table-column",{attrs:{type:"selection",width:"40"}}),"admin"===t._project?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),"admin"!==t._project||t.userInfo?t._e():a("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"text-nowrap line-btn",on:{click:function(a){return t.goUserDetail(e.row.user_id)}}},[t._v(t._s(e.row.user_id))])]}}],null,!1,4213310200)}),a("el-table-column",{attrs:{prop:"name",label:"分类名称(点击编辑)","min-width":"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"text-nowrap line-btn",on:{click:function(a){return t.handleEdit(e.row)}}},[t._v(t._s(e.row.name))])]}}])}),a("el-table-column",{attrs:{prop:"enabled",label:"显示",width:"70","column-key":"enabled",filters:t.enabledFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#4cd964"},on:{change:function(a){return t.handleCategoryEnabled(e.row)}},model:{value:e.row.enabled,callback:function(a){t.$set(e.row,"enabled",a)},expression:"scope.row.enabled"}})]}}])}),a("el-table-column",{attrs:{prop:"products_count",label:"商品数",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"line-btn",on:{click:function(a){return t.goProducts(e.row)}}},[t._v(t._s(e.row.products_count))])]}}])}),a("el-table-column",{attrs:{prop:"sort",label:"排序",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return["string"==typeof e.row.sort?a("input",{directives:[{name:"model",rawName:"v-model",value:e.row.sort,expression:"scope.row.sort"}],staticClass:"table-input",attrs:{size:"small",title:"排序"},domProps:{value:e.row.sort},on:{blur:function(a){return t.handleSetSort(e.row)},keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.handleSetSort(e.row)},input:function(a){a.target.composing||t.$set(e.row,"sort",a.target.value)}}}):t._e(),"number"==typeof e.row.sort?a("a",{staticClass:"line-btn",on:{click:function(){e.row.sort_old=e.row.sort,e.row.sort=e.row.sort+""}}},[t._v(t._s(e.row.sort))]):t._e()]}}])}),a("el-table-column",{attrs:{label:"操作",width:"90",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"icon-btn",on:{click:function(a){return t.showUrl(e.row)}}},[t._v("直链")]),a("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:function(a){return t.handleEdit(e.row)}}},[a("icon",{attrs:{name:"light/pencil"}})],1),a("a",{staticClass:"icon-btn",on:{click:function(a){return t.handleDelete(e.row)}}},[a("icon",{attrs:{name:"light/trash-alt"}})],1)]}}])})],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[a("el-form",{staticClass:"no-bottom-form",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"选中"}},[a("el-button",{attrs:{size:"small"},on:{click:t.checkDelete}},[t._v("删除")])],1)],1)],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?a("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.list.per_page,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t.editAction?a("category-edit",{attrs:{info:t.editInfo,action:t.editAction,userInfo:t.userInfo},on:{close:t.editCallback}}):t._e()],1)}),[],!1,null,null,null).exports,Ze={props:{info:{},categories:{},loadCategory:{}},data:function(){return{loading:!1,isMobile:this.$store.state.app.isMobile,visible:!0,form:{id:this.info.id,category_id:this.info.category_id},formRules:{category_id:[{required:!0,message:"请选择商品分类",trigger:"blur"}]},categories_:[]}},watch:{visible:function(t){t||this.$emit("close",!1)}},mounted:function(){var t=this;if(this.loadCategory)this.categories_=this.categories;else{var e={search:"simple",val:"list"};this.info&&(e.user_id=this.info.user_id),Object(ue.d)(e).then((function(e){t.categories_=e.data}))}},methods:{handleSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(e){t.loading=!0;var a=t.form.category_id,i="string"==typeof a;i&&(a="+"+a),Object(fe.b)(t.form.id,a).then((function(e){t.loading=!1,t.$notify({title:"提示",message:"修改商品分类成功",type:"success",duration:3e3}),t.$emit("close",{category:e.data,isAddCategory:i})})).catch((function(){t.loading=!1}))}}))},handleClose:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}},Je=(a("2c83"),Object(l.a)(Ze,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"product-category",attrs:{title:"修改商品分类",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-position":t.isMobile?"top":"","label-width":"90px",rules:t.formRules}},[a("el-form-item",{class:t.isMobile?"item-container":"",style:t.isMobile?"margin-top: -32px":"",attrs:{label:"分类",prop:"category_id"}},[a("el-select",{staticStyle:{display:"block"},attrs:{"allow-create":"",filterable:"","no-data-text":"请输入分类名称"},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories_,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){return t.handleClose(!1)}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("确认修改 ")])],1)],1)}),[],!1,null,null,null)).exports,Ke=(a("caad"),a("2532"),a("e085")),Xe=window.config.functions&&window.config.functions.includes("product_manual"),ta={components:{QuillEditor:re},props:{_project:{default:"merchant"},info:{},inBox:{default:!1},userInfo:{},_categories:{}},data:function(){var t=this;return{loading:!1,isMobile:this.$store.state.app.isMobile,PRODUCT_MANUAL:Xe,userInfo_:null,upload_url:window.API_URL+"product/upload",INVENTORY_TYPE:ee,DELIVERY:fe.a,showAdvancedInfo:!1,form:{id:null,user_id:null,category_id:null,name:"",description:"",instructions:"",fields:"",delivery:fe.a.AUTO,sort:1e3,buy_min:1,buy_max:1e3,count_warn:"",inventory:ee.AUTO,support_coupon:!1,password:"",password_open:!1,cost:0,price:0,price_whole:"",enabled:1,retail_open:0,retail_code:"",retail_from_id:null,retail_keep_sync:1,webhook:""},fields:{type:"any",need_ext:!1,ext:[]},price_whole:[],categories:[],retail_options:{price:"",can_edit:1,min_price:0,max_price:99999},formRules:{category_id:[{required:!0,message:"请选择商品分类",trigger:"change"}],name:[{required:!0,message:"请输入商品名称",trigger:"change"}],cost:[{validator:function(t,e,a){var i=Math.round(100*e);i<0?a(new Error("成本价不能低于 0")):i>1e9?a(new Error("成本价不能超过 10000000")):a()},trigger:"change"}],price:[{required:!0,validator:function(e,a,i){var n=Math.round(100*a);n<Math.round(100*t.form.cost)&&i(new Error("商品售价不能低于成本价")),n<1?i(new Error("商品售价不能低于 0.01")):n>1e9?i(new Error("商品售价不能超过 10000000")):t.isFromRetail&&t.retail_from&&(n<t.retail_from.retail_options.min_price||n>t.retail_from.retail_options.max_price)?i(new Error("* 供货商限定价格为: ".concat(Object(Ke.a)(t.retail_from.retail_options.min_price)," - ").concat(Object(Ke.a)(t.retail_from.retail_options.max_price)))):i()},trigger:"change"}],price_whole:[{validator:function(e,a,i){for(var n=0;n<t.price_whole.length;n++){if(t.price_whole[n][1]<.01)return void i(new Error("批发价格不能低于 0.01"));if(t.price_whole[n][1]>1e7)return void i(new Error("批发价格不能超过 10000000"));var r=Math.round(100*t.price_whole[n][1]);if(t.isFromRetail&&t.retail_from){if(r<t.retail_from.retail_options.price)return void i(new Error("批发价格不能低于成本价"));if(r<t.retail_from.retail_options.min_price||r>t.retail_from.retail_options.max_price)return void i(new Error("* 供货商限定价格为: ".concat(Object(Ke.a)(t.retail_from.retail_options.min_price)," - ").concat(Object(Ke.a)(t.retail_from.retail_options.max_price))))}}i()},trigger:"change"}],enabled:[{required:!0,message:"请选择状态",trigger:"change"}]},showRetailFromInfo:!1,retail_from:null,fields_check:{message:"",color:""},retail_price_check:{message:"",color:""},retail_priceLimit_check:{message:"",color:""},retail_code_check:{loading:!1,message:"",color:""}}},computed:{isAdd:function(){return!this.info},formItemClass:function(){return this.isMobile?"product-form-item":""},isFromRetail:function(){return this.form.retail_from_id>0||null!==this.retail_from},canEditRetail:function(){return!(this.isFromRetail&&null!==this.retail_from&&0===this.retail_from.retail_options.can_edit)},canRetail:function(){return!(this.retail_from&&this.retail_from.retail_level>=2)}},watch:{loading:function(t,e){this.$emit("update:loading",t),t?e||at.a.isStarted()||at.a.start():at.a.done()},_categories:function(){this.categories=this._categories}},beforeMount:function(){if(this.userInfo?this.userInfo_=this.userInfo:this.userInfo_=this.$store.state.user.userInfo,this._categories&&this._categories.length&&this._categories[0].id>0?this.categories=this._categories:this.getCategories(),!this.isAdd){for(var t in this.form)this.form.hasOwnProperty(t)&&this.$set(this.form,t,this.info[t]);this.form.cost=1*(this.info.cost/100).toFixed(2),this.form.price=1*(this.info.price/100).toFixed(2),this.form.support_coupon=1===this.info.support_coupon,this.form.password_open=1===this.info.password_open;try{this.price_whole=JSON.parse(this.form.price_whole).map((function(t){return[t[0],(t[1]/100).toFixed(2)]}))}catch(t){this.price_whole=[]}null==this.price_whole&&(this.price_whole=[]),this.form.fields&&"{"===this.form.fields[0]&&Object.assign(this.fields,JSON.parse(this.form.fields)),this.retail_from=this.info.retail_from,this.retail_from&&0===this.retail_from.retail_options.can_edit&&(this.form.retail_keep_sync=1),this.info.retail_options&&(Object.assign(this.retail_options,this.info.retail_options),this.retail_options.price=1*(this.retail_options.price/100).toFixed(2),this.retail_options.min_price=1*(this.retail_options.min_price/100).toFixed(2),this.retail_options.max_price=1*(this.retail_options.max_price/100).toFixed(2))}this.userInfo&&(this.form.user_id=this.userInfo.id),this.$route.query.retail_code&&this.addRetailProduct(this.$route.query.retail_code)},methods:{moneyFilter:Ke.a,renderDelta:wt.d,getCategories:function(){var t=this,e={search:"simple",val:"list"};this.info?e.user_id=this.info.user_id:this.userInfo&&(e.user_id=this.userInfo.id),Object(ue.d)(e).then((function(e){t.categories=e.data}))},addRetailProduct:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=10;break}return t.prev=1,t.next=4,this.$prompt("请输入供货商提供的对接密钥","请输入对接密钥",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/.{6,32}/,inputErrorMessage:"对接密钥为 6 到 32 位",closeOnClickModal:!1});case 4:e=t.sent.value,t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return");case 10:this.loading=!0,Object(fe.c)(e).then((function(t){if("product"===t.message){var i=t.data;a.form.from_code=e,a.form.name=i.name,a.form.description=i.description,a.form.instructions=i.instructions,a.$refs["editor-description"].setValue(i.description),a.$refs["editor-instructions"].setValue(i.instructions),a.form.cost=1*(i.retail_options.price/100).toFixed(2),a.form.price=1*(i.retail_options.min_price/100).toFixed(2),a.retail_from=i}else"user"===t.message?a.$router.push({path:"/m/product/retail/add",query:{retail_code:e}}):a.$msgbox({message:t.message,title:"错误",type:"error"})})).finally((function(){a.loading=!1}));case 12:case"end":return t.stop()}}),t,this,[[1,7]])})));return function(e){return t.apply(this,arguments)}}(),showRetailPriceTip:function(){this.$msgbox({message:"\n        当供货商修改商品进货价格时，<br>您设置的价格会根据供货商的修改幅度同步更改。<br><br>\n\n        举例：<br>\n        供货商设置进货价为 10 元，<br>您设置的价格为 15 元；<br>\n        当供货商将进货价提高为 11 元时，<br>您的价格将自动修改为 16 元。\n        ",title:"供货商修改价格说明",dangerouslyUseHTMLString:!0})},showRetailPasswordTip:function(){this.$msgbox({message:"\n此选项仅在用户直接购买时有效，<br>代理进货时不受限制。\n",title:"购买密码说明",dangerouslyUseHTMLString:!0})},checkFieldsExt:function(){if(this.fields_check.message="",!this.fields.need_ext)return!0;if(!this.fields.ext.length)return this.fields_check.message="请至少添加一个字段",this.fields_check.color="#FF4949",!1;for(var t=0;t<this.fields.ext.length;t++)if(!this.fields.ext[t].length)return this.fields_check.message="第".concat(t+1,"个字段的名称不能为空"),this.fields_check.color="#F7BA2A",!1},checkRetailPrice:function(){return this.form.retail_open?""===this.retail_options.price?(this.retail_price_check.message="请输入 代理进货价",this.retail_price_check.color="#F7BA2A",!1):+this.retail_options.price<+this.form.cost?(this.retail_price_check.message="代理进货价不能低于商品成本价",this.retail_price_check.color="#FF4949",!1):+this.retail_options.price>1e7?(this.retail_price_check.message="价格不能超过 10,000,000",this.retail_price_check.color="#FF4949",!1):(this.retail_price_check.message="",this.retail_price_check.color="",!0):(this.retail_price_check.message="",this.retail_price_check.color="",!0)},checkRetailPriceLimit:function(){return this.form.retail_open?""===this.retail_options.min_price?(this.retail_priceLimit_check.message="请输入 代理最低零售价",this.retail_priceLimit_check.color="#F7BA2A",!1):""===this.retail_options.max_price?(this.retail_priceLimit_check.message="请输入 代理最高零售价",this.retail_priceLimit_check.color="#F7BA2A",!1):+this.retail_options.min_price>+this.retail_options.max_price?(this.retail_priceLimit_check.message="代理最高零售价 需要大于 代理最低零售价",this.retail_priceLimit_check.color="#FF4949",!1):+this.retail_options.min_price>1e7||+this.retail_options.max_price>1e7?(this.retail_priceLimit_check.message="价格不能超过 10,000,000",this.retail_priceLimit_check.color="#FF4949",!1):(this.retail_priceLimit_check.message="",this.retail_priceLimit_check.color="",!0):(this.retail_priceLimit_check.message="",this.retail_priceLimit_check.color="",!0)},checkFormPriceWhole:function(){return this.$refs.form.validateField("price_whole")},checkRetailCodeAvailable:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){var e,a,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=!(i.length>0&&void 0!==i[0])||i[0],this.form.retail_code&&!(this.form.retail_code.length<6)){t.next=5;break}return this.retail_code_check.message="对接密钥为 6 到 32 位",this.retail_code_check.color="#FF4949",t.abrupt("return",!1);case 5:if(!(this.form.retail_code.length>32)){t.next=9;break}return this.retail_code_check.message="对接密钥为 6 到 32 位",this.retail_code_check.color="#FF4949",t.abrupt("return",!1);case 9:if(e){t.next=11;break}return t.abrupt("return",""===this.retail_code_check.message);case 11:return this.retail_code_check.message="对接密钥检查中...请稍后",this.retail_code_check.color="#F7BA2A",this.retail_code_check.loading=!0,t.prev=14,t.next=17,Object(fe.c)(this.form.retail_code);case 17:if(!(a=t.sent).data||a.data.id===this.form.id&&"product"===a.message){t.next=24;break}this.retail_code_check.message="对接密钥已被使用，请重新输入",this.retail_code_check.color="#FF4949",this.$notify({title:"提示",message:this.retail_code_check.message,type:"error"}),t.next=28;break;case 24:return this.retail_code_check.message="",this.retail_code_check.color="",this.$notify({title:"提示",message:"当前对接密钥可用",type:"success",duration:500}),t.abrupt("return",!0);case 28:t.next=34;break;case 30:t.prev=30,t.t0=t.catch(14),this.retail_code_check.message="对接密钥检查失败，请重新输入";case 34:return t.prev=34,this.retail_code_check.loading=!1,t.finish(34);case 37:return t.abrupt("return",!1);case 38:case"end":return t.stop()}}),t,this,[[14,30,34,37]])})));return function(){return t.apply(this,arguments)}}(),handleRandomRetailCode:function(){this.form.retail_code=Object(wt.c)(8).toLocaleUpperCase(),this.checkRetailCodeAvailable()},handleSubmit:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.form.description=this.$refs["editor-description"].getValue(),this.form.instructions=this.$refs["editor-instructions"].getValue(),this.$refs.form.validate(function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(a){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=3;break}return e.$msgbox({message:"信息填写不完整, 请检查",title:"提示",type:"error"}),t.abrupt("return",!1);case 3:if(!e.form.retail_open){t.next=16;break}return t.next=6,e.checkRetailPrice();case 6:if(t.sent){t.next=8;break}return t.abrupt("return",e.$msgbox({message:e.retail_price_check.message,title:"提示",type:"error"}).then((function(){e.$refs.retail_price.focus()})));case 8:return t.next=10,e.checkRetailPriceLimit();case 10:if(t.sent){t.next=12;break}return t.abrupt("return",e.$msgbox({message:e.retail_priceLimit_check.message,title:"提示",type:"error"}).then((function(){e.$refs.retail_min_price.focus()})));case 12:return t.next=14,e.checkRetailCodeAvailable(!1);case 14:if(t.sent){t.next=16;break}return t.abrupt("return",e.$msgbox({message:e.retail_code_check.message,title:"提示",type:"error"}).then((function(){e.$refs.retail_code.focus()})));case 16:e.loading=!0,"string"==typeof e.form.category_id&&(e.form.category_id="+"+e.form.category_id,e.form.category={name:e.form.category_id}),(i=Object.assign({},e.form)).fields=JSON.stringify(e.fields),i.price_whole=JSON.stringify(e.price_whole.map((function(t){return[t[0],parseInt(100*t[1])]}))),e.isAdd&&delete i.id,i.retail_open?i.retail_options=e.retail_options:delete i.retail_code,Object(fe.f)(i).then((function(t){e.loading=!1,t.data.category&&(e.categories.push(t.data.category),e.form.category_id=t.data.category.id),e.isAdd?e.$msgbox({title:"添加商品成功",showCancelButton:!0,dangerouslyUseHTMLString:!0,confirmButtonText:"查看商品",cancelButtonText:"继续添加"}).then((function(){e.$router.push("/m/product/list")})):(e.$notify({title:"提示",message:"编辑商品成功",type:"success",duration:3e3}),e.$emit("submit",!0))})).finally((function(){e.loading=!1}));case 25:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}},ea=(a("13e9"),Object(l.a)(ta,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"app-container":!t.inBox}},[a("h3",{staticStyle:{margin:"4px 0 28px 0"}},[t._v(t._s(t.isAdd?"添加商品":"编辑商品")+" "),"admin_free"!==t._project&&t.isAdd?a("el-button",{staticStyle:{float:"right"},attrs:{size:"small",round:"",icon:"el-icon-plus",disabled:t.loading},on:{click:function(e){return t.addRetailProduct()}}},[t._v(" 添加分销商品 ")]):t._e()],1),t.isFromRetail?a("el-alert",{staticStyle:{"margin-bottom":"36px"},attrs:{type:"info",title:"",closable:!1}},[a("div",{staticClass:"retail-root-info"},[t._v(" 当前商品为分销商品： "),t.retail_from?a("el-button",{staticStyle:{padding:"4px"},attrs:{type:"text"},on:{click:function(e){t.showRetailFromInfo=!t.showRetailFromInfo}}},[t._v(" 查看货源 ")]):a("span",{staticStyle:{color:"red"}},[t._v("供货商品已删除")]),t.showRetailFromInfo?a("div",{staticStyle:{"margin-top":"12px"}},[a("p",[t._v("商品名称: "+t._s(t.retail_from.name))]),a("p",[t._v("商品分类: "+t._s(t.retail_from.category?t.retail_from.category.name:"?未知?"))]),a("p",[t._v("商品介绍: "),a("span",{staticStyle:{border:"1px solid #eee",display:"block"},domProps:{innerHTML:t._s(t.renderDelta(t.retail_from.description))}})]),a("p",[t._v("进货价格: ￥"+t._s((t.retail_from.retail_options.price/100).toFixed(2)))])]):t._e()],1)]):t._e(),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{model:t.form,"label-position":t.isMobile?"top":"","label-width":"90px",rules:t.formRules}},[a("el-form-item",{class:t.formItemClass,style:t.isMobile?"margin-top: -24px":"",attrs:{label:"分类",prop:"category_id"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{"allow-create":"",filterable:"","no-data-text":"请输入分类名称",placeholder:"请选择商品分类"},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1)],1),a("el-form-item",{class:t.formItemClass,attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{type:"text",placeholder:"商品名称，如：91游戏30元点卡",disabled:t.isFromRetail&&t.retail_from&&!t.retail_from.retail_options.can_edit},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t.isFromRetail&&t.retail_from&&!t.retail_from.retail_options.can_edit?a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 供货商不允许修改商品信息")])]):t._e()],1),t.isFromRetail?a("el-form-item",{class:t.formItemClass,attrs:{label:"自动更新",prop:"retail_keep_sync"}},[a("el-switch",{staticStyle:{display:"inline-block"},attrs:{disabled:!t.canEditRetail,"inactive-text":"","active-value":1,"inactive-value":0},model:{value:t.form.retail_keep_sync,callback:function(e){t.$set(t.form,"retail_keep_sync",e)},expression:"form.retail_keep_sync"}}),a("div",{staticClass:"el-form-item__tip",staticStyle:{"margin-top":"-10px"}},[a("span",[t._v('* 保持 "名称/描述/使用说明" 与供货商一致 '),a("a",{staticClass:"icon-btn",attrs:{title:"查看详情"}},[a("i",{staticClass:"el-icon-info",on:{click:function(e){return t.$msgbox({message:"开启后, 供货商修改 <b>名称/描述/使用说明</b> 时，<br>您的商品信息会自动更新 <br> <br>注意，开启后您修改的信息可能被覆盖",title:"说明",dangerouslyUseHTMLString:!0})}}})])])]),t.canEditRetail?t._e():a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 供货商不允许修改商品信息")])])],1):t._e(),t.isFromRetail?a("el-form-item",{class:t.formItemClass,attrs:{label:"进货价(元)",prop:"cost"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入商品成本价",value:t.form.cost,disabled:""}}),a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 商品进货价格")])])],1):t._e(),a("el-form-item",{class:t.formItemClass,attrs:{label:"售价(元)",prop:"price"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入商品售价"},on:{change:function(e){return t.form.price=+e||0}},model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}}),t.isFromRetail?a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 当供货商修改价格时，您的售价会根据加价幅度同步修改 "),a("a",{staticClass:"icon-btn",attrs:{title:"查看详情"}},[a("i",{staticClass:"el-icon-info",on:{click:t.showRetailPriceTip}})])])]):t._e()],1),a("el-form-item",{class:t.formItemClass,attrs:{label:"商品描述",prop:"description"}},[a("quill-editor",{key:"editor-description",ref:"editor-description",attrs:{"user-info":t.userInfo_,disabled:!t.canEditRetail,placeholder:"本图文说明将显示在商品购买页面"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}}),t.canEditRetail?t._e():a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 供货商不允许修改商品信息")])])],1),a("el-form-item",{class:t.formItemClass,attrs:{label:"使用说明",prop:"instructions"}},[a("quill-editor",{key:"editor-instructions",ref:"editor-instructions",attrs:{"user-info":t.userInfo_,disabled:!t.canEditRetail,placeholder:"本图文说明将显示在订单查询网站且购买成功的订单中，一般设置详细使用说明，售后QQ群，或者下载地址类"},model:{value:t.form.instructions,callback:function(e){t.$set(t.form,"instructions",e)},expression:"form.instructions"}}),t.canEditRetail?t._e():a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 供货商不允许修改商品信息")])])],1),a("el-form-item",{class:t.formItemClass,attrs:{label:"状态",prop:"enabled"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.form.enabled,callback:function(e){t.$set(t.form,"enabled",e)},expression:"form.enabled"}},[a("el-radio-button",{attrs:{label:1}},[t._v("上架")]),a("el-radio-button",{staticClass:"el-radio-gray",attrs:{label:0}},[t._v("下架")])],1)],1),a("div",{staticClass:"more-setting-item",class:t.formItemClass},[a("el-checkbox",{model:{value:t.showAdvancedInfo,callback:function(e){t.showAdvancedInfo=e},expression:"showAdvancedInfo"}},[t._v("勾选打开高级选项")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showAdvancedInfo,expression:"showAdvancedInfo"}]},[t.isFromRetail?t._e():a("el-form-item",{class:t.formItemClass,attrs:{label:"成本价(元)",prop:"cost"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入商品成本价"},on:{change:function(e){return t.form.cost=+e||0}},model:{value:t.form.cost,callback:function(e){t.$set(t.form,"cost",e)},expression:"form.cost"}}),a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 成本价用于商户后台计算利润，默认0元")])])],1),a("el-form-item",{staticClass:"price-whole",class:t.formItemClass,attrs:{label:"批发价",prop:"price_whole"}},[a("div",{staticClass:"extra-options-container",style:{"line-height":t.isMobile?"18px":"inherit"}},[a("el-button",{staticClass:"add-btn",attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(){t.price_whole.push([1,t.form.price]),t.checkFormPriceWhole()}}},[t._v("添加 ")]),a("div",{staticClass:"price-body"},t._l(t.price_whole,(function(e,i){return a("div",{key:"product_price_whole_"+i},[a("label",{staticClass:"item-label"},[t._v("件数 "),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e[0],expression:"item[0]",modifiers:{number:!0}}],staticClass:"item-input",attrs:{type:"number",min:"1",max:"10000"},domProps:{value:e[0]},on:{change:t.checkFormPriceWhole,input:function(a){a.target.composing||t.$set(e,0,t._n(a.target.value))},blur:function(e){return t.$forceUpdate()}}})]),a("label",{staticClass:"item-label",staticStyle:{"margin-left":"8px"}},[t._v("价格 "),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e[1],expression:"item[1]",modifiers:{number:!0}}],staticClass:"item-input",attrs:{type:"text",min:"0.01",max:"10000000"},domProps:{value:e[1]},on:{change:t.checkFormPriceWhole,input:function(a){a.target.composing||t.$set(e,1,t._n(a.target.value))},blur:function(e){return t.$forceUpdate()}}})]),a("a",{staticClass:"del-btn",on:{click:function(){t.price_whole.splice(i,1),t.checkFormPriceWhole()}}},[t._v("删除")])])})),0)],1),t.form.retail_open?a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 只对普通用户有效, 代理分销时不生效")])]):t._e()]),t.canRetail?a("el-form-item",{class:t.formItemClass,attrs:{label:"代理分销",prop:"retail_open"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.form.retail_open,callback:function(e){t.$set(t.form,"retail_open",e)},expression:"form.retail_open"}},[a("el-radio-button",{attrs:{label:1}},[t._v("开启")]),a("el-radio-button",{staticClass:"el-radio-gray",attrs:{label:0}},[t._v("关闭")])],1),a("transition",{attrs:{name:"el-zoom-in-center"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.form.retail_open,expression:"form.retail_open"}],staticClass:"extra-options-container",class:t.formItemClass,staticStyle:{"margin-top":"8px"}},[a("div",[a("el-switch",{staticClass:"retail-allow-edit",staticStyle:{display:"inline-block"},attrs:{"inactive-text":"下级代理可以修改商品信息","active-value":1,"inactive-value":0},model:{value:t.retail_options.can_edit,callback:function(e){t.$set(t.retail_options,"can_edit",e)},expression:"retail_options.can_edit"}})],1),a("div",{staticStyle:{"margin-top":"8px"}},[a("span",{staticClass:"el-form-item__label2",staticStyle:{display:"block"}},[t._v("代理进货价")]),a("div",[a("el-input",{ref:"retail_price",attrs:{size:"small",type:"text",placeholder:"请输入代理进货价"},on:{change:function(e){t.retail_options.price=+e||0,t.checkRetailPrice()}},model:{value:t.retail_options.price,callback:function(e){t.$set(t.retail_options,"price",e)},expression:"retail_options.price"}}),t.retail_price_check.message?a("div",{staticClass:"el-form-item__tip",style:{color:t.retail_price_check.color}},[a("span",[t._v(t._s(t.retail_price_check.message))])]):t._e(),t.isFromRetail?a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 当供货商修改进货价时，代理进货价也会根据加价幅度同步修改")])]):t._e()],1)]),a("div",{staticStyle:{"margin-top":"16px"}},[a("span",{staticClass:"el-form-item__label2",staticStyle:{display:"block"}},[t._v("代理零售价限制(元)")]),a("div",[a("el-input",{ref:"retail_min_price",style:{display:t.isMobile?"block":"inline-block","max-width":t.isMobile?"auto":"180px","margin-right":t.isMobile?"0":"8px"},attrs:{size:"mini",placeholder:"代理最低零售价",type:"text"},on:{change:t.checkRetailPriceLimit},model:{value:t.retail_options.min_price,callback:function(e){t.$set(t.retail_options,"min_price",e)},expression:"retail_options.min_price"}}),a("el-input",{style:{display:t.isMobile?"block":"inline-block","max-width":t.isMobile?"auto":"180px"},attrs:{size:"mini",placeholder:"代理最高零售价",type:"text"},on:{change:t.checkRetailPriceLimit},model:{value:t.retail_options.max_price,callback:function(e){t.$set(t.retail_options,"max_price",e)},expression:"retail_options.max_price"}}),t.retail_priceLimit_check.message?a("div",{staticClass:"el-form-item__tip",style:{color:t.retail_priceLimit_check.color}},[a("span",[t._v(t._s(t.retail_priceLimit_check.message))])]):t._e()],1)]),a("div",{staticStyle:{"margin-top":"16px"}},[a("span",{staticClass:"el-form-item__label2",staticStyle:{display:"block"}},[t._v("对接密钥")]),a("div",[a("el-input",{ref:"retail_code",staticClass:"input-retail-code",style:{"max-width":t.isMobile?"auto":"372px"},attrs:{minlength:6,maxlength:32,disabled:t.retail_code_check.loading,placeholder:"请输入6-32位字符",size:"mini"},on:{change:t.checkRetailCodeAvailable},model:{value:t.form.retail_code,callback:function(e){t.$set(t.form,"retail_code",e)},expression:"form.retail_code"}},[a("el-button",{attrs:{slot:"append",size:"mini",type:"text",disabled:t.retail_code_check.loading},on:{click:t.handleRandomRetailCode},slot:"append"},[t._v("随机 ")])],1),t.retail_code_check.message?a("div",{staticClass:"el-form-item__tip",style:{color:t.retail_code_check.color}},[a("span",[t._v(t._s(t.retail_code_check.message))])]):a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 凭借本代码可以代理分销当前商品")])])],1)])])])],1):t._e(),t.PRODUCT_MANUAL?a("el-form-item",{class:t.formItemClass,attrs:{label:"发货模式",prop:"delivery"}},[a("el-radio-group",{model:{value:t.form.delivery,callback:function(e){t.$set(t.form,"delivery",e)},expression:"form.delivery"}},[a("el-radio",{attrs:{label:t.DELIVERY.AUTO}},[t._v("自动发货")]),a("el-radio",{attrs:{label:t.DELIVERY.MANUAL}},[t._v("手动充值")])],1)],1):t._e(),t.isFromRetail?t._e():a("el-form-item",{staticClass:"price-whole",class:t.formItemClass,attrs:{label:"买家信息",prop:"fields"}},[a("el-select",{attrs:{size:"small"},model:{value:t.fields.type,callback:function(e){t.$set(t.fields,"type",e)},expression:"fields.type"}},[a("el-option",{attrs:{label:"可以输入任意字符",value:"any"}}),a("el-option",{attrs:{label:"只能输入邮箱",value:"email"}}),a("el-option",{attrs:{label:"只能输入手机号",value:"mobile"}}),a("el-option",{attrs:{label:"只能输入QQ号",value:"qq"}})],1),a("div",[t.PRODUCT_MANUAL?a("el-checkbox",{model:{value:t.fields.need_ext,callback:function(e){t.$set(t.fields,"need_ext",e)},expression:"fields.need_ext"}},[t._v("需要填写收货信息")]):t._e()],1),a("transition",{attrs:{name:"el-zoom-in-center"}},[t.fields.need_ext?a("div",{staticClass:"price-body",style:{"line-height":t.isMobile?"18px":"inherit",margin:t.isMobile?"8px 0 4px":"0"}},[a("el-button",{staticClass:"add-btn",attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(){t.fields.ext.push("名称"),t.checkFieldsExt()}}},[t._v("添加 ")]),t._l(t.fields.ext,(function(e,i){return a("div",{key:"product_field_"+i},[a("label",{staticClass:"item-label"},[t._v("字段名 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.fields.ext[i],expression:"fields.ext[index]"}],staticClass:"item-input",staticStyle:{width:"50%"},attrs:{type:"text"},domProps:{value:t.fields.ext[i]},on:{change:t.checkFieldsExt,input:function(e){e.target.composing||t.$set(t.fields.ext,i,e.target.value)}}})]),a("a",{staticClass:"del-btn",on:{click:function(){t.fields.ext.splice(i,1),t.checkFieldsExt()}}},[t._v("删除")])])}))],2):t._e()]),t.fields_check.message?a("div",{staticClass:"el-form-item__tip",style:{color:t.fields_check.color}},[a("span",[t._v(t._s(t.fields_check.message))])]):t._e()],1),a("el-form-item",{class:t.formItemClass,attrs:{label:"商品排序",prop:"sort"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:1e7,size:"small"},model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}}),a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 数字越小越靠前")])])],1),a("el-form-item",{class:t.formItemClass,attrs:{label:"优惠券",prop:"support_coupon"}},[a("el-checkbox",{model:{value:t.form.support_coupon,callback:function(e){t.$set(t.form,"support_coupon",e)},expression:"form.support_coupon"}},[t._v("支持")])],1),a("el-form-item",{class:t.formItemClass,attrs:{label:"购买限制",prop:"buy_min"}},[a("el-tooltip",{attrs:{effect:"dark",content:"最小购买量",placement:"top-start"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1,max:1e4,size:"small"},model:{value:t.form.buy_min,callback:function(e){t.$set(t.form,"buy_min",e)},expression:"form.buy_min"}})],1),a("el-tooltip",{attrs:{effect:"dark",content:"最大购买量",placement:"top-start"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1,max:1e4,size:"small"},model:{value:t.form.buy_max,callback:function(e){t.$set(t.form,"buy_max",e)},expression:"form.buy_max"}})],1),t.form.retail_open?a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 只对普通用户有效, 代理分销时不受限制")])]):t._e()],1),a("el-form-item",{staticClass:"buy-password",class:t.formItemClass,attrs:{label:"购买密码",prop:"password"}},[a("el-tooltip",{attrs:{effect:"dark",content:"设置商品购买密码，开启后只有输入密码才能购买",placement:"top-start"}},[a("el-input",{attrs:{type:"text",placeholder:"购买密码(可选)"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}},[a("el-checkbox",{attrs:{slot:"prepend"},slot:"prepend",model:{value:t.form.password_open,callback:function(e){t.$set(t.form,"password_open",e)},expression:"form.password_open"}},[t._v("开启")])],1)],1),t.form.retail_open?a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 只对普通用户有效, 代理分销时不受限制 "),a("a",{staticClass:"icon-btn",attrs:{title:"查看详情"}},[a("i",{staticClass:"el-icon-info",on:{click:t.showRetailPasswordTip}})])])]):t._e()],1),"admin_free"!==t._project?a("el-form-item",{class:t.formItemClass,attrs:{label:"Webhook",prop:"webhook"}},[a("el-input",{attrs:{type:"text",placeholder:"订单成功后通知URL(可选)"},model:{value:t.form.webhook,callback:function(e){t.$set(t.form,"webhook",e)},expression:"form.webhook"}})],1):t._e(),t.isFromRetail?t._e():a("el-form-item",{class:t.formItemClass,attrs:{label:"库存预警",prop:"count_warn"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:1e7,size:"small"},model:{value:t.form.count_warn,callback:function(e){t.$set(t.form,"count_warn",e)},expression:"form.count_warn"}}),a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 到达预警值后会发送通知邮件，填0不预警")])])],1),a("el-form-item",{class:t.formItemClass,attrs:{label:"库存显示",prop:"inventory"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.form.inventory,callback:function(e){t.$set(t.form,"inventory",e)},expression:"form.inventory"}},[a("el-radio-button",{attrs:{label:t.INVENTORY_TYPE.RANGE}},[t._v("大致范围")]),a("el-radio-button",{attrs:{label:t.INVENTORY_TYPE.REAL}},[t._v("实际库存")]),a("el-radio-button",{staticClass:"el-radio-gray",attrs:{label:t.INVENTORY_TYPE.AUTO}},[t._v("跟随店铺")])],1)],1)],1),a("el-form-item",{staticStyle:{"margin-top":"36px"}},[a("el-button",{style:{float:t.isMobile?"right":""},attrs:{type:"primary",loading:t.loading},on:{click:t.handleSubmit}},[t._v(" "+t._s(t.isAdd?"添加":"编辑")+"商品 ")])],1)],1)],1)}),[],!1,null,null,null)).exports,aa={props:{userInfo:{type:Object,default:null},filter:{default:null},_project:{default:"merchant"},_inBox:{}},components:{productBox:ea,productCategory:Je},data:function(){return{loading:!1,showAddBox:!1,addBoxLoaded:!1,DELIVERY:fe.a,search:{type:"name",value:""},where:{category_id:-1},categories:[{id:-2,name:"加载中"}],list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",enabledFilter:[{text:"上架",value:1,type:"primary"},{text:"未上架",value:0,type:"info"}],editInfo:null,editCategory:null}},computed:{loadCategory:function(){return"merchant"===this._project||"admin_free"===this._project||this.userInfo}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.$route.query.category_id&&(this.where.category_id=this.$route.query.category_id),this.filter&&this.filter.category_id&&(this.where.category_id=this.filter.category_id),this.handleSearch(),this.loadCategory?this.getCategories():this.categories=[]},methods:{searchByCategory:function(t){this.where.category_id=t,this.handleSearch()},getCategories:function(){var t=this,e={search:"simple",val:"list"};this.userInfo&&(e.user_id=this.userInfo.id),Object(ue.d)(e).then((function(e){t.categories=e.data}))},getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,this.userInfo&&(this.where.user_id=this.userInfo.id),Object(fe.h)(this.where).then((function(e){t.list=e.data,t.loading=!1}))},handleSearch:function(){var t={search:this.search.type,val:this.search.value};Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.enabled?e.enabled=t.enabled.join(","):e.enabled=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},showProductInfo:function(t){var e=Object(wt.c)(8),a="\n        <p>商品名称:&nbsp;".concat(Object(wt.a)(t.name)).concat(t.retail_from_id?'<span class="el-tag el-tag-label">分销商品</span>':"","</p>\n        <p>商品分类:&nbsp;").concat(t.category?Object(wt.a)(t.category.name):"未知#"+t.category_id,'</p>\n        <p>商品介绍:&nbsp;<a class="expand-description" href="javascript:$(\'#').concat(e,'\').toggle()">查看</a>\n          <div id="').concat(e,'" style="border: 1px solid #eee;display: none">').concat(Object(wt.d)(t.description),"</div>\n        </p>\n        <p>售价:&nbsp;￥").concat((t.price/100).toFixed(2),"</p>\n        <p>成本价:&nbsp;￥").concat((t.cost/100).toFixed(2),'</p>\n        <p>商品链接:&nbsp;<br><a class="icon-btn" href="').concat(t.url,'" target="_blank">').concat(t.url,"</a>\n        &nbsp;").concat(t.password_open?"密码:&nbsp;"+Object(wt.a)(t.password):"","</p>\n        ");t.retail_open&&(a+='\n        <p>对接密钥:&nbsp;<br><input class="small-input" readonly value="'.concat(Object(wt.a)(t.retail_code),'" onclick="select();" style="width: 260px"></p>\n        ')),this.$msgbox({title:"商品详情",message:a,dangerouslyUseHTMLString:!0,customClass:"ann-box"})},showUrl:function(t){var e='<a class="icon-btn" href="'.concat(t.url,'" target="_blank">').concat(t.url,"</a>");t.password_open&&(e+="<br>密码: "+Object(wt.a)(t.password)),this.$msgbox({title:"单独链接",message:e,dangerouslyUseHTMLString:!0})},goCards:function(t,e){this.$router.push({path:"/m/product/card/list",query:{type:t,category_id:e.category_id,product_id:e.id}})},handleProductEnabled:function(t){if(t.retail_from_id){if(!t.retail_from)return this.$msgbox({message:"当前商品为分销商品，供货商已将商品删除, 因此您无法上架此商品",title:"操作失败",type:"error"}),t.enabled=!1,!1;if(!t.retail_from.enabled)return this.$msgbox({message:"当前商品为分销商品，供货商已将商品下架, 因此您无法上架此商品",title:"操作失败",type:"error"}),t.enabled=!1,!1;if(!t.retail_from.retail_open)return this.$msgbox({message:"当前商品为分销商品，供货商已关闭商品分销, 因此您无法上架此商品",title:"操作失败",type:"error"}),t.enabled=!1,!1}Object(fe.g)(t.id,t.enabled)},handleSetSort:function(t){var e=this;parseInt(t.sort)!==t.sort_old?(this.loading=!0,Object(fe.m)(t.id,t.sort).then((function(){e.getList()})).catch((function(){e.loading=!1}))):t.sort=parseInt(t.sort)},handleSetCount:function(t){var e=this;parseInt(t.count)!==t.count_old?(this.loading=!0,Object(fe.l)(t.id,t.count).finally((function(){t.count=parseInt(t.count),e.loading=!1}))):t.count=parseInt(t.count)},handleDelete:function(t){var e=this,a=t.name;this.$confirm("删除商品<"+Object(wt.a)(a)+">? <br>选中商品的卡密将会一起删除<br>此操作不可恢复","提示",{type:"warning",dangerouslyUseHTMLString:!0}).then((function(){e.loading=!0,Object(fe.e)(t.id).then((function(){e.$notify({title:"操作成功",message:"商品<"+a+">已删除",type:"info"}),e.getList()})).catch((function(){e.loading=!1}))}))},checkDelete:function(){var t=this;this.checkedIds.length&&this.$confirm("批量删除选中商品? <br>选中商品的卡密将会一起删除<br>此操作不可恢复","提示",{type:"warning",dangerouslyUseHTMLString:!0}).then((function(){t.loading=!0,Object(fe.e)(t.checkedIds).then((function(){t.$notify({title:"操作成功",message:"选中商品已删除",type:"info"}),t.getList()})).catch((function(){t.loading=!1}))}))},checkEnable:function(){var t=this;this.checkedIds.length&&this.$confirm("批量上架选中商品? ","提示",{type:"warning"}).then((function(){t.loading=!0,Object(fe.g)(t.checkedIds,1).then((function(){t.$notify({title:"操作成功",message:"选中商品已上架",type:"success"}),t.getList()})).catch((function(){t.loading=!1}))}))},checkDisable:function(){var t=this;this.checkedIds.length&&this.$confirm("批量下架选中商品? ","提示",{type:"warning"}).then((function(){t.loading=!0,Object(fe.g)(t.checkedIds,0).then((function(){t.$notify({title:"操作成功",message:"选中商品已下架",type:"info"}),t.getList()})).catch((function(){t.loading=!1}))}))},handleCountSync:function(){var t=this;this.$notify.info({title:"请稍等",message:"刷新库存可能会消耗较长时间",duration:2e3}),this.loading=!0,Object(fe.d)(this.userInfo?this.userInfo.id:null).then((function(){t.$notify.success({title:"成功",message:"商品库存已刷新",duration:2e3}),t.getList()})).catch((function(){t.loading=!1}))},handleAdd:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.$router.push("/m/product/add"),t.next=18;break;case 4:t.next=8;break;case 8:if(this.userInfo){t.next=10;break}return t.abrupt("return",this.$alert("请在商户列表选择商户后添加",{type:"error"}));case 10:if(window.scrollTo(0,0),!this.showAddBox||!this.editInfo){t.next=14;break}return t.next=14,this.onBoxSubmit(!1);case 14:return this.addBoxLoaded=!0,t.next=17,this.$nextTick();case 17:this.showAddBox=!0;case 18:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),handleRetailAdd:function(){this.$router.push("/m/product/retail/add")},onBoxSubmit:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e&&this.getList(),this.showAddBox=!1,t.next=4,this.$nextTick();case 4:this.addBoxLoaded=!1,this.editInfo=null;case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),goUserDetail:function(t){},handleEdit:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.retail_from_id){t.next=7;break}if(e.retail_from){t.next=4;break}return this.$msgbox({message:"当前商品为分销商品，供货商已将商品删除 因此您无法编辑此商品",title:"操作失败",type:"error"}),t.abrupt("return");case 4:if(e.retail_from.retail_open){t.next=7;break}return this.$msgbox({message:"当前商品为分销商品，供货商已关闭商品分销, 因此您无法编辑此商品",title:"操作失败",type:"error"}),t.abrupt("return");case 7:if(window.scrollTo(0,0),!this.showAddBox){t.next=11;break}return t.next=11,this.onBoxSubmit(!1);case 11:return this.editInfo=e,this.addBoxLoaded=!0,t.next=15,this.$nextTick();case 15:this.showAddBox=!0;case 16:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),editCallback:function(t){this.editInfo=null,t&&this.getList()},handleEditCategory:function(t){this.editCategory=t},editCategoryCallback:function(t){t.isAddCategory&&this.categories.push(t.category),t&&t.category&&(this.editCategory.category_id=t.category.id,this.editCategory.category=t.category),this.editCategory=null}}},ia=(a("b96b"),Object(l.a)(aa,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",class:{"app-container":!t.userInfo&&!t._inBox}},[a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showAddBox,expression:"showAddBox"}],staticClass:"apply-box"},[a("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",type:"danger",size:"small"},on:{click:function(e){return t.onBoxSubmit(!1)}}}),t.showAddBox||t.addBoxLoaded?a("el-card",{staticClass:"my-card"},[a("product-box",{attrs:{"in-box":!0,userInfo:t.userInfo,info:t.editInfo,_categories:t.categories},on:{refreshCategories:t.getCategories,changeTab:function(e){return t.$emit("changeTab",e)},submit:t.onBoxSubmit}})],1):t._e()],1)]),a("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[a("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[t.loadCategory?a("el-form-item",{staticClass:"mobile-full-width"},[a("el-select",{staticClass:"mobile-full-width",attrs:{filterable:"",placeholder:"商品分类",size:"small","no-data-text":"无分类数据"},on:{change:t.getList},model:{value:t.where.category_id,callback:function(e){t.$set(t.where,"category_id",e)},expression:"where.category_id"}},[a("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.categories,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],2)],1):t._e(),a("el-form-item",{staticClass:"mobile-full-width"},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[a("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[a("el-option",{attrs:{label:"ID",value:"id"}}),"admin"===t._project?a("el-option",{attrs:{label:"商户ID",value:"user_id"}}):t._e(),a("el-option",{attrs:{label:"名称",value:"name"}}),a("el-option",{attrs:{label:"分类ID",value:"category_id"}})],1)],1)],1),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),a("el-form-item",{staticClass:"right-toolbox"},["admin_free"!==t._project?a("el-link",{staticStyle:{"margin-right":"8px"},on:{click:t.handleRetailAdd}},[a("icon",{attrs:{name:"regular/angle-double-right"}}),t._v(" 货源对接")],1):t._e(),a("el-link",{on:{click:t.handleAdd}},[a("icon",{attrs:{name:"regular/plus"}}),t._v(" 添加商品")],1)],1),a("span",{staticStyle:{clear:"both"}})],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map((function(t){return t.id})).join(",")}}},[a("el-table-column",{attrs:{type:"selection",width:"40"}}),"admin"===t._project?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),"admin"!==t._project||t.userInfo?t._e():a("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"text-nowrap line-btn",on:{click:function(a){return t.goUserDetail(e.row.user_id)}}},[t._v(t._s(e.row.user_id))])]}}],null,!1,4213310200)}),a("el-table-column",{attrs:{prop:"name",label:"商品名称(点击查看)","min-width":"180","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"line-btn",on:{click:function(a){return t.showProductInfo(e.row)}}},[t._v(t._s(e.row.name)+" "),e.row.retail_from_id?a("el-tag",{staticClass:"el-tag-label"},[t._v("分销商品")]):t._e(),e.row.delivery===t.DELIVERY.MANUAL?a("el-tag",{staticClass:"el-tag-label"},[t._v("手动发货")]):t._e()],1)]}}])}),a("el-table-column",{attrs:{prop:"category",label:"分类(点击修改)","min-width":"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"line-btn",on:{click:function(a){return t.handleEditCategory(e.row)}}},[t._v(t._s(e.row.category?e.row.category.name:"未知#"+e.row.category_id))])]}}])}),a("el-table-column",{attrs:{prop:"count_sold",label:"已售",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.retail_from_id?a("span",[t._v(t._s(e.row.count_sold))]):a("a",{staticClass:"line-btn",on:{click:function(a){return t.goCards("count_sold",e.row)}}},[t._v(t._s(e.row.count_sold))])]}}])}),a("el-table-column",{attrs:{prop:"count",label:"库存",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.retail_from_id?a("span",[t._v(t._s(e.row.count))]):e.row.delivery===t.DELIVERY.MANUAL?a("div",["string"==typeof e.row.count?a("input",{directives:[{name:"model",rawName:"v-model",value:e.row.count,expression:"scope.row.count"}],staticClass:"table-input",attrs:{size:"small",title:"库存"},domProps:{value:e.row.count},on:{blur:function(a){return t.handleSetCount(e.row)},keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.handleSetCount(e.row)},input:function(a){a.target.composing||t.$set(e.row,"count",a.target.value)}}}):t._e(),"number"==typeof e.row.count?a("a",{staticClass:"line-btn",on:{click:function(){e.row.count_old=e.row.count,e.row.count=e.row.count+""}}},[t._v(t._s(e.row.count))]):t._e()]):a("a",{staticClass:"line-btn",on:{click:function(a){return t.goCards("count",e.row)}}},[t._v(t._s(e.row.count))])]}}])},[a("template",{slot:"header"},[a("a",{staticClass:"icon-btn",staticStyle:{"font-weight":"normal"},attrs:{title:"刷新库存"},on:{click:t.handleCountSync}},[t._v(" 库存 "),a("icon",{attrs:{name:"light/sync"}})],1)])],2),a("el-table-column",{attrs:{prop:"enabled",label:"上架",width:"70","column-key":"enabled",filters:t.enabledFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#4cd964"},on:{change:function(a){return t.handleProductEnabled(e.row)}},model:{value:e.row.enabled,callback:function(a){t.$set(e.row,"enabled",a)},expression:"scope.row.enabled"}})]}}])}),a("el-table-column",{attrs:{prop:"sort",label:"排序",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return["string"==typeof e.row.sort?a("input",{directives:[{name:"model",rawName:"v-model",value:e.row.sort,expression:"scope.row.sort"}],staticClass:"table-input",attrs:{size:"small",title:"排序"},domProps:{value:e.row.sort},on:{blur:function(a){return t.handleSetSort(e.row)},keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.handleSetSort(e.row)},input:function(a){a.target.composing||t.$set(e.row,"sort",a.target.value)}}}):t._e(),"number"==typeof e.row.sort?a("a",{staticClass:"line-btn",on:{click:function(){e.row.sort_old=e.row.sort,e.row.sort=e.row.sort+""}}},[t._v(t._s(e.row.sort))]):t._e()]}}])}),a("el-table-column",{attrs:{label:"操作",width:"80",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"icon-btn",on:{click:function(a){return t.showUrl(e.row)}}},[t._v("直链")]),a("a",{staticClass:"icon-btn",on:{click:function(a){return t.handleEdit(e.row)}}},[a("icon",{attrs:{name:"light/pencil"}})],1),a("a",{staticClass:"icon-btn",on:{click:function(a){return t.handleDelete(e.row)}}},[a("icon",{attrs:{name:"light/trash-alt"}})],1)]}}])})],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[a("el-form",{staticClass:"no-bottom-form",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"选中"}},[a("el-button",{attrs:{size:"small"},on:{click:t.checkDelete}},[t._v("删除")]),a("el-button",{attrs:{size:"small"},on:{click:t.checkEnable}},[t._v("上架")]),a("el-button",{attrs:{size:"small"},on:{click:t.checkDisable}},[t._v("下架")])],1)],1)],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?a("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.list.per_page,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t.editCategory?a("product-category",{attrs:{categories:t.categories,info:t.editCategory,loadCategory:t.loadCategory},on:{close:t.editCategoryCallback}}):t._e()],1)}),[],!1,null,null,null)).exports;function na(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}var ra={FIX:0,AUTO:1},oa={AMOUNT:0,PERCENT:1},sa={props:{userInfo:{type:Object,default:null},_project:{default:"merchant"},_inBox:{}},data:function(){return{loading:!1,CATEGORY_TYPE:ra,PRICE_ADD_TYPE:oa,categories:[],where:{shop_retail_code:""},list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedRow:[],waitForAddRow:[],addConfirm:{category_type:ra.AUTO,category_val:null,price_add_type:ra.FIX,price_add_val:5},addDialogVisible:!1}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.userInfo?this.userInfo_=this.userInfo:this.userInfo_=this.$store.state.user.userInfo,this.getCategories(),this.$route.query.retail_code&&this.search(this.$route.query.retail_code)},methods:{search:function(t){this.where.shop_retail_code=t,this.getList()},getCategories:function(){var t=this,e={search:"simple",val:"list"};this.userInfo&&(e.user_id=this.userInfo.id),Object(ue.d)(e).then((function(e){t.categories=e.data}))},getList:function(){var t=this;if(this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,this.userInfo&&(this.where.user_id=this.userInfo.id),this.where.shop_retail_code.length<6)return this.$msgbox({message:"对接密钥输入错误，请检查",title:"提示",type:"error"});this.loading=!0,Object(fe.k)(this.where).then((function(e){"product"!==e.message?t.list=e.data:t.$confirm("当前对接密钥为单个商品，跳转至添加商品页面?","提示",{type:"warning"}).then((function(){t.$router.push({path:"/m/product/add",query:{retail_code:t.where.shop_retail_code}})}))})).finally((function(){t.loading=!1}))},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},handleAddProduct:function(t){this.waitForAddRow=[t],this.addDialogVisible=!0},handleCheckedAdd:function(){this.checkedRow.length&&(this.waitForAddRow=this.checkedRow,this.addDialogVisible=!0)},handleAddRetailSubmit:function(){var t=this,e=Object.assign({},function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?na(Object(a),!0).forEach((function(e){Object(r.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):na(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({user_id:this.userInfo_.id,ids:this.waitForAddRow.map((function(t){return t.id})).join(",")},this.addConfirm));if(e.category_type===ra.FIX){if(!e.category_val)return this.$msgbox({message:"请选择商品分类",title:"错误",type:"error"});"string"==typeof e.category_val&&(e.category_val="+"+e.category_val)}Object(fe.i)(e).then((function(){t.$notify({title:"操作成功",message:"选中商品已添加",type:"success"}),t.waitForAddRow.forEach((function(e){t.$set(e,"isAdd",!0)}))})).finally((function(){t.loading=!1,t.addDialogVisible=!1}))}}},la=(a("ee72"),Object(l.a)(sa,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"app-container":!t.userInfo&&!t._inBox}},[a("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[a("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[a("el-form-item",{staticClass:"mobile-full-width"},[a("el-input",{staticStyle:{"min-width":"280px"},attrs:{placeholder:"请输入对接密钥",size:"small"},model:{value:t.where.shop_retail_code,callback:function(e){t.$set(t.where,"shop_retail_code",e)},expression:"where.shop_retail_code"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:t.getList}},[t._v("搜索")])],1),a("span",{staticStyle:{clear:"both"}})],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"selection-change":function(e){return t.checkedRow=e}}},[a("el-table-column",{attrs:{type:"selection",width:"40"}}),"admin"===t._project?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),a("el-table-column",{attrs:{prop:"name",label:"商品名称","min-width":"180","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))]),e.row.isAdd?a("el-tag",[t._v("已添加")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"category",label:"分类","min-width":"100","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.category?e.row.category.name:"未知#"+e.row.category_id))])]}}])}),a("el-table-column",{attrs:{prop:"price",label:"售价",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("moneyFilter")(e.row.price))+" ")]}}])}),a("el-table-column",{attrs:{prop:"retail_options.price",label:"进货价",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("moneyFilter")(e.row.retail_options.price))+" ")]}}])}),a("el-table-column",{attrs:{prop:"count",label:"库存",width:"90"}}),a("el-table-column",{attrs:{label:"操作",width:"70",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isAdd?a("span",{staticStyle:{cursor:"not-allowed"}},[t._v("已添加")]):a("el-link",{on:{click:function(a){return t.handleAddProduct(e.row)}}},[a("icon",{attrs:{name:"regular/plus"}}),t._v(" 添加 ")],1)]}}])})],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[a("el-form",{staticClass:"no-bottom-form",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"选中"}},[a("el-button",{attrs:{size:"small",disabled:0===t.checkedRow.length},on:{click:t.handleCheckedAdd}},[t._v("一键添加 ")])],1)],1)],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?a("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.list.per_page,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),a("el-dialog",{staticClass:"retail_add_config",attrs:{title:"商品对接设置","close-on-click-modal":!1,visible:t.addDialogVisible},on:{"update:visible":function(e){t.addDialogVisible=e}}},[a("div",[a("div",{staticStyle:{"margin-top":"-24px"}},[a("p",[t._v("商品分类")]),a("el-radio-group",{attrs:{size:"small"},model:{value:t.addConfirm.category_type,callback:function(e){t.$set(t.addConfirm,"category_type",e)},expression:"addConfirm.category_type"}},[a("el-radio-button",{attrs:{label:t.CATEGORY_TYPE.FIX}},[t._v("手动选择")]),a("el-radio-button",{attrs:{label:t.CATEGORY_TYPE.AUTO}},[t._v("自动添加")])],1),t.addConfirm.category_type===t.CATEGORY_TYPE.FIX?a("div",{staticStyle:{"margin-top":"12px"}},[a("el-select",{staticClass:"mobile-full-width",attrs:{"allow-create":"",filterable:"","no-data-text":"请输入分类名称",placeholder:"请选择商品分类",size:"small"},model:{value:t.addConfirm.category_val,callback:function(e){t.$set(t.addConfirm,"category_val",e)},expression:"addConfirm.category_val"}},t._l(t.categories,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1):t._e()],1),a("div",[a("p",[t._v("商品加价")]),a("el-input",{staticStyle:{width:"190px"},attrs:{size:"small",type:"text",placeholder:"请输入加价"},on:{change:function(e){return t.addConfirm.price_add_val=+e||0}},model:{value:t.addConfirm.price_add_val,callback:function(e){t.$set(t.addConfirm,"price_add_val",e)},expression:"addConfirm.price_add_val"}},[a("el-select",{staticStyle:{width:"70px"},attrs:{slot:"append",placeholder:"类型",value:"",size:"small"},slot:"append",model:{value:t.addConfirm.price_add_type,callback:function(e){t.$set(t.addConfirm,"price_add_type",e)},expression:"addConfirm.price_add_type"}},[a("el-option",{attrs:{label:"元",value:t.PRICE_ADD_TYPE.AMOUNT}}),a("el-option",{attrs:{label:"%",value:t.PRICE_ADD_TYPE.PERCENT}})],1)],1)],1)]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addDialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.handleAddRetailSubmit}},[t._v("确 定")])],1)])],1)}),[],!1,null,null,null)).exports,ca={name:"RetailProduct",props:{userInfo:{type:Object,default:null},_project:{default:"merchant"}},data:function(){return{loading:!1,DELIVERY:fe.a,search:{type:"name",value:""},where:{is_retail_open:1,category_id:-1},categories:[{id:-2,name:"加载中"}],list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",enabledFilter:[{text:"开启",value:1,type:"primary"},{text:"关闭",value:0,type:"info"}]}},computed:{loadCategory:function(){return"merchant"===this._project||"admin_free"===this._project||this.userInfo}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.$route.query.category_id&&(this.where.category_id=this.$route.query.category_id),this.handleSearch(),this.loadCategory?this.getCategories():this.categories=[]},methods:{searchByCategory:function(t){this.where.category_id=t,this.handleSearch()},getCategories:function(){var t=this,e={search:"simple",val:"list"};this.userInfo&&(e.user_id=this.userInfo.id),Object(ue.d)(e).then((function(e){t.categories=e.data}))},getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,this.userInfo&&(this.where.user_id=this.userInfo.id),Object(fe.h)(this.where).then((function(e){t.list=e.data,t.loading=!1}))},handleSearch:function(){var t={search:this.search.type,val:this.search.value};Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.retail_batch_open?e.retail_batch_open=t.retail_batch_open.join(","):e.retail_batch_open=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},showProductInfo:function(t){var e=Object(wt.c)(8),a="\n        <p>商品名称:&nbsp;".concat(Object(wt.a)(t.name)).concat(t.retail_from_id?'<span class="el-tag el-tag-label">分销商品</span>':"","</p>\n        <p>商品分类:&nbsp;").concat(t.category?Object(wt.a)(t.category.name):"未知#"+t.category_id,'</p>\n        <p>商品介绍:&nbsp;<a class="expand-description" href="javascript:$(\'#').concat(e,'\').toggle()">查看</a>\n          <div id="').concat(e,'" style="border: 1px solid #eee;display: none">').concat(Object(wt.d)(t.description),"</div>\n        </p>\n        <p>售价:&nbsp;￥").concat((t.price/100).toFixed(2),"</p>\n        <p>成本价:&nbsp;￥").concat((t.cost/100).toFixed(2),'</p>\n        <p>商品链接:&nbsp;<br><a class="icon-btn" href="').concat(t.url,'" target="_blank">').concat(t.url,"</a>\n        &nbsp;").concat(t.password_open?"密码:&nbsp;"+Object(wt.a)(t.password):"","</p>\n        ");t.retail_open&&(a+='\n        <p>对接密钥:&nbsp;<br><input class="small-input" readonly value="'.concat(Object(wt.a)(t.retail_code),'" onclick="select();" style="width: 260px"></p>\n        ')),this.$msgbox({title:"商品详情",message:a,dangerouslyUseHTMLString:!0,customClass:"ann-box product-info-msgbox"})},handleRetailEnabled:function(t){if(t.retail_from_id){if(!t.retail_from)return this.$msgbox({message:"当前商品为分销商品，供货商已将商品删除, 因此您无法上架此商品",title:"操作失败",type:"error"}),t.retail_batch_open=!1,!1;if(!t.retail_from.enabled)return this.$msgbox({message:"当前商品为分销商品，供货商已将商品下架, 因此您无法上架此商品",title:"操作失败",type:"error"}),t.retail_batch_open=!1,!1;if(!t.retail_from.retail_open)return this.$msgbox({message:"当前商品为分销商品，供货商已关闭商品分销, 因此您无法上架此商品",title:"操作失败",type:"error"}),t.retail_batch_open=!1,!1}Object(fe.j)(t.id,t.retail_batch_open)},checkEnable:function(){var t=this;this.checkedIds.length&&this.$confirm("批量开启选中商品? ","提示",{type:"warning"}).then((function(){t.loading=!0,Object(fe.j)(t.checkedIds,1).then((function(){t.$notify({title:"操作成功",message:"选中商品已启用",type:"success"}),t.getList()})).catch((function(){t.loading=!1}))}))},checkDisable:function(){var t=this;this.checkedIds.length&&this.$confirm("批量关闭选中商品? ","提示",{type:"warning"}).then((function(){t.loading=!0,Object(fe.j)(t.checkedIds,0).then((function(){t.$notify({title:"操作成功",message:"选中商品已关闭",type:"info"}),t.getList()})).catch((function(){t.loading=!1}))}))}}},da=(a("b143"),Object(l.a)(ca,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[a("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[t.loadCategory?a("el-form-item",{staticClass:"mobile-full-width"},[a("el-select",{staticClass:"mobile-full-width",attrs:{placeholder:"商品分类",size:"small",filterable:"","no-data-text":"无分类数据"},on:{change:t.getList},model:{value:t.where.category_id,callback:function(e){t.$set(t.where,"category_id",e)},expression:"where.category_id"}},[a("el-option",{attrs:{label:"全部分类",value:-1}}),t._l(t.categories,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],2)],1):t._e(),a("el-form-item",{staticClass:"mobile-full-width"},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[a("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[a("el-option",{attrs:{label:"ID",value:"id"}}),"admin"===t._project?a("el-option",{attrs:{label:"商户ID",value:"user_id"}}):t._e(),a("el-option",{attrs:{label:"名称",value:"name"}})],1)],1)],1),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),a("span",{staticStyle:{clear:"both"}})],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map((function(t){return t.id})).join(",")}}},[a("el-table-column",{attrs:{type:"selection",width:"40"}}),"admin"===t._project?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),"admin"!==t._project||t.userInfo?t._e():a("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"text-nowrap line-btn",on:{click:function(a){return t.goUserDetail(e.row.user_id)}}},[t._v(t._s(e.row.user_id))])]}}],null,!1,4213310200)}),a("el-table-column",{attrs:{prop:"name",label:"商品名称(点击查看)","min-width":"180","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"line-btn",on:{click:function(a){return t.showProductInfo(e.row)}}},[t._v(t._s(e.row.name)+" "),e.row.retail_from_id?a("el-tag",{staticClass:"el-tag-label"},[t._v("分销商品")]):t._e(),e.row.delivery===t.DELIVERY.MANUAL?a("el-tag",{staticClass:"el-tag-label"},[t._v("手动发货")]):t._e()],1)]}}])}),a("el-table-column",{attrs:{prop:"category",label:"分类","min-width":"100","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.category?e.row.category.name:"未知#"+e.row.category_id))])]}}])}),a("el-table-column",{attrs:{prop:"retail_batch_open",label:"开启",width:"70","column-key":"retail_batch_open",filters:t.enabledFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#4cd964"},on:{change:function(a){return t.handleRetailEnabled(e.row)}},model:{value:e.row.retail_batch_open,callback:function(a){t.$set(e.row,"retail_batch_open",a)},expression:"scope.row.retail_batch_open"}})]}}])})],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[a("el-form",{staticClass:"no-bottom-form",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"选中"}},[a("el-button",{attrs:{size:"small"},on:{click:t.checkEnable}},[t._v("开启")]),a("el-button",{attrs:{size:"small"},on:{click:t.checkDisable}},[t._v("关闭")])],1)],1)],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?a("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.list.per_page,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1)],1)}),[],!1,null,null,null)).exports,ua={name:"RetailUser",components:{},data:function(){return{}},mounted:function(){},methods:{}},fa={components:{RetailUser:Object(l.a)(ua,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",[t._v(" Hello ")])}),[],!1,null,null,null).exports,RetailProduct:da},props:{userInfo:{type:Object,default:null},_project:{default:"merchant"},_inBox:{}},data:function(){return{loading:!1,activeTab:"key",form:{retail_code:""},retail_code_check:{loading:!1,message:"",color:""}}},mounted:function(){this.userInfo?this.userInfo_=this.userInfo:this.userInfo_=this.$store.state.user.userInfo,this.form.retail_code=this.userInfo_.shop_retail_code},methods:{checkRetailCodeAvailable:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){var e,a,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=!(i.length>0&&void 0!==i[0])||i[0],!(this.form.retail_code.length<6)){t.next=5;break}return this.retail_code_check.message="对接密钥为 6 到 32 位",this.retail_code_check.color="#FF4949",t.abrupt("return",!1);case 5:if(!(this.form.retail_code.length>32)){t.next=9;break}return this.retail_code_check.message="对接密钥为 6 到 32 位",this.retail_code_check.color="#FF4949",t.abrupt("return",!1);case 9:if(e){t.next=11;break}return t.abrupt("return",""===this.retail_code_check.message);case 11:return this.retail_code_check.message="对接密钥检查中...请稍后",this.retail_code_check.color="#F7BA2A",this.retail_code_check.loading=!0,t.prev=14,t.next=17,Object(fe.c)(this.form.retail_code);case 17:if(!(a=t.sent).data||a.data.id===this.userInfo_.id&&"user"===a.message){t.next=24;break}this.retail_code_check.message="对接密钥已被使用，请重新输入",this.retail_code_check.color="#FF4949",this.$notify({title:"提示",message:this.retail_code_check.message,type:"error"}),t.next=27;break;case 24:return this.retail_code_check.message="",this.retail_code_check.color="",t.abrupt("return",!0);case 27:t.next=33;break;case 29:t.prev=29,t.t0=t.catch(14),this.retail_code_check.message="对接密钥检查失败，请重新输入";case 33:return t.prev=33,this.retail_code_check.loading=!1,t.finish(33);case 36:return t.abrupt("return",!1);case 37:case"end":return t.stop()}}),t,this,[[14,29,33,36]])})));return function(){return t.apply(this,arguments)}}(),handleRandomRetailCode:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.form.retail_code=Object(wt.c)(8).toLocaleUpperCase(),t.next=3,this.checkRetailCodeAvailable();case 3:if(!t.sent){t.next=5;break}this.handleEditRetailCode();case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),handleEditRetailCode:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.loading=!0,Bt(this.userInfo_.id,this.form.retail_code).then((function(){e.userInfo_.shop_retail_code=e.form.retail_code,e.$notify({message:"对接密钥保存成功",title:"提示",type:"success",duration:1e3})})).finally((function(){e.loading=!1}));case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}},pa=(a("f817"),Object(l.a)(fa,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"app-container":!t.userInfo&&!t._inBox}},[a("el-alert",{staticStyle:{"margin-bottom":"14px"},attrs:{type:"info",title:"说明"}},[a("div",{staticStyle:{"font-size":"14px"}},[t._v(" 商品开启分销功能后，可以添加到供货列表，代理通过【一键对接密钥】可以批量对接商品。 ")])]),a("el-tabs",{ref:"container",model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"供货设置",name:"key"}},[a("el-form",{staticClass:"retail-config-form",attrs:{"label-position":"top"}},[a("el-form-item",{attrs:{label:"一键对接密钥"}},[a("el-input",{ref:"retail_code",staticClass:"input-retail-code",attrs:{minlength:6,maxlength:32,disabled:t.retail_code_check.loading,placeholder:"请输入6-32位字符",size:"small"},model:{value:t.form.retail_code,callback:function(e){t.$set(t.form,"retail_code",e)},expression:"form.retail_code"}},[a("el-button",{attrs:{slot:"append",size:"mini",type:"text",disabled:t.retail_code_check.loading},on:{click:t.handleRandomRetailCode},slot:"append"},[t._v("随机 ")])],1),a("div",{staticClass:"el-form-item__tip",staticStyle:{height:"16px"},style:{color:t.retail_code_check.color}},[a("span",[t._v(t._s(t.retail_code_check.message))])]),a("div",[a("el-button",{attrs:{size:"small",loading:t.loading,disabled:t.loading},on:{click:t.handleEditRetailCode}},[t._v("保存")])],1)],1)],1)],1),a("el-tab-pane",{attrs:{label:"供货商品",name:"product"}},[a("retail-product",{attrs:{userInfo:t.userInfo}})],1),t._e()],1)],1)}),[],!1,null,null,null)).exports,ha=a("4278"),ma={props:{info:{}},data:function(){return{loading:!1,visible:!0,CARD_STATUS:ha.a,CARD_TYPE:ha.b,form:{id:0,product_id:0,card:"",type:ha.b.TYPE_ONETIME,count_all:null,count_sold:null},formRules:{card:[{required:!0,message:"请输入卡号",trigger:"blur"}]}}},watch:{visible:function(t){t||this.$emit("close",!1)}},mounted:function(){this.form.id=this.info.id,this.form.card=this.info.card,this.form.status=this.info.status,this.form.type=this.info.type,this.form.count_all=this.info.count_all,this.form.count_sold=this.info.count_sold},methods:{handleSubmit:function(){var t=this;this.$refs.form.validate((function(e){e&&(t.loading=!0,Object(ha.e)(t.form).then((function(){t.loading=!1,t.$notify({title:"提示",message:"编辑卡密成功",type:"success",duration:3e3}),t.handleClose(!0)})).catch((function(){t.loading=!1})))}))},handleClose:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}},_a=Object(l.a)(ma,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"编辑卡号",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",rules:t.formRules}},[a("el-form-item",{attrs:{label:"卡号",prop:"card"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入卡号"},model:{value:t.form.card,callback:function(e){t.$set(t.form,"card",e)},expression:"form.card"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[a("el-radio-button",{attrs:{label:t.CARD_TYPE.TYPE_ONETIME}},[t._v("一次性")]),a("el-radio-button",{attrs:{label:t.CARD_TYPE.TYPE_REPEAT}},[t._v("重复销售")])],1),t.form.type===t.CARD_TYPE.TYPE_REPEAT?a("span",{staticClass:"red-text",staticStyle:{"font-size":"12px",display:"block","line-height":"18px"}},[t._v("注意：将会限制商品最大购买量为1件")]):t._e()],1),t.form.type===t.CARD_TYPE.TYPE_REPEAT?a("el-form-item",{attrs:{label:"可售",prop:"count_all",rules:[{required:!0,message:"请输入可售总次数",trigger:"blur"},{type:"number",min:t.form.count_sold,message:"可售总次数不能低于当前已售次数"},{type:"number",max:1e7,message:"可售总次数不能超过10000000"}]}},[a("el-input",{attrs:{type:"number",placeholder:"请输入可售总次数"},model:{value:t.form.count_all,callback:function(e){t.$set(t.form,"count_all",t._n(e))},expression:"form.count_all"}}),a("span",[t._v("当前已售出 "+t._s(t.form.count_sold)+"次")])],1):t._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){return t.handleClose(!1)}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("确认编辑 ")])],1)],1)}),[],!1,null,null,null).exports,ga=a("cd80").a,ba=Object(l.a)(ga,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"app-container":!t.inBox}},[a("h3",{staticStyle:{margin:"4px 0 28px 0"}},[t._v("添加卡密")]),a("el-form",{ref:"form",attrs:{model:t.form,"label-width":t.labelWidth,rules:t.formRules}},[a("el-form-item",{attrs:{label:"类型"}},[a("el-radio-group",{attrs:{size:"small"},on:{change:t.handleTypeChange},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[a("el-radio-button",{attrs:{label:t.CARD_TYPE.TYPE_ONETIME}},[t._v("一次性")]),a("el-radio-button",{attrs:{label:t.CARD_TYPE.TYPE_REPEAT}},[t._v("重复销售")])],1),t.form.type===t.CARD_TYPE.TYPE_REPEAT?a("span",{staticClass:"red-text",staticStyle:{"font-size":"12px",display:"block","line-height":"18px"}},[t._v("注意：将会限制商品最大购买量为1件")]):t._e()],1),a("el-form-item",{attrs:{label:"商品",prop:"product_id"}},[a("el-select",{attrs:{filterable:"","no-data-text":"请先添加分类"},on:{change:t.getProducts},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1),a("el-select",{attrs:{filterable:""},model:{value:t.form.product_id,callback:function(e){t.$set(t.form,"product_id",e)},expression:"form.product_id"}},t._l(t.products,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1)],1),a("el-form-item",{attrs:{label:"卡密",prop:"card"}},[t.form.type===t.CARD_TYPE.TYPE_ONETIME?a("el-input",{attrs:{type:"textarea",autosize:{minRows:10,maxRows:10},placeholder:"卡号+空格+密码，一行一张卡\n如：ABCDEFG 123456\n(卡密长度不得超过200位)\n\n(建议每次添加不超过10000张)"},model:{value:t.form.card,callback:function(e){t.$set(t.form,"card",e)},expression:"form.card"}}):a("el-input",{attrs:{type:"text",placeholder:"卡号+空格+密码"},model:{value:t.form.card,callback:function(e){t.$set(t.form,"card",e)},expression:"form.card"}})],1),t.form.type===t.CARD_TYPE.TYPE_REPEAT?a("el-form-item",{attrs:{label:"可售",prop:"count_all",rules:[{required:!0,message:"请输入可售总次数",trigger:"blur"},{type:"number",min:1,max:1e7,message:"可售总次数不能超过10000000"}]}},[a("el-input",{attrs:{type:"number",placeholder:"请输入可售总次数"},model:{value:t.form.count_all,callback:function(e){t.$set(t.form,"count_all",t._n(e))},expression:"form.count_all"}})],1):t._e(),a("el-form-item",[a("el-tooltip",{attrs:{effect:"dark",content:"选中后表示重复的卡密将不会加入库存中",placement:"top-start"}},[a("el-checkbox",{model:{value:t.form.is_check,callback:function(e){t.$set(t.form,"is_check",e)},expression:"form.is_check"}},[t._v("检查重复的卡密")])],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.loading||t.uploading},on:{click:t.onSubmit}},[t._v("添加")]),"admin"===t._project||"merchant"===t._project?a("p",{staticClass:"red-text"},[t._v("注意：最多可以添加 "),a("b",[t._v("10000")]),t._v(" 条卡密记录（不包含已售出）（重复销售类型只算1条），"),a("br"),t._v(" 超出限制会添加失败，请合理配置商品库存。")]):t._e()],1)],1),t.uploading?a("div",{staticClass:"v-modal",staticStyle:{"z-index":"1010"}}):t._e(),t.uploading?a("div",{staticClass:"el-message-box__wrapper",staticStyle:{"z-index":"1011"}},[a("div",{staticStyle:{position:"relative",display:"inline-block",width:"250px","background-color":"#fff","border-radius":"4px",border:"1px solid #ebeef5"}},[a("p",[t._v("正在上传 "+t._s(t.upload.now)+"/"+t._s(t.upload.all))])])]):t._e()],1)}),[],!1,null,null,null).exports,va={props:{userInfo:{type:Object,default:null},_trashed:{default:!1},_project:{default:"merchant"},filter:{}},components:{cardEdit:_a,cardAdd:ba},data:function(){return{loading:!1,showAddBox:!1,addBoxLoaded:!1,destroying:!1,onlyTrashed:!1,CARD_TYPE:ha.b,CARD_STATUS:ha.a,search:{type:"card",value:""},where:{category_id:-1,product_id:-1,onlyCanSell:1},categories:[{id:-2,name:"加载中"}],products:[{id:-2,name:"加载中"}],list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",statusFilter:[{text:"未售",value:ha.a.STATUS_NORMAL,type:"primary"},{text:"已售",value:ha.a.STATUS_SOLD,type:"info"}],statusFilterValue:[],typeFilter:[{text:"重复卖",value:ha.b.TYPE_REPEAT,type:"info"},{text:"一次性",value:ha.b.TYPE_ONETIME,type:"info"}],editInfo:null}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},created:function(){this.onlyTrashed=this._trashed},mounted:function(){var t,e,a;this.$route.query.category_id&&this.$route.query.product_id&&this.$route.query.type&&(t=this.$route.query.type,e=parseInt(this.$route.query.category_id),a=parseInt(this.$route.query.product_id)),this.filter&&this.filter.category_id&&this.filter.product_id&&this.filter.type&&(t=this.filter.type,e=parseInt(this.filter.category_id),a=parseInt(this.filter.product_id)),t&&e&&a?this.searchBy_(t,e,a):(this.handleSearch(),this.getCategories())},methods:{searchBy_:function(t,e,a){this.where.category_id=e,this.where.product_id=a,"count"===t?(this.where.onlyCanSell=1,this.statusFilterValue.splice(0,this.statusFilterValue.length),this.where.status=""):"count_sold"===t&&(this.where.onlyCanSell=0,this.statusFilterValue.push(ha.a.STATUS_SOLD),this.where.status=this.statusFilterValue.join(",")),this.handleSearch(),this.getCategories()},handleOnlyCanSell:function(){this.where.onlyCanSell&&(this.statusFilterValue.splice(0,this.statusFilterValue.length),this.where.status=""),this.handleSearch()},getCategories:function(){var t=this;this.loading=!0;var e={search:"simple",val:"list"};this.userInfo&&(e.user_id=this.userInfo.id),Object(ue.d)(e).then((function(e){t.categories=e.data,t.where.category_id>0&&t.where.product_id>0&&t.getProducts(t.where.category_id,t.where.product_id)}))},getProducts:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.where.product_id=a,this.getList(),this.products=[];var i={search:"simple",val:t,from:"card"};this.userInfo&&(i.user_id=this.userInfo.id),Object(fe.h)(i).then((function(t){e.products=t.data}))},_generateWhere:function(){return this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,this.where.trashed=this.onlyTrashed,this.userInfo&&(this.where.user_id=this.userInfo.id),this.where},getList:function(){var t=this;this.loading=!0,Object(ha.f)(this._generateWhere()).then((function(e){t.list=e.data,t.loading=!1}))},handleSearch:function(){var t={search:this.search.type,val:this.search.value};Object.assign(this.where,t),this.getList()},handleExport:function(){window.open(window.API_URL+"card/export?"+Object(wt.b)(this.where)+"&token="+encodeURIComponent(this.$store.state.user.token),"_blank")},handleFilterChange:function(t){var e={};t.status?e.status=t.status.join(","):e.status=null,t.type?e.type=t.type.join(","):e.type=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},handleDelete:function(t){var e=this,a=t.card;this.$confirm("删除卡密"+a+"? 您可以稍后在回收站查看","提示",{type:"warning"}).then((function(){e.loading=!0,Object(ha.g)(t.id).then((function(){e.$notify({title:"操作完成",message:"卡密"+a+"已删除",type:"info"}),e.getList()})).catch((function(){e.loading=!1}))}))},handleTrashDelete:function(t){var e=this,a=t.card;this.$confirm("销毁卡密"+a+"? 此操作不可恢复","提示",{type:"warning"}).then((function(){e.loading=!0,Object(ha.h)(t.id).then((function(){e.$notify({title:"操作完成",message:"卡密"+a+"已销毁",type:"info"}),e.getList()})).catch((function(){e.loading=!1}))}))},handleRestore:function(t){var e=this,a=t.card;this.$confirm("还原卡密"+a+"? ","提示",{type:"warning"}).then((function(){e.loading=!0,Object(ha.i)(t.id).then((function(){e.$notify({title:"操作完成",message:"卡密"+a+"已还原",type:"success"}),e.getList()})).catch((function(){e.loading=!1}))}))},checkDelete:function(){var t=this;this.checkedIds.length&&this.$confirm("批量删除选中卡密? 您可以稍后在回收站查看","提示",{type:"warning"}).then((function(){t.loading=!0,Object(ha.g)(t.checkedIds).then((function(){t.$notify({title:"操作完成",message:"选中卡密已删除",type:"info"}),t.getList()})).catch((function(){t.loading=!1}))}))},checkTrashDelete:function(){var t=this;this.checkedIds.length&&this.$confirm("批量销毁选中卡密? 此操作不可恢复","提示",{type:"warning"}).then((function(){t.loading=!0,Object(ha.h)(t.checkedIds).then((function(){t.$notify({title:"操作完成",message:"选中卡密已销毁",type:"info"}),t.getList()})).catch((function(){t.loading=!1}))}))},checkRestore:function(){var t=this;this.checkedIds.length&&this.$confirm("批量还原选中卡密? ","提示",{type:"warning"}).then((function(){t.loading=!0,Object(ha.i)(t.checkedIds).then((function(){t.$notify({title:"操作完成",message:"选中卡密已还原",type:"success"}),t.getList()})).catch((function(){t.loading=!1}))}))},handleDeleteAll:function(){var t=this;this.$confirm("是否"+(this.onlyTrashed?"清空当前回收站":"删除当前卡密")+"列表?<br> (当前列表共"+this.list.total+"条)","警告",{type:"warning",dangerouslyUseHTMLString:!0}).then((function(){t.loading=!0,Object(ha.d)(t._generateWhere()).then((function(){t.$notify({title:"操作完成",message:t.onlyTrashed?"当前回收站列表已清空":"当前卡密列表已删除",type:"info"}),t.getList()})).catch((function(){t.loading=!1}))}))},handleRestoreAll:function(){var t=this;this.$confirm("是否还原当前回收站列表?<br> (当前列表共"+this.list.total+"条)","询问",{type:"warning",dangerouslyUseHTMLString:!0}).then((function(){t.loading=!0,Object(ha.j)(t._generateWhere()).then((function(){t.$notify({title:"操作完成",message:"当前回收站列表已还原",type:"success"}),t.getList()})).catch((function(){t.loading=!1}))}))},handleAdd:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e={},+this.where.category_id>0&&(e.category_id=+this.where.category_id),+this.where.product_id>0&&(e.product_id=+this.where.product_id),this.$router.push({path:"/m/product/card/add",query:e}),t.next=16;break;case 7:t.next=11;break;case 11:return window.scrollTo(0,0),this.addBoxLoaded=!0,t.next=15,this.$nextTick();case 15:this.showAddBox=!0;case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),onAdd:function(){this.getList(),this.showAddBox=!1},handleEdit:function(t){this.editInfo=t},editCallback:function(t){this.editInfo=null,t&&this.getList()},toggleTrash:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.onlyTrashed=!this.onlyTrashed,this.destroying=!0,t.next=4,this.$nextTick();case 4:this.destroying=!1,this.getList();case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}},ya=Object(l.a)(va,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",class:{"app-container":!t.userInfo}},[a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showAddBox,expression:"showAddBox"}],staticClass:"apply-box"},[a("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",type:"danger",size:"small"},on:{click:function(e){t.showAddBox=!1}}}),t.showAddBox||t.addBoxLoaded?a("el-card",{staticClass:"my-card"},[a("card-add",{attrs:{"in-box":!0,userInfo:t.userInfo,category_id:t.where.category_id,product_id:t.where.product_id},on:{submit:t.onAdd}})],1):t._e()],1)]),a("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[a("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[a("el-form-item",{staticClass:"mobile-full-width"},[a("el-select",{staticClass:"mobile-full-width",attrs:{filterable:"",size:"small","no-data-text":"无分类数据"},on:{change:t.getProducts},model:{value:t.where.category_id,callback:function(e){t.$set(t.where,"category_id",e)},expression:"where.category_id"}},[a("el-option",{attrs:{label:"全部分类",value:-1}}),t._l(t.categories,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],2),t.where.category_id>0?a("el-select",{staticClass:"mobile-full-width",attrs:{filterable:"",size:"small"},on:{change:t.getList},model:{value:t.where.product_id,callback:function(e){t.$set(t.where,"product_id",e)},expression:"where.product_id"}},[a("el-option",{attrs:{label:"全部商品",value:-1}}),t._l(t.products,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2):t._e()],1),a("el-form-item",{staticClass:"mobile-full-width"},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[a("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[a("el-option",{attrs:{label:"ID",value:"id"}}),a("el-option",{attrs:{label:"卡号",value:"card"}})],1)],1)],1),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),a("el-form-item",{staticClass:"mobile-full-width"},[t.onlyTrashed?t._e():a("el-switch",{attrs:{"inactive-text":"只显示可售","active-value":1,"inactive-value":0},on:{change:t.handleOnlyCanSell},model:{value:t.where.onlyCanSell,callback:function(e){t.$set(t.where,"onlyCanSell",e)},expression:"where.onlyCanSell"}}),"admin"===t._project?a("el-button",{staticStyle:{"margin-left":"12px","line-height":"20px"},attrs:{type:"text"},on:{click:t.toggleTrash}},[a("icon",{attrs:{name:t.onlyTrashed?"regular/undo":"light/trash-alt"}}),t._v(" "+t._s(t.onlyTrashed?"卡密列表":"回收站")+" ")],1):t._e()],1),a("el-form-item",{staticClass:"right-toolbox"},[a("el-link",{on:{click:t.handleExport}},[a("icon",{attrs:{name:"light/file-alt"}}),t._v(" "+t._s("导出("+t.list.total+")")+" ")],1),t.onlyTrashed?t._e():a("el-link",{on:{click:t.handleAdd}},[a("icon",{attrs:{name:"regular/plus"}}),t._v(" 添加 ")],1)],1)],1)],1),t.destroying?t._e():a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map((function(t){return t.id})).join(",")}}},[a("el-table-column",{attrs:{type:"selection",width:"40"}}),"admin"===t._project?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),"admin"!==t._project||t.userInfo?t._e():a("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"}}),a("el-table-column",{attrs:{prop:"card",label:"卡密","min-width":"180","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"product",label:"所属商品","min-width":"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.product?e.row.product.name:"未知商品#"+e.row.product_id)+" ")]}}],null,!1,1308817e3)}),a("el-table-column",{attrs:{prop:"type",label:"类型",width:"90","column-key":"type",filters:t.typeFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:(e.row.type,t.CARD_TYPE.TYPE_ONETIME,"info")}},[t._v(" "+t._s(e.row.type===t.CARD_TYPE.TYPE_ONETIME?"一次性":"重复卖")+" ")])]}}],null,!1,4198747192)}),a("el-table-column",{attrs:{prop:"status",label:"售出状态",width:"90","column-key":"status",filters:t.statusFilter,"filtered-value":t.statusFilterValue,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.type===t.CARD_TYPE.TYPE_ONETIME?a("el-tag",{attrs:{type:e.row.status===t.CARD_STATUS.STATUS_SOLD?"info":"primary"}},[t._v(" "+t._s(e.row.status===t.CARD_STATUS.STATUS_SOLD?"已售":"未售")+" ")]):a("el-tag",{attrs:{type:e.row.count_sold>0?"info":"primary"}},[t._v(" "+t._s(e.row.count_sold+"/"+e.row.count_all)+" ")])]}}],null,!1,3667718195)}),t.onlyTrashed?t._e():a("el-table-column",{attrs:{prop:"created_at",label:"添加时间",width:"150"}}),t.onlyTrashed?a("el-table-column",{attrs:{prop:"deleted_at",label:"删除时间",width:"150"}}):t._e(),a("el-table-column",{attrs:{label:"操作",width:t.onlyTrashed?"120":"50",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.onlyTrashed?t._e():a("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:function(a){return t.handleEdit(e.row)}}},[a("icon",{attrs:{name:"light/pencil"}})],1),t.onlyTrashed?t._e():a("a",{staticClass:"icon-btn",on:{click:function(a){return t.handleDelete(e.row)}}},[a("icon",{attrs:{name:"light/trash-alt"}})],1),t.onlyTrashed?a("a",{staticClass:"icon-btn",on:{click:function(a){return t.handleTrashDelete(e.row)}}},[a("icon",{attrs:{name:"light/trash-alt"}}),t._v(" 销毁 ")],1):t._e(),t.onlyTrashed?a("a",{staticClass:"icon-btn",on:{click:function(a){return t.handleRestore(e.row)}}},[a("icon",{attrs:{name:"regular/undo"}}),t._v(" 还原 ")],1):t._e()]}}],null,!1,103567840)})],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[a("el-form",{staticClass:"no-bottom-form"},[a("el-form-item",{attrs:{label:""}},[t.onlyTrashed?t._e():a("el-button",{attrs:{size:"small"},on:{click:t.checkDelete}},[t._v("选中删除")]),t.onlyTrashed?a("el-button",{attrs:{size:"small"},on:{click:t.checkTrashDelete}},[t._v("选中销毁")]):t._e(),t.onlyTrashed?a("el-button",{attrs:{size:"small"},on:{click:t.checkRestore}},[t._v("选中还原")]):t._e(),t.onlyTrashed?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.handleRestoreAll}},[t._v("全部还原")]):t._e(),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:t.handleDeleteAll}},[t._v(" "+t._s(t.onlyTrashed?"全部销毁":"全部删除")+" ")])],1)],1)],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?a("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.list.per_page,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t.editInfo?a("card-edit",{attrs:{info:t.editInfo},on:{close:t.editCallback}}):t._e()],1)}),[],!1,null,null,null).exports,wa={components:{cardList:ya}},Ca=Object(l.a)(wa,(function(){var t=this.$createElement;return(this._self._c||t)("card-list",{attrs:{_trashed:!0}})}),[],!1,null,null,null).exports,xa={name:"exportDialog",data:function(){return{visible:!0,SEND_STATUS:ot,status:-1,card:""}},methods:{handleSubmit:function(){this.$emit("export",{status:this.status,card:this.card})}}},ka=Object(l.a)(xa,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"导出订单",visible:t.visible},on:{"update:visible":function(e){t.visible=e},close:function(e){return t.$emit("close")}}},[a("div",[a("p",[t._v("导出同时改变状态")]),a("el-select",{attrs:{size:"small"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[a("el-option",{attrs:{label:"不改变状态",value:-1}}),a("el-option",{attrs:{label:"标记位已完成",value:t.SEND_STATUS.CARD_SUCCESS.id}}),a("el-option",{attrs:{label:"标记位正在处理",value:t.SEND_STATUS.CARD_PROCESSING.id}})],1),t.status===t.SEND_STATUS.CARD_SUCCESS.id?a("div",[a("p",[t._v("请输入发货卡密(当前导出订单都将使用此相同卡密)")]),a("el-input",{attrs:{autocomplete:"false",size:"small"},model:{value:t.card,callback:function(e){t.card=e},expression:"card"}})],1):t._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){return t.$emit("close")}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确认导出")])],1)])}),[],!1,null,"f685ff20",null).exports,Ia=-1001,Aa=window.config.functions&&window.config.functions.includes("product_manual"),Sa={props:{userInfo:{type:Object,default:null},recentDay:{default:!1},onlyProfit:{default:!1},_project:{default:"merchant"}},components:{ExportDialog:ka,OrderInfo:Me},data:function(){return{isMobile:this.$store.state.app.isMobile,loading:!1,ORDER_STATUS:rt,SEND_STATUS:ot,API_ORDER_ID:Ia,ID_INNER_RETAIL:-1,PRODUCT_MANUAL:Aa,search:{type:"order_no",value:""},date_range:"",where:{category_id:-1,product_id:-1,showUnPay:0,showUnSend:0},categories:[{id:-2,name:"加载中"}],products:[{id:-2,name:"加载中"}],list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0,profit_sum:{income:0,profit:0}},checkedVal:[],statusFilter:function(){var t=[];for(var e in rt)rt.hasOwnProperty(e)&&"object"===Object(F.a)(rt[e])&&t.push({text:rt[e].name,value:rt[e].id,type:rt[e].type});return t}(),statusFilterValue:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},exportDialogVisible:!1,destroyForLoad:!1,isApiOrder:!1,orderInfo:null}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()},isApiOrder:function(){var t=this;this.destroyForLoad=!0,this.$nextTick((function(){t.destroyForLoad=!1}))}},mounted:function(){"api"===this.$route.query.type&&(this.where.category_id=Ia,this.isApiOrder=!0),"admin"===this._project?(this.categories=[],this._loadOrders()):this.getCategories()},methods:{getCategories:function(){var t=this;this.loading=!0;var e={search:"simple",val:"list"};this.userInfo&&(e.user_id=this.userInfo.id),Object(ue.d)(e).then((function(e){t.categories=e.data,t._loadOrders()}))},_loadOrders:function(){"paid"===this.$route.query.status?(this.where.showUnSend=1,this.handleShowUnSend(1)):"un_pay"===this.$route.query.status?(this.where.showUnPay=1,this.handleShowUnPay(1)):this.handleShowWithoutUnpay()},changeCategory:function(t){this.list.current_page=1,this.list.from=1,this.list.last_page=1,this.list.to=1,this.list.total=0,this.list.data=[],this.isApiOrder?t!==Ia?(this.isApiOrder=!1,this.getList()):this.getList():t===Ia?(this.isApiOrder=!0,this.getList()):this.getProducts(t)},getProducts:function(t){var e=this;this.getList(),this.where.product_id=-1,this.products=[];var a={search:"simple",val:t};this.userInfo&&(a.user_id=this.userInfo.id),Object(fe.h)(a).then((function(t){e.products=t.data}))},getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,this.where.recent=this.recentDay,this.where.profit=this.onlyProfit?1:0,this.userInfo&&(this.where.user_id=this.userInfo.id),function(t){return Object(T.a)({url:"order",method:"get",params:t})}(this.where).then((function(e){t.list=e.data,t.loading=!1}))},handleSearch:function(){var t={search:this.search.type,val:this.search.value};this.date_range&&this.date_range[0]&&this.date_range[1]?(t.start_at=this.date_range[0].format("yyyy-MM-dd"),t.end_at=this.date_range[1].format("yyyy-MM-dd")):(t.start_at=null,t.end_at=null),Object.assign(this.where,t),this.getList()},handleExport:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=Object.assign({},this.where);if(Aa){if(!1===t)return void(this.exportDialogVisible=!0);e.export_update_status=t.status,e.export_update_card=t.card}window.open(window.API_URL+"order/export?"+Object(wt.b)(e)+"&token="+encodeURIComponent(this.$store.state.user.token),"_blank")},handleShowUnPay:function(t){t?(this.where.showUnSend=0,this.statusFilterValue.splice(0,this.statusFilterValue.length),this.statusFilterValue.push(rt.UN_PAY.id)):this.handleShowWithoutUnpay(),this.where.status=this.statusFilterValue.join(","),this.handleSearch()},handleShowUnSend:function(t){t?(this.where.showUnPay=0,this.statusFilterValue.splice(0,this.statusFilterValue.length),this.statusFilterValue.push(rt.PAID.id)):this.handleShowWithoutUnpay(),this.where.status=this.statusFilterValue.join(","),this.handleSearch()},handleShowWithoutUnpay:function(){var t;(t=this.statusFilterValue).splice.apply(t,[0,this.statusFilterValue.length].concat([rt.FROZEN.id,rt.SUCCESS.id,rt.PAID.id,rt.REFUND.id])),this.where.status="",this.handleSearch()},onFilterChange:function(t){var e={};t.status?e.status=t.status.join(","):e.status=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},showCards:function(t){t.card_orders&&t.card_orders.length&&this.$msgbox({title:"卡密详情",message:'<textarea rows="6" style="width: 100%" readonly>'+Object(wt.a)(t.card_orders.map((function(t){return t.card?t.card.card:"未知卡密#"+t.card_id})).join("\n"))+"</textarea>",dangerouslyUseHTMLString:!0})},showRemark:function(t){var e=this;this.$prompt("可以在这里修改备注","提示",{confirmButtonText:"保存",cancelButtonText:"取消",inputValue:t.remark,inputPattern:/^[\s\S]{0,100}$/,inputErrorMessage:"备注需100字符以内",inputType:"textarea",closeOnClickModal:!1}).then((function(a){var i=a.value;e.loading=!0,function(t,e){return Object(T.a)({url:"order/remark",method:"post",data:{id:t,remark:e}})}(t.id,i).then((function(){e.loading=!1,t.remark=i})).catch((function(){e.loading=!1}))}))},showOrder:function(t){this.orderInfo=t},handleFreeze:function(t){var e=this;if(-1===t.pay_id)return this.$msgbox({title:"提示",message:"此订单为分销商品自动生成的订单,  请操作原始订单",type:"error"});this.$prompt("冻结订单 ".concat(t.order_no," ? <br>请输入与冻结原因"),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"保存",cancelButtonText:"取消",inputValue:t.frozen_reason,inputPattern:/^[\s\S]{2,100}$/,inputErrorMessage:"冻结原因需2-100字符以内",inputType:"textarea",closeOnClickModal:!1}).then((function(a){var i=a.value;e.loading=!0,lt(t.id,i).then((function(a){return 1!==a.data[0]?e.$msgbox({title:"操作失败",message:"未知错误",type:"error"}):1!==a.data[1]?e.$msgbox({title:"操作失败",message:"冻结订单失败, 内部错误",type:"error"}):(e.$notify({title:"操作完成",message:t.order_no+" 已冻结",type:"success"}),void(t.status=rt.FROZEN.id))})).finally((function(){e.loading=!1}))}))},handleUnfreeze:function(t){var e=this;if(-1===t.pay_id)return this.$msgbox({title:"提示",message:"此订单为分销商品自动生成的订单,  请操作原始订单",type:"error"});this.$confirm("解冻订单 "+t.order_no+" ? ","提示",{type:"warning"}).then((function(){e.loading=!0,ct(t.id).then((function(a){return 1!==a.data[0]?e.$msgbox({title:"操作失败",message:"未知错误",type:"error"}):1!==a.data[1]?e.$msgbox({title:"操作失败",message:"解冻订单失败, 内部错误",type:"error"}):(e.$notify({title:"操作完成",message:t.order_no+" 已解冻",type:"success"}),void(t.status=a.data[2]))})).finally((function(){e.loading=!1}))}))},handleRefund:function(t){var e=this;if(-1===t.pay_id)return this.$msgbox({title:"提示",message:"此订单为分销商品自动生成的订单,  请操作原始订单",type:"error"});var a=!1,i=this.$createElement;this.$confirm(i("div",{key:Object(wt.c)()},[i("p",null,"退款订单"+t.order_no+"（支付金额 ￥"+(t.paid/100).toFixed(2)+") "),i("p",null,"此操作不可恢复"),i("ElCheckbox",{props:{checked:a},on:{change:function(t){a=t}}},"自动请求支付渠道发起退款")]),"询问",{type:"warning",dangerouslyUseHTMLString:!0}).then((function(){e.loading=!0,dt(t.id,a).then((function(a){return 1!==a.data[0]?e.$msgbox({title:"操作失败",message:"未知错误",type:"error"}):1!==a.data[1]?e.$msgbox({title:"操作失败",message:"退款订单失败, 内部错误",type:"error"}):(e.$notify({title:"操作完成",message:t.order_no+" 已退款",type:"success"}),void(t.status=rt.REFUND.id))})).finally((function(){e.loading=!1}))}))},checkFreeze:function(){var t=this;if(this.checkedVal.length){if(1===this.checkedVal.length)return this.handleFreeze(this.checkedVal[0]);var e=this.checkedVal.map((function(t){return t.id})).join(",");this.$prompt("批量冻结选中订单? (只冻结交易成功订单) <br>请输入与冻结原因","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确认",cancelButtonText:"取消",inputPattern:/^[\s\S]{2,100}$/,inputErrorMessage:"冻结原因需2-100字符以内",inputType:"textarea",closeOnClickModal:!1}).then((function(a){var i=a.value;t.loading=!0,lt(e,i).then((function(e){t.$notify({title:"操作完成",message:"总订单: ".concat(e.data[0]," 笔，冻结成功 ").concat(e.data[1]," 笔"),type:e.data[0]&&e.data[0]===e.data[1]?"success":"info"}),t.getList()})).catch((function(){t.loading=!1}))}))}},checkUnfreeze:function(){var t=this;if(this.checkedVal.length){if(1===this.checkedVal.length)return this.handleUnfreeze(this.checkedVal[0]);var e=this.checkedVal.map((function(t){return t.id})).join(",");this.$confirm("批量解冻选中订单? (只处理已冻结订单)","提示",{type:"warning"}).then((function(){ct(e).then((function(e){t.$notify({title:"操作完成",message:"总订单: ".concat(e.data[0]," 笔，解冻成功 ").concat(e.data[1]," 笔"),type:e.data[0]&&e.data[0]===e.data[1]?"success":"info"}),t.getList()})).catch((function(){t.loading=!1}))}))}},checkRefund:function(){var t=this;if(this.checkedVal.length){if(1===this.checkedVal.length)return this.handleRefund(this.checkedVal[0]);var e=this.checkedVal.map((function(t){return t.id})).join(",");this.$confirm("批量退款选中订单? (请手动联系用户打款)","提示",{type:"warning"}).then((function(){dt(e).then((function(e){t.$notify({title:"操作完成",message:"总订单: ".concat(e.data[0]," 笔，退款成功 ").concat(e.data[1]," 笔"),type:e.data[0]&&e.data[0]===e.data[1]?"success":"info"}),t.getList()})).catch((function(){t.loading=!1}))}))}},handleSetPaid:function(t){var e=this;if(-1===t.pay_id)return this.$msgbox({title:"提示",message:"此订单为分销商品自动生成的订单,  请操作原始订单",type:"error"});var a=t.pay?t.pay.name:"支付方式#"+t.pay_id;this.$prompt("请仔细确认已经收到款项，<br>确认将订单 ".concat(t.order_no," 设置为已付款并发货? <br>请输入").concat(a,"内单号(流水号)"),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确认",cancelButtonText:"取消",inputPattern:/^[\s\S]{2,100}$/,inputErrorMessage:"单号需2-100字符以内",inputType:"text",closeOnClickModal:!1}).then((function(a){var i=a.value;e.loading=!0,function(t,e){return Object(T.a)({url:"order/set_paid",method:"post",data:{id:t,trade_no:e}})}(t.id,i).then((function(a){var i=a.data;if(e.loading=!1,Object.assign(t,i.order),0!==i.code)return e.$msgbox({title:"提示",message:i.msg,type:"error",dangerouslyUseHTMLString:!0});e.$notify({title:"操作完成",message:t.order_no+" 已补单成功",type:"success"})})).catch((function(){e.loading=!1}))}))},handleSendCard:function(t){var e=this;if(!t.product)return this.$msgbox("订单对应商品不存在, 无法发货");(t.product.delivery===fe.a.AUTO?this.$confirm("当前订单状态为<".concat(rt.get(t.status).name,">, 是否确认发货?"),"询问"):this.$prompt("当前订单状态为<".concat(rt.get(t.status).name,">, 是否确认发货?<br>请输入发货卡密"),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确认",cancelButtonText:"取消",inputValue:"已充值成功",inputPattern:/^[\s\S]{1,255}$/,inputErrorMessage:"需1-255字符以内",inputType:"text",closeOnClickModal:!1})).then((function(a){var i=a.value;e.loading=!0,st(t.id,i).then((function(a){Object.assign(t,a.data),e.$notify({title:"发货成功",message:"当前订单已发货成功",type:"success",duration:3e3})})).finally((function(){e.loading=!1}))}))},handleSetSendStatus:function(t,e){if(e===ot.CARD_SUCCESS.id)return this.handleSendCard(t);var a=t.send_status;t.send_status=e,function(t,e){return Object(T.a)({url:"order/set_send_status",method:"post",data:{id:t,send_status:e}})}(t.id,e).catch((function(){t.send_status=a}))}}},Oa=(a("074a"),Object(l.a)(Sa,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",class:{"app-container":!t.userInfo}},[a("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[a("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[t.onlyProfit?t._e():a("el-form-item",{staticClass:"mobile-full-width"},[a("el-select",{staticClass:"mobile-full-width",attrs:{filterable:"",size:"small","popper-class":"el-select-group-less-padding","no-data-text":"无分类数据"},on:{change:t.changeCategory},model:{value:t.where.category_id,callback:function(e){t.$set(t.where,"category_id",e)},expression:"where.category_id"}},["admin_free"!==t._project?a("el-option-group",{attrs:{label:"API订单"}},[a("el-option",{attrs:{label:"所有订单(API)",value:t.API_ORDER_ID}})],1):t._e(),a("el-option-group",{attrs:{label:"卡密订单"}},[a("el-option",{attrs:{label:"所有订单",value:-1}}),t._l(t.categories,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],2)],1),t.where.category_id>0?a("el-select",{staticClass:"mobile-full-width",attrs:{filterable:"",size:"small"},on:{change:t.getList},model:{value:t.where.product_id,callback:function(e){t.$set(t.where,"product_id",e)},expression:"where.product_id"}},[a("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.products,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2):t._e()],1),a("el-form-item",{staticClass:"mobile-full-width"},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[a("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[a("el-option",{attrs:{label:"订单号",value:"order_no"}}),a("el-option",{attrs:{label:"支付渠道单号",value:"pay_trade_no"}}),t.isApiOrder?a("el-option",{attrs:{label:"商户订单号(API)",value:"api_out_no"}}):t._e(),t.isApiOrder?a("el-option",{attrs:{label:"附加信息(API)",value:"api_info"}}):t._e(),"admin"===t._project?a("el-option",{attrs:{label:"商户ID",value:"user_id"}}):t._e(),t.isApiOrder||t.onlyProfit?t._e():a("el-option",{attrs:{label:"买家联系方式",value:"contact"}})],1)],1)],1),t.recentDay?t._e():a("el-form-item",{staticClass:"mobile-full-width"},[a("el-date-picker",{attrs:{size:"small",type:"daterange",align:"right",placeholder:"日期范围","picker-options":t.pickerOptions},model:{value:t.date_range,callback:function(e){t.date_range=e},expression:"date_range"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),a("div",{staticClass:"mobile-full-width"}),t.onlyProfit?t._e():a("el-form-item",[a("el-switch",{attrs:{"inactive-text":"未支付订单","active-value":1,"inactive-value":0},on:{change:t.handleShowUnPay},model:{value:t.where.showUnPay,callback:function(e){t.$set(t.where,"showUnPay",e)},expression:"where.showUnPay"}})],1),t.onlyProfit||t.isApiOrder?t._e():a("el-form-item",[a("el-switch",{attrs:{"inactive-text":"待发货订单","active-value":1,"inactive-value":0},on:{change:t.handleShowUnSend},model:{value:t.where.showUnSend,callback:function(e){t.$set(t.where,"showUnSend",e)},expression:"where.showUnSend"}})],1),a("el-form-item",{staticClass:"right-toolbox"},[a("el-link",{on:{click:function(e){return t.handleExport()}}},[a("icon",{attrs:{name:"light/file-alt"}}),t._v(" "+t._s("导出("+t.list.total+")")+" ")],1)],1)],1)],1),t.onlyProfit?a("el-col",{staticClass:"list-after-action",attrs:{span:24}},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"my-card",staticStyle:{"box-shadow":"none"}},[a("div",{staticStyle:{"font-size":"14px"}},[t._v(" 总收入: "+t._s(t._f("moneyFormatterFilter")(t._f("moneyFilter")(parseInt(t.list.profit_sum.income))))+"， 总利润： "+t._s(t._f("moneyFormatterFilter")(t._f("moneyFilter")(parseInt(t.list.profit_sum.profit))))+" ")])])],1):t._e(),t.destroyForLoad?t._e():a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.onFilterChange,"selection-change":function(e){return t.checkedVal=e}}},["admin"===t._project?a("el-table-column",{attrs:{type:"selection",width:"40"}}):t._e(),"admin"!==t._project||t.userInfo?t._e():a("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"}}),a("el-table-column",{attrs:{prop:"order_no",label:"订单号(点击查看)",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"line-btn",on:{click:function(a){return t.showOrder(e.row)}}},[t._v(t._s(e.row.order_no))])]}}],null,!1,1266714438)}),t.onlyProfit?t._e():a("el-table-column",{attrs:{prop:"status",label:"状态",width:"80","column-key":"status",filters:t.statusFilter,"filtered-value":t.statusFilterValue,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.ORDER_STATUS.get(e.row.status).type}},[t._v(" "+t._s(t.ORDER_STATUS.get(e.row.status).name)+" ")])]}}],null,!1,1673817335)}),!t.onlyProfit&&t.PRODUCT_MANUAL?a("el-table-column",{attrs:{prop:"status",label:"发货状态",width:"100","column-key":"status","filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.send_status===t.SEND_STATUS.CARD_UN.id||e.row.send_status===t.SEND_STATUS.CARD_PROCESSING.id||e.row.send_status===t.SEND_STATUS.CARD_FAILED.id?a("el-select",{staticClass:"send_status-select",attrs:{value:e.row.send_status,size:"mini"},on:{change:function(a){return t.handleSetSendStatus(e.row,a)}}},[a("el-option",{attrs:{label:"待发货",value:t.SEND_STATUS.CARD_UN.id}}),a("el-option",{attrs:{label:"正在处理",value:t.SEND_STATUS.CARD_PROCESSING.id}}),a("el-option",{attrs:{label:"处理失败",value:t.SEND_STATUS.CARD_FAILED.id}}),a("el-option",{attrs:{label:"已发货",value:t.SEND_STATUS.CARD_SUCCESS.id}})],1):a("span",[t._v(" "+t._s(t.SEND_STATUS.get(e.row.send_status).name)+" ")])]}}],null,!1,1557840215)}):t._e(),t.isApiOrder?a("el-table-column",{attrs:{prop:"api_out_no",label:"通知",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"line-btn",on:{click:function(a){return t.showOrder(e.row)}}},[a("el-tag",{attrs:{type:e.row.api_info&&"success"===e.row.api_info.notify_ret?"success":"warning"}},[t._v(" "+t._s(e.row.api_info&&e.row.api_info.notify_ret||"未通知")+" ")])],1)]}}],null,!1,848801369)}):t._e(),a("el-table-column",{attrs:{prop:"paid_at",label:"支付时间",width:"160"}}),t.isApiOrder?a("el-table-column",{attrs:{prop:"api_out_no",label:"商户订单号",width:"170","show-overflow-tooltip":""}}):t._e(),t.isApiOrder?a("el-table-column",{attrs:{prop:"api_info.subject",label:"商品名称",width:"120","show-overflow-tooltip":""}}):t._e(),t.isApiOrder||t.onlyProfit?t._e():a("el-table-column",{attrs:{prop:"product",label:"商品名称","min-width":"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"red-text"},[t._v(t._s(e.row.count))]),a("span",[t._v(" x ")]),e.row.product&&e.row.product_name&&e.row.product_name!==e.row.product.name?a("el-tooltip",{attrs:{effect:"dark",content:"当前商品名称:"+e.row.product.name,placement:"bottom-start"}},[a("span",{staticClass:"orange-text"},[t._v(t._s(e.row.product_name))])]):a("span",[t._v(t._s(e.row.product_name||(e.row.product?e.row.product.name:"未知#"+e.row.product_id)))])]}}],null,!1,3623741862)}),t.isApiOrder||t.onlyProfit?t._e():a("el-table-column",{attrs:{prop:"card",label:"卡密",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"line-btn",staticStyle:{color:"#409eff"},on:{click:function(a){return t.showCards(e.row)}}},[t._v(" "+t._s(e.row.card_orders&&e.row.card_orders.length?e.row.card_orders.length+"张":"无")+" ")])]}}],null,!1,1920590660)}),a("el-table-column",{attrs:{prop:"pay",label:"支付方式","min-width":"80","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.pay?e.row.pay.name:e.row.pay_id===t.ID_INNER_RETAIL?"代理进货":"未知#"+e.row.pay_id)+" ")]}}],null,!1,3812082082)}),t.onlyProfit?a("el-table-column",{attrs:{prop:"cost",label:"成本",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("moneyFilter")(e.row.cost))+" ")]}}],null,!1,3561511455)}):t._e(),t.onlyProfit&&!t.isApiOrder?a("el-table-column",{attrs:{prop:"paid",label:"售价",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("moneyFilter")(e.row.paid))+" ")]}}],null,!1,2682474376)}):t._e(),t.onlyProfit?t._e():a("el-table-column",{attrs:{prop:"price",label:"金额",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.discount>0||e.row.sms_price>0?a("el-tooltip",{attrs:{effect:"dark",placement:"top-start",content:"商品总价："+(e.row.price/100).toFixed(2)+(e.row.discount?" - 优惠金额："+(e.row.discount/100).toFixed(2):"")+(e.row.sms_price?" + 短信费用："+(e.row.sms_price/100).toFixed(2):"")}},[a("span",[t._v(t._s(t._f("moneyFilter")(e.row.paid)))])]):a("span",[t._v(" "+t._s(t._f("moneyFilter")(e.row.paid))+" ")])]}}],null,!1,1339264014)}),"merchant"===t._project||t.userInfo?a("el-table-column",{attrs:{prop:"income",label:"入账",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{attrs:{effect:"dark",placement:"top-start",content:"手续费: "+(e.row.fee/100).toFixed(2)}},[a("span",[t._v(t._s(t._f("moneyFilter")(e.row.income)))])])]}}],null,!1,3409110604)}):t._e(),"admin"===t._project?a("el-table-column",{attrs:{prop:"fee-system_fee-aff_fee",label:"平台利润",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{attrs:{effect:"dark",placement:"top-start",content:"通道手续费: "+(e.row.system_fee/100).toFixed(2)}},[a("span",[t._v(t._s(t._f("moneyFilter")(e.row.fee-e.row.system_fee-e.row.aff_fee)))])])]}}],null,!1,561099295)}):t._e(),t.onlyProfit?a("el-table-column",{attrs:{prop:"profit",label:"利润",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("moneyFilter")(e.row.paid-e.row.sms_price-e.row.cost-e.row.fee))+" ")]}}],null,!1,599611478)}):t._e(),t.onlyProfit||t.isApiOrder?t._e():a("el-table-column",{attrs:{prop:"contact",label:"买家联系方式","min-width":"160","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.contact))])]}}],null,!1,4205396614)}),!t.onlyProfit&&t.isApiOrder?a("el-table-column",{attrs:{prop:"api_info.attach",label:"附加","min-width":"160","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"line-btn"},[t._v(" "+t._s(e.row.api_info&&e.row.api_info.attach||"无")+" ")])]}}],null,!1,130376087)}):t._e(),t.onlyProfit?t._e():a("el-table-column",{attrs:{prop:"remark",label:"备注","min-width":"50","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"line-btn",on:{click:function(a){return t.showRemark(e.row)}}},[t._v(t._s(e.row.remark||"添加"))])]}}],null,!1,1131591075)}),a("el-table-column",{attrs:{label:"操作",width:"admin"===t._project||"admin_free"===t._project?"80":"50",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:function(a){return t.showOrder(e.row)}}},[t._v(" 查看 ")]),"admin"===t._project&&e.row.status===t.ORDER_STATUS.SUCCESS.id?a("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},style:{color:e.row.pay_id===t.ID_INNER_RETAIL?"gray":""},on:{click:function(a){return t.handleFreeze(e.row)}}},[t._v(" 冻结 ")]):t._e(),"admin"===t._project&&e.row.status===t.ORDER_STATUS.FROZEN.id?a("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},style:{color:e.row.pay_id===t.ID_INNER_RETAIL?"gray":""},on:{click:function(a){return t.handleUnfreeze(e.row)}}},[t._v(" 解冻 ")]):t._e(),"admin"!==t._project&&"admin_free"!==t._project||e.row.status!==t.ORDER_STATUS.UN_PAY.id?t._e():a("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},style:{color:e.row.pay_id===t.ID_INNER_RETAIL?"gray":""},on:{click:function(a){return t.handleSetPaid(e.row)}}},[t._v(" 补单 ")]),e.row.status===t.ORDER_STATUS.PAID.id?a("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:function(a){return t.handleSendCard(e.row)}}},[t._v(" 发货 ")]):t._e()]}}],null,!1,1488334897)})],1),"admin"===t._project?a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[a("el-form",{staticClass:"no-bottom-form",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"选中"}},[a("el-button",{attrs:{size:"small"},on:{click:t.checkFreeze}},[t._v("冻结")]),a("el-button",{attrs:{size:"small"},on:{click:t.checkUnfreeze}},[t._v("解冻")]),a("el-button",{attrs:{size:"small"},on:{click:t.checkRefund}},[t._v("退款")])],1)],1)],1):t._e(),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?a("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.list.per_page,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t.orderInfo?a("order-info",{ref:"orderInfo",attrs:{from:"order",info:t.orderInfo},on:{close:function(e){t.orderInfo=null}}}):t._e(),t.PRODUCT_MANUAL&&t.exportDialogVisible?a("export-dialog",{on:{close:function(e){t.exportDialogVisible=!1},export:t.handleExport}}):t._e()],1)}),[],!1,null,null,null)).exports,Ea={components:{orderList:Oa}},Ta=Object(l.a)(Ea,(function(){var t=this.$createElement;return(this._self._c||t)("order-list",{attrs:{recentDay:7}})}),[],!1,null,null,null).exports,ja={data:function(){return{}},mounted:function(){this.$router.replace("/m/order/list?type=api")},methods:{}},$a=Object(l.a)(ja,(function(){var t=this.$createElement;return(this._self._c||t)("div")}),[],!1,null,null,null).exports,Pa={components:{orderList:Oa}},Da=Object(l.a)(Pa,(function(){var t=this.$createElement;return(this._self._c||t)("order-list",{attrs:{onlyProfit:!0}})}),[],!1,null,null,null).exports,Ra={STATUS_NORMAL:0,STATUS_USED:2},Ua={TYPE_ONETIME:0,TYPE_REPEAT:1},Ma={AMOUNT:0,PERCENT:1};function La(t,e){return Object(T.a)({url:"coupon/enable",method:"post",data:{ids:t,enabled:e}})}function za(t){return Object(T.a)({url:"coupon/delete",method:"post",data:{ids:t}})}var Na={props:{info:{},categories:{}},data:function(){return{loading:!1,visible:!0,COUPON_STATUS:Ra,COUPON_TYPE:Ua,COUPON_DISCOUNT_TYPE:Ma,products:[],form:{id:-1,category_id:-1,product_id:-1,coupon:"",type:Ua.TYPE_ONETIME,discount_val:"",discount_type:Ma.AMOUNT,count_all:null,count_used:null,expire_at:null},formRules:{coupon:[{required:!0,message:"请输入优惠券",trigger:"blur"}]}}},computed:{discountRules:function(){return this.form.discount_type===Ma.AMOUNT?[{required:!0,message:"请输入优惠券面额",trigger:"change"},{type:"number",min:.01,max:1e7,message:"数字需要在0.01-10000000之间",trigger:"change"}]:this.form.discount_type===Ma.PERCENT?[{required:!0,message:"请输入优惠百分比",trigger:"change"},{type:"number",min:1,max:100,message:"数字需要在1-100之间",trigger:"change"}]:[]}},watch:{visible:function(t){t||this.$emit("close",!1)}},mounted:function(){this.form.id=this.info.id,this.form.category_id=this.info.category_id,this.form.product_id=this.info.product_id,this.form.coupon=this.info.coupon,this.form.status=this.info.status,this.form.discount_type=this.info.discount_type,this.info.discount_type===Ma.AMOUNT?this.form.discount_val=(this.info.discount_val/100).toFixed(2):this.form.discount_val=this.info.discount_val,this.form.type=this.info.type,this.form.count_all=this.info.count_all,this.form.count_used=this.info.count_used,this.form.expire_at=new Date(this.info.expire_at)},methods:{getProducts:function(t){var e=this;if(this.category_id_old!==t){this.category_id_old=t,this.products=[];var a={search:"simple",val:t};this.userInfo&&(a.user_id=this.userInfo.id),Object(fe.h)(a).then((function(t){e.products=t.data}))}},handleSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(e){t.loading=!0;var a=Object.assign({},t.form);a.discount_type===Ma.AMOUNT&&(a.discount_val*=100),a.expire_at&&(a.expire_at=a.expire_at.format("yyyy-MM-dd")),function(t){return Object(T.a)({url:"coupon/edit",method:"post",data:t})}(a).then((function(){t.loading=!1,t.$notify({title:"提示",message:"编辑优惠券成功",type:"success",duration:3e3}),t.handleClose(!0)})).catch((function(){t.loading=!1}))}}))},handleClose:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}},Ba=Object(l.a)(Na,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"编辑卡号",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",rules:t.formRules}},[a("el-form-item",{attrs:{label:"优惠券",prop:"coupon"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入优惠券"},model:{value:t.form.coupon,callback:function(e){t.$set(t.form,"coupon",e)},expression:"form.coupon"}})],1),a("el-form-item",{attrs:{label:"商品",prop:"product_id"}},[a("el-select",{attrs:{filterable:""},on:{change:t.getProducts},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},[a("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.categories,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),a("el-select",{attrs:{filterable:""},model:{value:t.form.product_id,callback:function(e){t.$set(t.form,"product_id",e)},expression:"form.product_id"}},[a("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.products,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2)],1),a("el-form-item",{attrs:{label:"面额",prop:"discount_val",rules:t.discountRules}},[a("el-input",{attrs:{type:"text",placeholder:"请输入优惠券面额"},on:{change:function(e){return t.form.discount_val=+e||0}},model:{value:t.form.discount_val,callback:function(e){t.$set(t.form,"discount_val",e)},expression:"form.discount_val"}},[a("el-select",{staticStyle:{width:"70px"},attrs:{slot:"append",placeholder:"类型",value:"",size:"small"},slot:"append",model:{value:t.form.discount_type,callback:function(e){t.$set(t.form,"discount_type",e)},expression:"form.discount_type"}},[a("el-option",{attrs:{label:"￥",value:t.COUPON_DISCOUNT_TYPE.AMOUNT}}),a("el-option",{attrs:{label:"%",value:t.COUPON_DISCOUNT_TYPE.PERCENT}})],1)],1)],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[a("el-radio-button",{attrs:{label:t.COUPON_TYPE.TYPE_ONETIME}},[t._v("一次性")]),a("el-radio-button",{attrs:{label:t.COUPON_TYPE.TYPE_REPEAT}},[t._v("重复使用")])],1)],1),t.form.type===t.COUPON_TYPE.TYPE_REPEAT?a("el-form-item",{attrs:{label:"可用",prop:"count_all",rules:[{required:!0,message:"请输入可用次数",trigger:"blur"},{type:"number",min:1,max:1e7,message:"可用次数不能超过10000000"}]}},[a("el-input",{attrs:{type:"number",placeholder:"请输入可用次数"},model:{value:t.form.count_all,callback:function(e){t.$set(t.form,"count_all",t._n(e))},expression:"form.count_all"}}),a("span",[t._v("当前已使用 "+t._s(t.form.count_used)+"次")])],1):t._e(),a("el-form-item",{attrs:{label:"过期",prop:"expire_at"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择过期时间"},model:{value:t.form.expire_at,callback:function(e){t.$set(t.form,"expire_at",e)},expression:"form.expire_at"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){return t.handleClose(!1)}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("确认编辑 ")])],1)],1)}),[],!1,null,null,null).exports,Fa={props:{inBox:{default:!1},userInfo:{}},data:function(){var t=new Date;return t.setTime(t.getTime()+6048e5),{loading:!1,isMobile:this.$store.state.app.isMobile,COUPON_TYPE:Ua,COUPON_DISCOUNT_TYPE:Ma,categories:[],products:[],form:{category_id:-1,product_id:-1,type:Ua.TYPE_ONETIME,coupon:null,discount_val:"",discount_type:Ma.AMOUNT,count:null,expire_at:t},formRules:{discount_val:[]},list:[]}},computed:{discountRules:function(){return this.form.discount_type===Ma.AMOUNT?[{required:!0,message:"请输入优惠券面额",trigger:"change"},{type:"number",min:.01,max:1e7,message:"数字需要在0.01-10000000之间",trigger:"change"}]:this.form.discount_type===Ma.PERCENT?[{required:!0,message:"请输入优惠百分比",trigger:"change"},{type:"number",min:1,max:100,message:"数字需要在1-100之间",trigger:"change"}]:[]},formItemClass:function(){return this.isMobile?"coupon-form-item":""}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.getCategories(),this.userInfo&&(this.form.user_id=this.userInfo.id)},methods:{getCategories:function(){var t=this;this.categories=[];var e={search:"simple",val:"list"};this.userInfo&&(e.user_id=this.userInfo.id),Object(ue.d)(e).then((function(e){t.categories=e.data}))},getProducts:function(t){var e=this;if(this.category_id_old!==t){this.category_id_old=t,this.products=[];var a={search:"simple",val:t};this.userInfo&&(a.user_id=this.userInfo.id),Object(fe.h)(a).then((function(t){e.products=t.data}))}},onSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(e){t.list=[],t.loading=!0;var a=Object.assign({},t.form);a.discount_type===Ma.AMOUNT&&(a.discount_val*=100),a.expire_at&&(a.expire_at=a.expire_at.format("yyyy-MM-dd")),function(t){return Object(T.a)({url:"coupon/create",method:"post",data:t})}(a).then((function(e){t.loading=!1,t.list=e.data;var a=t.list.join("\r\n");t.$msgbox({title:"生成优惠券成功",message:'优惠券列表：<br><textarea title="优惠券列表" rows="6" style="width: 100%" readonly>'+Object(wt.a)(a)+"</textarea>",showCancelButton:!0,dangerouslyUseHTMLString:!0,cancelButtonText:"一键复制"}).catch((function(e){"cancel"===e&&t.$refs["copy-coupons"].$el.click()})),t.$emit("submit",!0)})).catch((function(){t.loading=!1}))}}))}}},qa=(a("2916"),Object(l.a)(Fa,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"app-container":!t.inBox}},[a("h3",{staticStyle:{margin:"4px 0 28px 0"}},[t._v("生成优惠券")]),a("el-form",{ref:"form",attrs:{model:t.form,"label-position":t.isMobile?"top":"","label-width":"90px",rules:t.formRules}},[a("el-form-item",{class:t.formItemClass,style:t.isMobile?"margin-top: -24px":"",attrs:{label:"类型"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[a("el-radio-button",{attrs:{label:t.COUPON_TYPE.TYPE_ONETIME}},[t._v("一次性")]),a("el-radio-button",{attrs:{label:t.COUPON_TYPE.TYPE_REPEAT}},[t._v("重复使用")])],1)],1),a("el-form-item",{class:t.formItemClass,attrs:{label:"商品",prop:"product_id"}},[a("el-select",{attrs:{filterable:""},on:{change:t.getProducts},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},[a("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.categories,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2),a("el-select",{attrs:{filterable:""},model:{value:t.form.product_id,callback:function(e){t.$set(t.form,"product_id",e)},expression:"form.product_id"}},[a("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.products,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2)],1),a("el-form-item",{class:t.formItemClass,attrs:{label:"面额",prop:"discount_val",rules:t.discountRules}},[a("el-input",{attrs:{type:"text",placeholder:"请输入优惠券面额"},on:{change:function(e){return t.form.discount_val=+e||0}},model:{value:t.form.discount_val,callback:function(e){t.$set(t.form,"discount_val",e)},expression:"form.discount_val"}},[a("el-select",{staticStyle:{width:"70px"},attrs:{slot:"append",placeholder:"类型",value:"",size:"small"},slot:"append",model:{value:t.form.discount_type,callback:function(e){t.$set(t.form,"discount_type",e)},expression:"form.discount_type"}},[a("el-option",{attrs:{label:"￥",value:t.COUPON_DISCOUNT_TYPE.AMOUNT}}),a("el-option",{attrs:{label:"%",value:t.COUPON_DISCOUNT_TYPE.PERCENT}})],1)],1),a("div",{staticClass:"el-form-item__tip"},[a("span",[t._v("* 请合理设置优惠金额, 以避免产生亏损")])])],1),t.form.type===t.COUPON_TYPE.TYPE_REPEAT?a("el-form-item",{class:t.formItemClass,attrs:{label:"可用次数",prop:"count_all",rules:[{required:!0,message:"请输入可用次数",trigger:"blur"},{type:"number",min:1,max:1e7,message:"可用次数不能超过10000000"}]}},[a("el-input",{attrs:{type:"number",placeholder:"请输入可用次数"},model:{value:t.form.count_all,callback:function(e){t.$set(t.form,"count_all",t._n(e))},expression:"form.count_all"}})],1):t._e(),t.form.type===t.COUPON_TYPE.TYPE_ONETIME?a("el-form-item",{class:t.formItemClass,attrs:{label:"生成数量",prop:"count",rules:[{required:!0,message:"请输入生成数量",trigger:"blur"},{type:"number",min:1,max:100,message:"每次生成不能大于100张"}]}},[a("el-input",{attrs:{type:"number",placeholder:"请输入生成数量"},model:{value:t.form.count,callback:function(e){t.$set(t.form,"count",t._n(e))},expression:"form.count"}})],1):t._e(),t.form.type===t.COUPON_TYPE.TYPE_REPEAT?a("el-form-item",{class:t.formItemClass,attrs:{label:"券代码",prop:"coupon"}},[a("el-input",{attrs:{type:"text",placeholder:"为空系统自动生成"},model:{value:t.form.coupon,callback:function(e){t.$set(t.form,"coupon",e)},expression:"form.coupon"}})],1):t._e(),a("el-form-item",{class:t.formItemClass,attrs:{label:"过期时间",prop:"expire_at"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择过期时间"},model:{value:t.form.expire_at,callback:function(e){t.$set(t.form,"expire_at",e)},expression:"form.expire_at"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v("添加")])],1)],1),t.list.length?a("div",{staticStyle:{"font-size":"14px",color:"#606266","line-height":"16px","margin-top":"24px"},style:{"margin-left":t.isMobile?0:"90px"}},[a("span",[t._v("生成优惠券 "+t._s(t.list.length)+"张")]),a("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:t.list.join("\r\n"),expression:"list.join('\\r\\n')"}],ref:"copy-coupons",staticStyle:{display:"inline-block","margin-left":"12px"},attrs:{size:"mini"},on:{success:function(e){return t.$message({message:"复制成功",type:"success",duration:1e3})},error:function(e){return t.$message({message:"复制失败, 请手动复制",type:"error",duration:1e3})}}},[t._v(" 一键复制 ")]),a("p",{domProps:{innerHTML:t._s(t.list.join("<br>"))}})],1):t._e()],1)}),[],!1,null,null,null)).exports,Va={props:{userInfo:{type:Object,default:null},onlyTrashed:{default:!1},_project:{default:"merchant"}},components:{couponEdit:Ba,couponAdd:qa},data:function(){return{loading:!1,exporting:!1,showAddBox:!1,addBoxLoaded:!1,COUPON_TYPE:Ua,COUPON_STATUS:Ra,COUPON_DISCOUNT_TYPE:Ma,search:{type:"coupon",value:""},where:{category_id:-1,product_id:-1},categories:[{id:-2,name:"加载中"}],products:[{id:-2,name:"加载中"}],list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",statusFilter:[{text:"未用",value:Ra.STATUS_NORMAL,type:"primary"},{text:"已用",value:Ra.STATUS_USED,type:"info"}],typeFilter:[{text:"重复使用",value:Ua.TYPE_REPEAT,type:"info"},{text:"一次性",value:Ua.TYPE_ONETIME,type:"info"}],editInfo:null}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){this.getCategories()},methods:{getCategories:function(){var t=this;this.loading=!0;var e={search:"simple",val:"list"};this.userInfo&&(e.user_id=this.userInfo.id),Object(ue.d)(e).then((function(e){t.categories=e.data,t.getList()}))},getProducts:function(t){var e=this;this.where.product_id=-1,this.getList(),this.products=[];var a={search:"simple",val:t};this.userInfo&&(a.user_id=this.userInfo.id),Object(fe.h)(a).then((function(t){e.products=t.data}))},getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,this.where.trashed=this.onlyTrashed,this.userInfo&&(this.where.user_id=this.userInfo.id),function(t){return Object(T.a)({url:"coupon",method:"get",params:t})}(this.where).then((function(e){t.list=e.data,t.loading=!1}))},handleSearch:function(){var t={search:this.search.type,val:this.search.value};Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.status?e.status=t.status.join(","):e.status=null,t.type?e.type=t.type.join(","):e.type=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},renderUseFor:function(t){return t.product_id>0?t.product&&t.product.name?"商品："+t.product.name:"商品：#"+t.product_id:t.category_id>0?t.category&&t.category.name?"分类："+t.category.name:"分类：#"+t.category_id:"店铺通用(商品有规定除外)"},handleDisable:function(t){var e=this,a=t.coupon;this.$confirm("禁用优惠券<"+a+">?","提示",{type:"warning"}).then((function(){e.loading=!0,La(t.id,0).then((function(){e.$notify({title:"操作成功",message:"优惠券<"+a+">已禁用",type:"info"}),t.enabled=0,e.loading=!1})).catch((function(){e.loading=!1}))}))},handleEnable:function(t){var e=this,a=t.coupon;this.$confirm("启用优惠券<"+a+">?","提示",{type:"warning"}).then((function(){e.loading=!0,La(t.id,1).then((function(){e.$notify({title:"操作成功",message:"优惠券<"+a+">已启用",type:"success"}),t.enabled=1,e.loading=!1})).catch((function(){e.loading=!1}))}))},handleDelete:function(t){var e=this,a=t.coupon;this.$confirm("删除优惠券"+a+"? 您可以稍后在回收站查看","提示",{type:"warning"}).then((function(){e.loading=!0,za(t.id).then((function(){e.$notify({title:"操作成功",message:"优惠券"+a+"已删除",type:"info"}),e.getList()})).catch((function(){e.loading=!1}))}))},checkDelete:function(){var t=this;this.checkedIds.length&&this.$confirm("批量删除选中优惠券? 您可以稍后在回收站查看","提示",{type:"warning"}).then((function(){t.loading=!0,za(t.checkedIds).then((function(){t.$notify({title:"操作成功",message:"选中优惠券已删除",type:"info"}),t.getList()})).catch((function(){t.loading=!1}))}))},handleAdd:function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.$router.push("/m/coupon/add"),t.next=13;break;case 4:t.next=8;break;case 8:return window.scrollTo(0,0),this.addBoxLoaded=!0,t.next=12,this.$nextTick();case 12:this.showAddBox=!0;case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),onAdd:function(){this.getList()},handleEdit:function(t){this.editInfo=t},editCallback:function(t){this.editInfo=null,t&&this.getList()}}},Ya=Object(l.a)(Va,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",class:{"app-container":!t.userInfo}},[a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showAddBox,expression:"showAddBox"}],staticClass:"apply-box"},[a("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",type:"danger",size:"small"},on:{click:function(e){t.showAddBox=!1}}}),t.showAddBox||t.addBoxLoaded?a("el-card",{staticClass:"my-card"},[a("coupon-add",{attrs:{"in-box":!0,userInfo:t.userInfo},on:{submit:t.onAdd}})],1):t._e()],1)]),a("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[a("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[a("el-form-item",{staticClass:"mobile-full-width"},[a("el-select",{staticClass:"mobile-full-width",attrs:{filterable:"",size:"small"},on:{change:t.getProducts},model:{value:t.where.category_id,callback:function(e){t.$set(t.where,"category_id",e)},expression:"where.category_id"}},[a("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.categories,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],2),t.where.category_id>0?a("el-select",{staticClass:"mobile-full-width",attrs:{filterable:"",size:"small"},on:{change:t.getList},model:{value:t.where.product_id,callback:function(e){t.$set(t.where,"product_id",e)},expression:"where.product_id"}},[a("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.products,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],2):t._e()],1),a("el-form-item",{staticClass:"mobile-full-width"},[a("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[a("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[a("el-option",{attrs:{label:"ID",value:"id"}}),a("el-option",{attrs:{label:"优惠券",value:"coupon"}}),a("el-option",{attrs:{label:"备注",value:"remark"}})],1)],1)],1),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),a("el-form-item",{staticClass:"right-toolbox"},[a("el-link",{on:{click:t.handleAdd}},[a("icon",{attrs:{name:"regular/plus"}}),t._v(" 添加")],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map((function(t){return t.id})).join(",")}}},[a("el-table-column",{attrs:{type:"selection",width:"40"}}),"admin"===t._project?a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),"admin"!==t._project||t.userInfo?t._e():a("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"}}),a("el-table-column",{attrs:{prop:"coupon",label:"优惠券","min-width":"180","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"coupon",label:"优惠额",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.discount_type===t.COUPON_DISCOUNT_TYPE.AMOUNT?"￥"+(e.row.discount_val/100).toFixed(2):e.row.discount_val+"%")+" ")]}}])}),a("el-table-column",{attrs:{prop:"use_for",label:"适用商品","min-width":"180","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.renderUseFor(e.row))+" ")]}}])}),a("el-table-column",{attrs:{prop:"type",label:"类型",width:"90","column-key":"type",filters:t.typeFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:(e.row.type,t.COUPON_TYPE.TYPE_ONETIME,"info")}},[t._v(" "+t._s(e.row.type===t.COUPON_TYPE.TYPE_ONETIME?"一次性":"重复使用")+" ")])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"使用状态",width:"90","column-key":"status",filters:t.statusFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.type===t.COUPON_TYPE.TYPE_ONETIME?a("el-tag",{attrs:{type:e.row.status===t.COUPON_STATUS.STATUS_USED?"info":"primary"}},[t._v(" "+t._s(e.row.status===t.COUPON_STATUS.STATUS_USED?"已用":"未用")+" ")]):a("el-tag",{attrs:{type:e.row.count_used>0?"info":"primary"}},[t._v(" "+t._s(e.row.count_used+"/"+e.row.count_all)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"expire_at",label:"过期时间",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:new Date(e.row.expire_at)<new Date?"amber-text":""},[t._v(t._s(e.row.expire_at))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"50",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:function(a){return t.handleEdit(e.row)}}},[a("icon",{attrs:{name:"light/pencil"}})],1),a("a",{staticClass:"icon-btn",on:{click:function(a){return t.handleDelete(e.row)}}},[a("icon",{attrs:{name:"light/trash-alt"}})],1)]}}])})],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[a("el-form",{staticClass:"no-bottom-form",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"选中"}},[a("el-button",{attrs:{size:"small"},on:{click:t.checkDelete}},[t._v("删除")])],1)],1)],1),a("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?a("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.list.per_page,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t.editInfo?a("coupon-edit",{attrs:{info:t.editInfo,categories:t.categories},on:{close:t.editCallback}}):t._e()],1)}),[],!1,null,null,null).exports,Ha={props:{userInfo:{},_project:{default:"merchant"}},data:function(){return{loading:!1,userInfo_:{wx_open_id:1},subscribe:!1,form:{test:"",login:0,complaint:0,low_stocks:0,withdraw_success:0,order_success:0,stat_daily:0},form_ann:1,dialogVisible:!1,bindImgUrl:"",bindImgUrlTip:""}},watch:{loading:function(t,e){t?e||at.a.isStarted()||at.a.start():at.a.done()}},mounted:function(){var t=this;this.userInfo_=this.$store.state.user.userInfo,this.loading=!0,qt().then((function(e){for(var a in t.loading=!1,t.subscribe=e.data.subscribe,e.data.options)e.data.options.hasOwnProperty(a)&&t.form.hasOwnProperty(a)&&(t.form[a]=parseInt(e.data.options[a]))})).finally((function(){t.loading=!1}))},methods:{handleJieBang:function(){var t=this;this.$confirm("确认要解绑微信吗","提示",{type:"warning"}).then((function(){t.loading=!0,Object(T.a)({url:"wechat/notify",method:"delete"}).then((function(){t.subscribe=!1,t.userInfo_.wx_open_id=null,t.$notify({title:"操作成功",message:"您的账号已经和微信解除绑定",type:"info"})})).finally((function(){t.loading=!1}))}))},onBind:function(){var t=this;this.bindImgUrl="",this.bindImgUrlTip="加载中请稍后...",Object(T.a)({url:"wechat/bind",method:"get"}).then((function(e){t.bindImgUrl=e.data,t.dialogVisible=!0,setTimeout(t.checkIsBind,1e3)}))},checkIsBind:function(){var t=this;this.dialogVisible&&qt().then((function(e){if(t.subscribe=e.data.subscribe,t.subscribe)return t.form=e.data.options,t.userInfo_.wx_open_id=e.data.open_id,void(t.dialogVisible=!1);setTimeout(t.checkIsBind,2e3)})).catch((function(){setTimeout(t.checkIsBind,2e3)}))},onSubmit:function(){var t=this;this.loading=!0,qt(this.form).then((function(){t.loading=!1,t.$notify({title:"成功",message:"设置已保存",type:"success"})})).catch((function(){t.loading=!1}))}}},Wa=(a("804a"),Object(l.a)(Ha,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"app-container":!t.userInfo}},[t.userInfo?t._e():a("h3",{staticStyle:{margin:"4px 0 16px 0"}},[t._v("微信通知")]),a("p",{staticStyle:{"margin-top":"0","font-size":"14px"}},[t._v("绑定后，您可获得微信通知、账号安全等相关消息。")]),a("el-card",{staticClass:"my-card card-mobile-padding",style:{"margin-top":t.userInfo?"22px":"0"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"line-height":"28px"}},[t._v("绑定设置")])]),t.userInfo_?a("div",[a("p",[t._v(" 绑定当前账号： "),a("el-tag",{attrs:{size:"small",type:t.userInfo_.wx_open_id?"success":"warning"}},[t._v(" "+t._s(t.userInfo_.wx_open_id?"是":"否")+" ")]),t.userInfo_.wx_open_id?a("el-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text",size:"mini"},on:{click:t.handleJieBang}},[t._v("解绑 ")]):t._e()],1),a("p",[t._v(" 关注官方微信： "),a("el-tag",{directives:[{name:"show",rawName:"v-show",value:t.subscribe||!t.loading,expression:"subscribe||!loading"}],attrs:{size:"small",type:t.subscribe?"success":"warning"}},[t._v(" "+t._s(t.subscribe?"是":"否")+" ")])],1),t.userInfo_.wx_open_id?t._e():a("p",{staticStyle:{"margin-top":"12px"}},[a("el-button",{attrs:{size:"small",type:"primary",loading:t.loading},on:{click:t.onBind}},[t._v("立即绑定")])],1),t.userInfo_.wx_open_id&&!t.subscribe?a("p",[a("el-button",{attrs:{size:"small",type:"primary",loading:t.loading},on:{click:t.onBind}},[t._v("立即关注")])],1):t._e()]):t._e()]),t.subscribe?a("el-card",{staticClass:"my-card card-mobile-padding"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"line-height":"28px"}},[t._v("通知设置")])]),a("el-form",{ref:"form",attrs:{model:t.form}},[a("el-form-item",{staticClass:"wx-item"},[a("el-switch",{attrs:{"inactive-text":"登录提醒","active-value":1,"inactive-value":0},model:{value:t.form.login,callback:function(e){t.$set(t.form,"login",e)},expression:"form.login"}})],1),a("el-form-item",{staticClass:"wx-item"},[a("el-switch",{attrs:{"inactive-text":"收到投诉","active-value":1,"inactive-value":0},model:{value:t.form.complaint,callback:function(e){t.$set(t.form,"complaint",e)},expression:"form.complaint"}})],1),a("el-form-item",{staticClass:"wx-item"},[a("el-switch",{attrs:{"inactive-text":"库存不足","active-value":1,"inactive-value":0},model:{value:t.form.low_stocks,callback:function(e){t.$set(t.form,"low_stocks",e)},expression:"form.low_stocks"}})],1),a("el-form-item",{staticClass:"wx-item"},[a("el-switch",{attrs:{"inactive-text":"结算成功","active-value":1,"inactive-value":0},model:{value:t.form.withdraw_success,callback:function(e){t.$set(t.form,"withdraw_success",e)},expression:"form.withdraw_success"}})],1),a("el-form-item",{staticClass:"wx-item"},[a("el-switch",{attrs:{"inactive-text":"交易成功","active-value":1,"inactive-value":0},model:{value:t.form.order_success,callback:function(e){t.$set(t.form,"order_success",e)},expression:"form.order_success"}})],1),a("el-form-item",{staticClass:"wx-item"},[a("el-switch",{attrs:{"inactive-text":"每日报表","active-value":1,"inactive-value":0},model:{value:t.form.stat_daily,callback:function(e){t.$set(t.form,"stat_daily",e)},expression:"form.stat_daily"}})],1),a("el-form-item",{staticClass:"wx-item"},[a("el-switch",{attrs:{"inactive-text":"重要公告","active-value":1,"inactive-value":0,disabled:""},model:{value:t.form_ann,callback:function(e){t.form_ann=e},expression:"form_ann"}})],1),a("el-form-item",{staticStyle:{"margin-top":"12px"}},[a("el-button",{attrs:{size:"small",type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v("保存设置")])],1)],1)],1):t._e(),a("el-dialog",{staticClass:"wechat-bind-dialog",attrs:{title:"绑定微信",visible:t.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"text-center"},[a("p",{staticClass:"text-center"},[t._v(t._s(t.bindImgUrlTip))]),t.bindImgUrl?a("img",{attrs:{width:"250",src:t.bindImgUrl},on:{load:function(e){t.bindImgUrlTip="请使用微信扫描二维码"},error:function(e){t.bindImgUrlTip="绑定二维码加载失败"}}}):t._e()]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("确定")])],1)])],1)}),[],!1,null,null,null)).exports;var Qa={props:{inBox:{default:!1},userInfo:{},_project:{default:"merchant"}},data:function(){return{loading:!0,info:{registers:"加载中",m_paid:"加载中",m_all:"加载中",aff_link:[]}}},mounted:function(){var t=this;(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(T.a)({url:"affiliate/info",method:"get",params:{user_id:t}})})(this.userInfo?this.userInfo.id:0).then((function(e){t.info=e.data}))},methods:{handleCopySuccess:function(){this.$notify({title:null,message:"已复制",type:"success",duration:2e3})},handleCopyError:function(){this.$notify({title:null,message:"复制失败，请手动复制",type:"error",duration:2e3})}}},Ga=(a("a554"),Object(l.a)(Qa,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"app-container":!t.inBox}},[a("h3",{staticStyle:{margin:"4px 0 16px 0"}},[t._v("邀请有奖")]),a("el-alert",{staticStyle:{"margin-bottom":"14px"},attrs:{type:"info",title:""}},[a("div",{staticStyle:{"font-size":"14px","margin-top":"-5px"}},[t._v(" 您将获得被邀请人每笔订单利润的 "),a("code",[t._v(t._s(100*t.info.rate)+"%")]),t._v("，将于次日统一结算至账户余额 ")])]),a("el-card",{staticClass:"my-card"},[a("div",{staticStyle:{"text-align":"center"}},[a("div",{staticClass:"aff-item"},[a("h1",[t._v(t._s(t._f("moneyDigitalFilter")(t._f("moneyFilter")(t.info.m_paid))))]),a("h4",[t._v("已结算(元)")])]),a("div",{staticClass:"aff-item"},[a("h1",[t._v(t._s(t._f("moneyDigitalFilter")(t._f("moneyFilter")(t.info.m_all-t.info.m_paid))))]),a("h4",[t._v("未结算(元)")])]),a("div",{staticClass:"aff-item"},[a("h1",[t._v(t._s(t._f("moneyDigitalFilter")(t._f("moneyFilter")(t.info.m_all))))]),a("h4",[t._v("总奖励(元)")])]),a("div",{staticClass:"aff-item"},[a("h1",[t._v(t._s(t.info.registers))]),a("h4",[t._v("总注册(人)")])])])]),a("el-card",{staticClass:"my-card"},[a("h4",{staticStyle:{margin:"4px 0 16px 0","font-weight":"normal"}},[t._v("邀请链接")]),t._l(t.info.aff_link,(function(e){return a("p",{key:e,staticClass:"aff-link-container"},[a("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:e,expression:"link"}],staticClass:"aff-copy-btn",attrs:{size:"mini"},on:{success:t.handleCopySuccess,error:t.handleCopyError}},[t._v("复制")]),a("a",{staticClass:"aff-link",attrs:{href:e,target:"_blank"}},[t._v(t._s(e))])],1)}))],2)],1)}),[],!1,null,"7487f579",null)).exports;a.d(e,"b",(function(){return Za})),a.d(e,"a",(function(){return ii})),i.default.use(n.default);var Za=[{path:"/m/login",redirect:"/m/auth/login",hidden:!0},{path:"/m/register",redirect:"/m/auth/register",hidden:!0},{path:"/m/auth",name:"认证",component:S,hidden:!0,children:[{path:"login",name:"auth.login",meta:{title:"用户登录"},component:U},{path:"register",name:"auth.register",meta:{title:"用户注册"},component:B},{path:"password/forget",name:"auth.password.forget",meta:{title:"忘记密码"},component:H},{path:"password/reset/:email/:token",name:"auth.password.reset",meta:{title:"重置密码"},component:Q}]},{path:"/m/404",name:"404 Not Found",component:tt,hidden:!0},{path:"/m/",redirect:"/m/dashboard/index",hidden:!0},{path:"/m/dashboard",component:I,redirect:"/m/dashboard/index",hidden:!1,noDropdown:!0,icon:"tachometer-alt",children:[{path:"index",name:"管理中心",component:Rt}]},{path:"/m/user",component:I,redirect:"noredirect",hidden:!1,icon:"user",name:"个人信息",children:[{path:"security",name:"修改密码",icon:"regular/shield-alt",component:Mt},{path:"verify",name:"实名认证",icon:"id-card",component:Nt,hide:!window.config.user_verify.open||!!window.config.user_verify.show_in_withdraw},{path:"pay/setting",name:"结算设置",icon:"credit-card",component:Yt},{path:"pay/apply",name:"申请提现",icon:"regular/yen-sign",component:Qt},{path:"pay/list",name:"结算记录",icon:"bars",component:Xt}]},{path:"/m/shopController",component:I,redirect:"noredirect",hidden:!1,icon:"cogs",name:"店铺管理",children:[{path:"info",name:"店铺信息",icon:"regular/info-circle",component:se},{path:"link",name:"店铺链接",icon:"regular/link",component:be},{path:"rate",name:"通道费率",icon:"regular/chart-pie-o",component:Ce},{path:"complaint",name:"投诉管理",icon:"regular/comment-alt-exclamation",component:ze},{path:"message",name:"站内信息",icon:"regular/envelope",component:Be},{path:"logs",name:"登录日志",icon:"regular/sticky-note",component:qe}]},{path:"/m/product",component:I,redirect:"noredirect",hidden:!1,icon:"cubes",name:"商品管理",children:[{path:"category",name:"商品分类",icon:"bars",component:Ge},{path:"list",name:"商品列表",icon:"bars",component:ia},{path:"add",name:"添加商品",icon:"regular/plus",component:ea},{path:"retail/add",name:"批量对接",icon:"regular/angle-double-right",component:la},{path:"retail/manage",name:"分销供货",icon:"regular/handshake",component:pa},{path:"card/add",redirect:"/m/card/add",hidden:!0},{path:"card/list",redirect:"/m/card/list",hidden:!0},{path:"card/recycle",redirect:"/m/card/recycle",hidden:!0}]},{path:"/m/card",component:I,redirect:"noredirect",hidden:!1,icon:"cubes",name:"卡密管理",children:[{path:"list",name:"卡密列表",icon:"bars",component:ya},{path:"recycle",name:"卡密回收站",icon:"regular/trash-alt",component:Ca},{path:"add",name:"添加卡密",icon:"regular/plus",component:ba}]},{path:"/m/order",component:I,redirect:"noredirect",hidden:!1,icon:"list-ul",name:"交易管理",children:[{path:"list",name:"订单记录",icon:"bars",component:Oa},{path:"recent",name:"7日订单",icon:"bars",component:Ta},{path:"api",name:"API订单",icon:"bars",component:$a},{path:"analysis",name:"收益统计",icon:"chart-bar",component:Da}]},{path:"/m/coupon",component:I,redirect:"noredirect",hidden:!1,icon:"tags",name:"营销助手",children:[{path:"add",name:"添加优惠券",icon:"regular/plus",component:qa},{path:"list",name:"管理优惠券",icon:"bars",component:Ya}]}];if(window.config.wechat_oa_open){var Ja=!0,Ka=!1,Xa=void 0;try{for(var ti,ei=Za[Symbol.iterator]();!(Ja=(ti=ei.next()).done);Ja=!0){var ai=ti.value;if("/m/user"===ai.path){ai.children.push({path:"wechat",name:"微信通知",icon:"brands/weixin",component:Wa});break}}}catch(t){Ka=!0,Xa=t}finally{try{Ja||null==ei.return||ei.return()}finally{if(Ka)throw Xa}}}window.config.apipay_open&&Za.push({path:"/m/api",component:I,redirect:"/m/api/pay",hidden:!1,noDropdown:!0,icon:"code",children:[{path:"pay",name:"API接入",component:ye}]}),window.config.affiliate_open&&Za.push({path:"/m/affiliate",component:I,redirect:"/m/affiliate/index",hidden:!1,noDropdown:!0,icon:"share-alt",children:[{path:"index",name:"邀请有奖",component:Ga}]}),e.c=new n.default({mode:"history",scrollBehavior:function(){return{y:0}},routes:Za});var ii=[{path:"/*",redirect:"/m/404",hidden:!0}]},a19f:function(t,e,a){},a278:function(t,e,a){},a394:function(t,e,a){},a4ce:function(t,e,a){"use strict";var i=a("9bf7");a.n(i).a},a554:function(t,e,a){"use strict";var i=a("60be");a.n(i).a},a9b8:function(t,e,a){},aa14:function(t,e,a){},acb6:function(t,e,a){},ae71:function(t,e,a){"use strict";var i=a("0eda");a.n(i).a},b143:function(t,e,a){"use strict";var i=a("1dc9");a.n(i).a},b247:function(t,e,a){"use strict";a("99af"),a("a15b"),a("d81d"),a("b0c0"),a("d3b7"),a("07ac"),a("9e1f"),a("450d");var i=a("6ed5"),n=a.n(i),r=a("bc3a"),o=a.n(r),s=a("4360"),l=a("3433");o.a.defaults.withCredentials=!0,window.API_URL="/api/merchant/",window.API_HOST=location.host;var c=o.a.create({baseURL:window.API_URL,timeout:15e3,transformRequest:[function(t){return t&&t.constructor!==FormData&&(t=Object(l.b)(t)),t}]});c.interceptors.request.use((function(t){t.headers["X-XSRF-TOKEN"]=Object(l.c)(32);var e=s.a.state.user.token;return e&&(t.headers.Authorization=e),t.headers["X-Requested-With"]="XMLHttpRequest",t}),(function(t){Promise.reject(t)})),c.interceptors.response.use((function(t){return t.headers.authorization&&s.a.commit("SET_TOKEN",t.headers.authorization),t.data}),(function(t){var e=t.message;if(t.response){if(401===t.response.status)return"登录"!==window.$router.app.$route.name&&window.$store.dispatch("Logout").then((function(){location.reload()})),Promise.reject(t);var a=t.response.data;a.exception?(e=a.exception,a.message&&(e+="<br>"+a.message)):a.errors?e=Object.values(a.errors).map((function(t){return t[0]})).join("<br>"):a.message&&(e=a.message)}return n()({message:e,title:"提示",type:"error",dangerouslyUseHTMLString:!0}),Promise.reject({message:e,data:t.response.data||null})})),e.a=c},b6ad:function(t,e,a){"use strict";var i=a("3ce0");a.n(i).a},b78a:function(t,e,a){},b923:function(t,e,a){"use strict";var i=a("5ec0");a.n(i).a},b950:function(t,e,a){},b96b:function(t,e,a){"use strict";var i=a("963b");a.n(i).a},b9b2:function(t,e,a){},baad:function(t,e,a){},be4b:function(t,e,a){},c5b0:function(t,e,a){},c9ee:function(t,e,a){"use strict";var i=a("b950");a.n(i).a},cc27:function(t,e,a){},cd80:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("4de4"),core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("c975"),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("a15b"),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("fb6a"),core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("ac1f"),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("1276"),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("498a"),core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_6__),nprogress__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("323e"),nprogress__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(nprogress__WEBPACK_IMPORTED_MODULE_7__),_api_card__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("4278"),_api_category__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("2753"),_api_product__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("606a");__webpack_exports__.a={props:{inBox:{default:!1},userInfo:{},category_id:{},product_id:{},_project:{default:"merchant"}},data:function(){return{loading:!1,labelWidth:this.$store.state.app.isMobile?"50px":"90px",CARD_STATUS:_api_card__WEBPACK_IMPORTED_MODULE_8__.a,CARD_TYPE:_api_card__WEBPACK_IMPORTED_MODULE_8__.b,categories:[],products:[],form:{category_id:null,product_id:null,card:"",type:_api_card__WEBPACK_IMPORTED_MODULE_8__.b.TYPE_ONETIME,count_all:null,is_check:!1},formRules:{product_id:[{required:!0,message:"请选择商品",trigger:"blur"}],card:[{required:!0,message:"请输入卡密",trigger:"blur"}]},upload:{now:0,all:0}}},computed:{uploading:function(){return this.upload.now<this.upload.all}},watch:{loading:function(t,e){t?e||nprogress__WEBPACK_IMPORTED_MODULE_7___default.a.isStarted()||nprogress__WEBPACK_IMPORTED_MODULE_7___default.a.start():nprogress__WEBPACK_IMPORTED_MODULE_7___default.a.done()}},mounted:function(){this.getCategories(),this.userInfo&&(this.form.user_id=this.userInfo.id),+this.category_id>0?(this.form.category_id=+this.category_id,+this.product_id>0&&(this.form.product_id=+this.product_id)):+this.$route.query.category_id>0&&(this.form.category_id=+this.$route.query.category_id,+this.$route.query.product_id>0&&(this.form.product_id=+this.$route.query.product_id))},methods:{getCategories:function(){var t=this;this.categories=[];var e={search:"simple",val:"list"};this.userInfo&&(e.user_id=this.userInfo.id),Object(_api_category__WEBPACK_IMPORTED_MODULE_9__.d)(e).then((function(e){t.categories=e.data,t.categories.length?(1===t.categories.length&&(t.form.category_id=t.categories[0].id),t.form.category_id>0&&t.getProducts(t.form.category_id)):t.$alert("请先添加商品分类","提示",{confirmButtonText:"去添加"}).then((function(){t.$emit("changeTab",{to:"category"})}))}))},getProducts:function(t){var e=this;if(this.category_id_old!==t){this.category_id_old=t,this.products=[];var a={search:"simple",val:t,from:"card"};this.userInfo&&(a.user_id=this.userInfo.id),Object(_api_product__WEBPACK_IMPORTED_MODULE_10__.h)(a).then((function(t){e.products=t.data,e.products.length?1===e.products.length&&(e.form.product_id=e.products[0].id):e.$alert("请先添加商品","提示",{confirmButtonText:"去添加"}).then((function(){e.$router.push({path:"/m/product/add"})}))}))}},handleTypeChange:function(){this.form.type===_api_card__WEBPACK_IMPORTED_MODULE_8__.b.TYPE_REPEAT&&(this.form.card="")},onSubmit:function onSubmit(){var _this3=this;this.$refs.form.validate((function(valid){if(valid){if(_this3.form.card.indexOf("<")>-1)return _this3.$message({message:"卡密不能包含 < ",type:"error"});if(_this3.form.type===_api_card__WEBPACK_IMPORTED_MODULE_8__.b.TYPE_REPEAT){if(_this3.form.card.indexOf("\n")>-1||_this3.form.card.indexOf("\r")>-1)return _this3.$message({message:"重复销售的卡密每次只能添加一张",type:"error"});_this3.upload.now=0,_this3.upload.all=1,Object(_api_card__WEBPACK_IMPORTED_MODULE_8__.c)(_this3.form).then((function(){_this3.upload.now=1,_this3.$alert("添加卡密结束","提示",{type:"success"}).then((function(){_this3.$emit("submit",!0)}))})).catch((function(){_this3.upload.now=1}))}else{var card_arr=_this3.form.card.split("\n").filter((function(t){return t.trim().length>0}));if(_this3.upload.now=0,_this3.upload.all=card_arr.length,_this3.upload.all>=1e5)return void _this3.$alert("单次添加不能超过100000张","提示",{type:"error"});var per_round=1e3,rounds=Math.ceil(card_arr.length/per_round),upload_func=function upload_func(round){if(round>=rounds)_this3.$alert("添加卡密结束","提示",{type:"success"}).then((function(){_this3.$emit("submit",!0)}));else{var cards=card_arr.slice(round*per_round,(round+1)*per_round),submitInfo=Object.assign({},_this3.form);submitInfo.card=cards.join("\n"),Object(_api_card__WEBPACK_IMPORTED_MODULE_8__.c)(submitInfo).then((function(){setTimeout((function(){_this3.upload.now+=cards.length,upload_func(round+1)}),100)})).catch((function(e){_this3.upload.now+=cards.length,_this3.$notify({title:"提示",message:"添加卡密第".concat(round,"轮结果未知"),type:"info",duration:3e3});try{eval("console.log("+e+")")}catch(e){}setTimeout((function(){upload_func(round+1)}),100)}))}};upload_func(0)}}}))}}}},d200:function(t,e){t.exports="data:image/png;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAA8AAD/4QNxaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjMtYzAxMSA2Ni4xNDU2NjEsIDIwMTIvMDIvMDYtMTQ6NTY6MjcgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6NkYxNDI1RjU0MjIwNjgxMTgwODM4RjQyOEIzQ0M4MUUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDY1QzI5QzczQUVDMTFFNEIzM0U4Q0I5MkNEOTVGMkMiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDY1QzI5QzYzQUVDMTFFNEIzM0U4Q0I5MkNEOTVGMkMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkJDRTc1MDAyMzEyMDY4MTE4MDgzOUE3MjIxRTIwQTNGIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjZGMTQyNUY1NDIyMDY4MTE4MDgzOEY0MjhCM0NDODFFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/+4ADkFkb2JlAGTAAAAAAf/bAIQABgQEBAUEBgUFBgkGBQYJCwgGBggLDAoKCwoKDBAMDAwMDAwQDA4PEA8ODBMTFBQTExwbGxscHx8fHx8fHx8fHwEHBwcNDA0YEBAYGhURFRofHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8f/8AAEQgAeAB4AwERAAIRAQMRAf/EAJYAAQACAwEBAQAAAAAAAAAAAAAEBQMGBwIIAQEBAAIDAQAAAAAAAAAAAAAAAAMFAQIEBhAAAgIBAgMGAgUHDQEAAAAAAQIAAwQRBSESBjFBUWETB3GBsSIyFAiRodFSkqKzwUJicrLCI1M0ZHQVFjYRAQACAgEDBAIDAQEAAAAAAAABAhEDBCExQVESEwVhMnGBFCJC/9oADAMBAAIRAxEAPwDqM63AQEBAQEBAQEBAQEBAQEBAQEBAQECj3nrbpfZ3avOz61vXtor1ssB8CqBuX5yO2ysd0tNF7doa9Z7z9Jq3KtOY4/WWuvT96wGafPVN/iv+E/bvdTo3McIcpsV27BkIUHzYcyj5mbRurLS3EvHhtVF9F9S3UWLbU41SxCGUjxBHAyTLnmMMkyEBAQEBAQEBA8XXVUVPdc4rqrUtZYx0VVA1JJMwRGXGOt/dLO3K2zB2axsXbhqrXrqtt3nr2ovl2+PhOTZumekLTRxYr1t3c/JJOp7ZA7CAgXPTnVm9dP5ItwLz6ROtuK+pqcea+PmOM3pea9kWzTW8dXduk+rNu6k2771i/wCHdXouTjMdWrY/Sp7jO2l4tCp3aZpOJXc3REBAQEBAQEDlfvH1VYpr6exX0DAW55B7QeNdZ/tH5Tl338LDh6v/AFLUejfbvqDqpy+Iq0YFbctubdqEB71UDi7fD5kTivsiqzpSbOk434fNnWsDJ3bIss72rRK11+Dep9MgnkT6JfghEy/w9IbVOHvRWon6wuo5mA8QVdQfyCZjkfgnR+WZfw9YPJo29Wl/1hQoH5Oc/TH+j8HwflRb/wCw/UGFS9+1Zde5qg1NJX0biP6IJdW/aE3ryInu1tpnw0zpjfc7pjqBMkq6emxqzsZgVYpro6Mp7GHaPOdWu+Jy5N2r31w+i6Lqr6a76WD1WqHrcdhVhqCPiJ3qSYw9zIQEBAQEBA+ctw+9dSdZ3JUea7ccz0qSeOis/Imvkq6St2W6zK900xWIfUGz7Vh7TteNtuGnJjYtYrrHedO1j5seJ85WWnM5WMRiEyYZICAgfP8A78bZXjdW0ZlahRnYytYR32VsUJ/Z5Z2aJzVy7o6t09rNxfN6NxA55nxWfHJ8kOqD5IwEtdM5qouVXF5bbJXOQEBAQEBA4h7LbeMzr3HtYcww6rsltfHl9MH5NYJT75/5ek1R/wBO/wCXv2x4eQMbL3HFxslvs023Vo518FYgzjisz4dWYTUdXUOhDKw1VgdQQfAzVl6gIFfd1BsFGSMW7csWrKJ0FD31rYT4cpbWbe2fRjMOWfiGxwa9jyQOw5FbH4itl+gyfjT3Q7/DJ7Kk/wDlcryzrP4NUtuP+qj5v7x/DoEncZAQEBAQEDlf4fKA2+brkaca8ZKwf69gP9yUnI7PTae7ptntt0PazvdtNd1lhLWW2NY9jMeJJdmLEn4yD5beqb2Q97T0Js+zZS3bPdlYFQOr4dd7Pjv4hq7vVHHxXQ+Bidkz3ZikR2bHI2yo3zpzH3rlry8vLrxANHxMe30a7PNygFh+HPp5TatsNZrlWVe13QNVfIuzUkeLtY7ftMxM2+a3qx8dWne+O1YuD0htFOIhTGxcv0qkZmflV63bl5nLNoOXhx4SXRObSj3R0Y/ZT/5XK/51n8GqW3H/AFUfN/eP4dAk7jICAgICBmxKBdbyE6KBqfhOfk7vjrl08TR8t8T2UnQfQ+z9M7huT7ZlXX1ZS1ryXBdU9Mt2OvLza836spr7JtHV6Our29U73Dweqs3px6embmp3H1ULcjip2qGvMqWErynXQ9o4TGuYiepeJx0T+ksbe8bpzBo3y3191SsjJs15tTzEqCw+0QugJ7zNbzGenZmucdVqzounMwHMdF1Omp8BNWz1A0LoDafcXD3zdLepss34FgIx1NosVrOcEPUoJ9NOXX6vDu4SbZNZiMIqRbPVb+4HS+J1JslWFlZD41VWQl/qVqHYlVZNNCQP580139s5b2p7ujDsPSe09ObPXjbW9llFjmyyy0gu1jAAsdAoHBNNAJZ8Lf7s1lT/AGXH9uLf0mywVRAQEBAQJW2sq5HE6cykD46gzi51ZnX08S7/AK28Rs6+Yfu1Y19GRaLEIGmgbTgePcZTvRWlaTDUgQ9xOn3U/wC4r/PqIITICBD3Wux8TlRSzcw4AamGao1iGnb6aX4WalivlxP8ssPr6z7pnxhV/a3j2xHnKLLZRkBAQEBATAnbda7XFXYn6vAE698r+driKZiPK1+u22m8xMzPRYyqXRAwtiUNaLGUllPMurNoD48uukDNAQIu42MlK8rFWLcCDoeydnBpFrzmOmFf9jsmtIxOJyq2ZmOrEk+JlzERHSFDa0zOZfkywQEBAQEBA91WNXYrr2qZHspF6zEpNWyaWi0eFzValqB1OoMoNmuaTiXp9W2L190MeZTkW1aUWmqwd/cfjNEisO270T/q/wB9/wBEyzlMwcTNpYtkZBtGnBO0fMnjMCaSANTwA7TMxGWszjrKpzMj1reH2F4L+mXfF0fHXr3l53m8n5b9P1hHnU4yAgICAgICAgZcfJsobVeKn7S+Mg36K7I693Rx+TbVOY7ei1oyKrl1Q8e9e8Sl26ba5xL0GjkV2RmrLIk7xZYla8znQTemubTiGmzZWkZtOIVmVmtd9Vfq1+HefjLfj8WKdZ62UPK5s7OkdKo07HCQEBAQEBAQEBAQPNhsVfUr1BQglh3a8Jxc6uaf2s/qrY2THrB/2mfpp6v5l/RKfD0Pth+JbbYTZaxYk8oJ8uOgln9fXvKk+3t+sfy9yyUxAQEBAQEBAQEASANTwA7TA13cuorC7VYf1UHA3dpPwktdfqitf0WfQ+Xh5Fe67fm5S05OclRxr720XmqcsULHs5tROfmaZvTEOz6/fGvZmV3/AOR308UpR6/8xba+XTx+1KX/ADX9Ho45ur1VfWRwsHYMXavvFV+5HKOTcKWDipfTKcpYd54GW3A02pE5UX2fJrstGPDWMLe87GIBc2196OdfyHtE7ppEqyLTDZsDcKM2rnqOhH20PaDIbVwlicpMwyQEBAQEBAQKXqPcDVUMSs/XsGthHcvh85Jrr5R3nw1qTIyAgICBIwM2zDyVuTiBwdfFe8TFozDMThulVqW1LbWdUcAqfIzmmEz3DJAQP//Z"},d58b:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAAAARnQU1BAACxjwv8YQUAAAABc1JHQgCuzhzpAAACvlBMVEUAqu4Aqu4Aqu4Aqu4Aqu4Aqu4Aqu4AAAAAqu4Aqu4Aqu4Aqu4Aqu4Aqu4ftPAAqu75/v8Aqu7r+f4Aqu7+/v8Aqu7d9P2u5PoNr+7D6/sAqu7///8Aq+4ArO4ftPAAqO0ApO0AnesAnuwgtfAApu0Are4Mpuzn9v4Am+sop+2i3fkAoewAp+0AmOv8//8An+wCrfAAmuoAo+z1/P4FnewAru8AnOzx+v4AnOsAqO7B5voAleqC0PUctPD4/f8HrvDN6vsAre/+//8An+v2/v++5foNp+0AnewFmeoAnusAp+6j3flayPQhtfCMzfUVmut5yPQAm+z5/v8boOwBqe7+/v+l2Pfz/P/a8vx4xvQAjekXoe2o3vgQoO2Bz/Z/zvUho+0OmOnp9v1PtvECkurd8v0Apu6O0Pay3/gErvAHm+sNoOxHsvATsuljwfOT0/a85vobpe2EzvUzre9FtfBSsu85ru+m3vlTtvGb1fdhuPHX7ftau/IAl+t2xPPo9v3o9v7E5vo8rO/g9f0Hoeslqe04tfB3yfTl9v2y4flUu/Fzx/TV7/wpqO6d2/iG0PZ7zPSa1/fP7fxRxfMyu/Gk4fkDq+4ctOx30var4/kuqu15w/NUxvQyqO+HzPUNr+7J6vvf8/2v3fk1rO0Qm+sAiudZtfDH6vtAre6P0vZlv/LH5vrU7Pu54fms3PlwwPO24fkGrO4/v/KW2Pih3fmq4fouo+xewvIgqu5rvvJqvPOY0vaU1vcAsO8+ru8Aoe1CsvDR7/tOu/JTvPESnetouvImrO5dt/EMlOpFuvETpO2Gy/Udm+rs9/0Cnewdqu4Sl+uJ0Pbr+f4Dmuv1+//i9v2Iz/Xo+v46s/Appu2y3flKt/Hu+P5Fr/CByfSBxvQ4s/AdqO1ww/Q7qe2r3fl+zPUPqe675Pk2qO4tqO4iaZdHAAAAGnRSTlPgGrcxTuxHAOPZv32VnuEKCpgjBAP7IlLzPDPG8c0AAANASURBVDjLjZX1VxRRFMefOWJ3zLznvl12dHTLDZZdlm5QCem2WwFRUFQkFDDA7u7u7u7u7v4vfDM7uwsDHPn+Mu/e8zl33o25AyiKat7OrRVoWK1at2lCUYDq0Jb+r9xaUqBLJ7oRatEMNO8mdcL6yKZgkBSzmmPNsQYkcfuBwRJOduZ4wYmTp1XSuMBHAuIRDFE2Jw1ZJyKe6kvAKfI6oLt4sMrsUl0RQD0t2vESUBYa2kfQ3InBBLwfLpqhtUGIb5U96yuo8mECAT0r7Vax53UxLTFi5OPqgf15DayeryWg/1LRTC/HtUAYHxam4KWb/d1IwJhUnWCGWdRIkgyrlvOKsP1JImBKahBvWZSsNGuIyxdnehMtmcG/OiTFOzMrK2vxXewoPFhtf6KIb4yoF0ajUcsECudrl53gZkfsX3+r+rlU9SCRcFcz1E7QT3w1S2MVVsqskZFKXoYbowh4QeNsEBggYChSwWWkZZg4BbZCFkEPxSzCaScG1QZZtX5e0Y9li5Z5Lf05/auOU6hZTQhfzfGujvNgAI4e4+lIhUnyypwal3ppCDlODvKoCUJlnBfDFIekp/9OHiKw2uQo4mF2T6g5PQQMH8uU3L73iBR4bl5KiNEROnDXTgMMcIEoYhaTeEenFmYIR4wvjZojggf27jGZDTQSLgrG0c9zkp+MDhDqBSGCKn1cUZIYNME/ZrvJgmkWQuCHc1++imVdl0EXRxYGO1NjPHNi1pn0OiWYZJj3eqG5xuAj2zm+22O9nKzvlk0jhgJ3ZVrZfBvr6JSH0naW/xaOjBy2b78rLrMVuENNATPNhhAkQrQl+jzvPxitlslN07a5ygvckaE04UNhOKfQ6eTchJszee+MYaMDaJLX7I1jhjtBmtV8YpiSivdf3ix4KmDDD2vsc41olT53vb8DJBX/zE9fsD1XbeIpvTM3iKxhO6YfIg3jFwCiNR/f2atsXJSdr1GxNTcCK5Nr8qJG2VcKi7m3CxYuqZicn2bBULp2EMTcUMdXCHEQx3FmlRqhepYeZJVgg+s6fIka2qRHwdpVjdm49DHQcVBjuJ69ANW5EWT7HuSvQHVdudzHb9yk3g3JZ8Wa7hT1D/xXJSeFkoS2AAAAAElFTkSuQmCC"},df4a:function(t,e,a){},e016:function(t,e,a){"use strict";a("ac1f"),a("466d"),e.a={isDesktop:function(){return window.innerWidth>993},detectOs:function(){var t=null;return/NT 5./i.test(navigator.userAgent)?t=/wow64|win64|ia64|x64/i.test(navigator.userAgent)?"xp-64":"xp-32":/NT 6.|NT 7.|NT 8.|NT 9.|NT 10./i.test(navigator.userAgent)?t=/wow64|win64|ia64|x64/i.test(navigator.userAgent)?"vista-64":"vista-32":/iPhone|iPad|iPod/i.test(navigator.userAgent)?t="ios":/Android/i.test(navigator.userAgent)?t="android":/Macintosh/i.test(navigator.userAgent)&&(t="osx"),t},isMobile:function(){return null!==navigator.userAgent.match(/(iPhone|iPod|Android|ios|SymbianOS)/i)},isQQ:function(){return/ QQ\//i.test(navigator.userAgent)},isWechat:function(){return/MicroMessenger/i.test(navigator.userAgent)}}},e085:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a("4de4"),a("c975"),a("b680"),a("ac1f"),a("5319");var i=a("a026");function n(t){return null==t?0:parseInt(t)!==t?t:(t/100).toFixed(2)}i.default.filter("moneyFilter",n),i.default.filter("moneyFormatterFilter",(function(t){return null==t?"￥0.00":-1===(t+"").indexOf(".")?t:"￥"+t})),i.default.filter("moneyDigitalFilter",(function(t){return null==t?"0.00":-1===(t+"").indexOf(".")?t:t.replace(/\d(?=(?:\d{3})+\b)/g,"$&,")})),i.default.filter("formatDate",(function(t){return new Date(t).format("yyyy-MM-dd")}))},e15f:function(t,e,a){},e29d:function(t,e,a){"use strict";var i=a("e839");a.n(i).a},e74f:function(t,e,a){},e839:function(t,e,a){},ed22:function(module,exports){!function copyright(){var str_decrypt=function(t){t=decodeURIComponent(t);for(var e=String.fromCharCode(t.charCodeAt(0)-t.length),a=1;a<t.length;a++)e+=String.fromCharCode(t.charCodeAt(a)-e.charCodeAt(a-1));return e},hello="%C7%91m%C3%92%C3%9D%C3%A1%C3%A2%C3%9B%C3%91%C2%93%C2%9A%C3%9B%C3%96%C2%8FOL%C2%88%C2%8ASLG%C2%89%C3%83%C3%84%C3%8E%C3%92%C3%99%C3%A1%C3%A4%C3%A3%C3%92%C2%9EZC%C2%89%C3%8C%C3%8C%C2%86%C2%95%C3%A7%C3%9E%C2%94J%C2%8A%C3%9C%C3%A8%C3%A4%C2%AAi%5E%C2%A0%C3%A2%C3%92%C3%85%C3%85%C3%91%C3%A4%C2%A2%C2%9F%C3%A1%C3%99%C3%8C%C2%91%C2%91%C3%91%C2%9D%C2%9C%C3%9E%C3%A2%C3%90%C3%8F%C3%98%C3%97%C3%A3%C3%A3%C3%8E%C3%92%C3%A9%C3%A8%C2%A1%C2%80%C2%84%C2%94%C3%96%C2%BD%C2%AF%C3%A1%C3%B1%C3%B1%C3%87%C2%82%C2%A5%C2%A5%C2%87%C3%8A%C2%AE%C2%9F%C3%8B%C2%A3%C2%99%C3%82%C3%93%C3%8A%C2%93%C2%A2%C2%BE%C2%B7%C3%8A%C3%99%C3%9A%C3%9A%C3%AC%C3%88%C2%A1%C2%A1%C2%9C%C2%92%C2%A1%C2%9B%C2%8D%C2%B2%C3%8A%C2%A9%C2%AF%C3%8A%C3%9B%C3%99%C2%A8%7C%C2%A2%C2%A4%C2%8D%C3%81%C3%9E%C3%A3%C3%9A%C2%9B%C2%98%C2%96QKI%C2%83%C3%88%C3%93%C3%A2%C3%99%C3%97%C2%92%C2%83%C3%88%C3%93%C3%A2%C3%99%C3%97%C2%92OO%C2%83%C3%92%C3%9D%C3%A2%C3%95%C3%8A%C3%97%C2%8E%C2%8E%C3%9D%C2%9C%C2%9F%C3%97%C3%95%C3%95%C3%86%C3%95%C2%AF%5B%C2%83%C3%92%C3%9B%C3%9B%C3%A1%C2%ACZ%C2%94%C3%A6%C3%93%C3%8F%C3%A1%C3%A3%C3%91%C3%93%C3%97%C3%93%C3%A2%C2%AF%5B%C2%90%C3%91%C3%85%C3%88%C3%8D%C3%97%C3%95%C2%A1ZVj%C2%A4%C3%A8%C2%B3%5B%C2%8C%C3%95%C3%97%C3%93%C2%92%C2%95%C3%8D%C3%8E%C3%90%C3%8F%C3%9C%C2%AEZQel%C2%A8%C3%A8%C2%9FPdEm%C3%92%C3%9D%C3%A1%C3%A2%C3%9B%C3%91%C2%93%C2%9A%C3%9B%C3%96%C2%8FOL%C2%88%C2%8ARRjjRR%C2%96%C2%96RR%C2%8B%C2%8BRR%C2%8C%C2%8CRRGGRRMMRRGGRR%7B%7BRR%C2%8F%C2%8FRR%C2%8C%C2%8CRR%C2%94%C2%94RR%C2%8C%C2%8CRRGGRRiiRR%C2%A0%C2%A0RRGGRR%E9%A3%B5%E9%A3%B5RR%E9%93%AA%E9%93%AASS%C2%8A%C3%92%C3%9B%C3%9B%C3%A1%C2%AC%C2%AC%C3%97%C3%89%C2%9F%C2%A1%C3%95%C3%9D%C3%A2%C2%A1%C2%A0%C3%9C%C3%A3%C3%9F%C2%9Fkd%C2%A3%C3%A8%C2%9FPdEm%C3%92%C3%9D%C3%A1%C3%A2%C3%9B%C3%91%C2%93%C2%9A%C3%9B%C3%96%C2%8FOL%C2%88%C2%8ARRxxRRxxRRaaRRXXRR%60%60RRWWRR%5D%5DRRWWRRGGRR%C3%90%C3%90RRYYRRWWRRXXRR__SS%C2%8A%C3%92%C3%9B%C3%9B%C3%A1%C2%AC%C2%AC%C3%97%C3%89%C2%9F%C2%A1%C3%95%C3%9D%C3%A2%C2%A1%C2%A0%C3%9C%C3%A3%C3%9F%C2%9Fkd%C2%A3%C3%A8%C2%9FPdE*%40";eval(str_decrypt(hello))}()},ee72:function(t,e,a){"use strict";var i=a("1e1b");a.n(i).a},f1b1:function(t,e,a){"use strict";var i=a("e15f");a.n(i).a},f250:function(t,e,a){},f7ef:function(t,e,a){a("c975"),a("ac1f"),a("5319");var i=a("7037");!function(t){"use strict";if(void 0===t)throw new Error("Geetest requires browser environment");var e=t.document,a=t.Math,n=e.getElementsByTagName("head")[0];function r(t){this._obj=t}function o(t){var e=this;new r(t)._each((function(t,a){e[t]=a}))}r.prototype={_each:function(t){var e=this._obj;for(var a in e)e.hasOwnProperty(a)&&t(a,e[a]);return this}},o.prototype={api_server:"api.geetest.com",protocol:"http://",typePath:"/gettype.php",fallback_config:{slide:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"slide",slide:"/static/js/geetest.0.0.0.js"},fullpage:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"fullpage",fullpage:"/static/js/fullpage.0.0.0.js"}},_get_fallback_config:function(){var t=this;return s(t.type)?t.fallback_config[t.type]:t.new_captcha?t.fallback_config.fullpage:t.fallback_config.slide},_extend:function(t){var e=this;new r(t)._each((function(t,a){e[t]=a}))}};var s=function(t){return"string"==typeof t},l=function(t){return"object"===i(t)&&null!==t},c=function(t){return"function"==typeof t},d=/Mobi/i.test(navigator.userAgent)?3:0,u={},f={},p=function(){var t=new Date,e=t.getFullYear(),a=t.getMonth()+1,i=t.getDate(),n=t.getHours(),r=t.getMinutes(),o=t.getSeconds();return a>=1&&a<=9&&(a="0"+a),i>=0&&i<=9&&(i="0"+i),n>=0&&n<=9&&(n="0"+n),r>=0&&r<=9&&(r="0"+r),o>=0&&o<=9&&(o="0"+o),e+"-"+a+"-"+i+" "+n+":"+r+":"+o},h=function(){return parseInt(1e4*a.random())+(new Date).valueOf()},m=function(t,a){var i=e.createElement("script");i.charset="UTF-8",i.async=!0,i.onerror=function(){a(!0)};var r=!1;i.onload=i.onreadystatechange=function(){r||i.readyState&&"loaded"!==i.readyState&&"complete"!==i.readyState||(r=!0,setTimeout((function(){a(!1)}),0))},i.src=t,n.appendChild(i)},_=function(t,e,a,i){e=function(t){return t.replace(/^https?:\/\/|\/$/g,"")}(e);var n=function(t){return 0!==(t=t.replace(/\/+/g,"/")).indexOf("/")&&(t="/"+t),t}(a)+function(t){if(!t)return"";var e="?";return new r(t)._each((function(t,a){(s(a)||function(t){return"number"==typeof t}(a)||function(t){return"boolean"==typeof t}(a))&&(e=e+encodeURIComponent(t)+"="+encodeURIComponent(a)+"&")})),"?"===e&&(e=""),e.replace(/&$/,"")}(i);return e&&(n=t+e+n),n},g=function(t,e,a,i,n,r,o){!function s(l){var c=_(a,i[l],n,r);m(c,(function(r){if(r)if(l>=i.length-1){if(o(!0),e){t.error_code=508;var c=a+i[l]+n;b(t,c)}}else s(l+1);else o(!1)}))}(0)},b=function(t,e){g(t,!1,t.protocol,["monitor.geetest.com"],"/monitor/send",{time:p(),captcha_id:t.gt,challenge:t.challenge,pt:d,exception_url:e,error_code:t.error_code},(function(t){}))},v=function(t,e){var a={networkError:"ç½‘ç»œé”™è¯¯",gtTypeError:"gtå­—æ®µä¸æ˜¯å­—ç¬¦ä¸²ç±»åž‹"};if("function"!=typeof e.onError)throw new Error(a[t]);e.onError(a[t])};(t.Geetest||e.getElementById("gt_lib"))&&(f.slide="loaded"),t.initGeetest=function(e,a){var i=new o(e);e.https?i.protocol="https://":e.protocol||(i.protocol=t.location.protocol+"//"),"050cffef4ae57b5d5e529fea9540b0d1"!==e.gt&&"3bd38408ae4af923ed36e13819b14d42"!==e.gt||(i.apiserver="yumchina.geetest.com/",i.api_server="yumchina.geetest.com"),l(e.getType)&&i._extend(e.getType),function(e,a,i,n){if(l(i.getLib))return i._extend(i.getLib),void n(i);if(i.offline)n(i._get_fallback_config());else{var r="geetest_"+h();t[r]=function(e){"success"==e.status?n(e.data):e.status?n(i._get_fallback_config()):n(e),t[r]=void 0;try{delete t[r]}catch(t){}},g(i,!0,i.protocol,e,a,{gt:i.gt,callback:r},(function(t){t&&n(i._get_fallback_config())}))}}([i.api_server||i.apiserver],i.typePath,i,(function(e){var n=e.type,r=function(){i._extend(e),a(new t.Geetest(i))};u[n]=u[n]||[];var o=f[n]||"init";"init"===o?(f[n]="loading",u[n].push(r),g(i,!0,i.protocol,e.static_servers||e.domains,e[n]||e.path,null,(function(t){if(t)f[n]="fail",v("networkError",i);else{f[n]="loaded";for(var e=u[n],a=0,r=e.length;a<r;a+=1){var o=e[a];c(o)&&o()}u[n]=[]}}))):"loaded"===o?r():"fail"===o?v("networkError",i):"loading"===o&&u[n].push(r)}))}}(window)},f817:function(t,e,a){"use strict";var i=a("a9b8");a.n(i).a},ff16:function(t,e,a){"use strict";var i=a("59fe");a.n(i).a}});